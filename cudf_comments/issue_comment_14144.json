[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1728369766",
        "html_url": "https://github.com/rapidsai/cudf/issues/14144#issuecomment-1728369766",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14144",
        "id": 1728369766,
        "node_id": "IC_kwDOBWUGps5nBNRm",
        "user": {
            "login": "davidwendt",
            "id": 45795991,
            "node_id": "MDQ6VXNlcjQ1Nzk1OTkx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45795991?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidwendt",
            "html_url": "https://github.com/davidwendt",
            "followers_url": "https://api.github.com/users/davidwendt/followers",
            "following_url": "https://api.github.com/users/davidwendt/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidwendt/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidwendt/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidwendt/subscriptions",
            "organizations_url": "https://api.github.com/users/davidwendt/orgs",
            "repos_url": "https://api.github.com/users/davidwendt/repos",
            "events_url": "https://api.github.com/users/davidwendt/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidwendt/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-09-20T20:18:55Z",
        "updated_at": "2023-09-20T20:18:55Z",
        "author_association": "CONTRIBUTOR",
        "body": "For reference here is a list of the suspect characters: https://www.compart.com/en/unicode/category/Lt\r\nSeems the `cudf::strings::capitalize()` should handle these by default (no special option) if possible.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1728369766/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1729898366",
        "html_url": "https://github.com/rapidsai/cudf/issues/14144#issuecomment-1729898366",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14144",
        "id": 1729898366,
        "node_id": "IC_kwDOBWUGps5nHCd-",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-09-21T16:17:59Z",
        "updated_at": "2023-09-21T16:17:59Z",
        "author_association": "CONTRIBUTOR",
        "body": "Great to hear that CUDF will do it by default. I ma a little concerned because \u00df is the one that bit us in our testing, but it does not show up in https://www.compart.com/en/unicode/category/Lt",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1729898366/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1881231810",
        "html_url": "https://github.com/rapidsai/cudf/issues/14144#issuecomment-1881231810",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14144",
        "id": 1881231810,
        "node_id": "IC_kwDOBWUGps5wIVHC",
        "user": {
            "login": "davidwendt",
            "id": 45795991,
            "node_id": "MDQ6VXNlcjQ1Nzk1OTkx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45795991?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidwendt",
            "html_url": "https://github.com/davidwendt",
            "followers_url": "https://api.github.com/users/davidwendt/followers",
            "following_url": "https://api.github.com/users/davidwendt/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidwendt/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidwendt/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidwendt/subscriptions",
            "organizations_url": "https://api.github.com/users/davidwendt/orgs",
            "repos_url": "https://api.github.com/users/davidwendt/repos",
            "events_url": "https://api.github.com/users/davidwendt/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidwendt/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-01-08T15:29:28Z",
        "updated_at": "2024-01-08T15:38:40Z",
        "author_association": "CONTRIBUTOR",
        "body": "So the `\u00df` character looks to be a separate special case. \r\nThe upper-case of `\u00df` is actually `SS` (two capital S's) which the code already supports:\r\n```\r\n>>> import cudf\r\n>>> s = '\u00dfeta'\r\n>>> s.upper()\r\n'SSETA'\r\n>>> gs = cudf.Series([s])\r\n>>> gs.str.upper()\r\n0    SSETA\r\n```\r\nBut it looks like when capitalizing `\u00df` the second S is not upper-cased in Python:\r\n```\r\n>>> s.capitalize()\r\n'Sseta'\r\n>>> gs.str.capitalize()\r\n0    SSeta\r\n```\r\nI've not been able to find documentation on this behavior so I would be curious to know what is expected by Spark when capitalizing `\u00df`\r\nI did a quick test with the `capitalize()` function from [org.apache.commons.lang3.StringUtils](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html) and got a different result as well. Also, the `upperCase()` and `String.toUpperCase()` functions both return `SSETA`.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1881231810/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1881756501",
        "html_url": "https://github.com/rapidsai/cudf/issues/14144#issuecomment-1881756501",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14144",
        "id": 1881756501,
        "node_id": "IC_kwDOBWUGps5wKVNV",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-01-08T20:15:21Z",
        "updated_at": "2024-01-08T20:15:21Z",
        "author_association": "CONTRIBUTOR",
        "body": "```\r\nval df = Seq(\"\u00dfeta\", \"Sseta\").toDF\r\ndf.selectExpr(\"value\", \"upper(value)\", \"lower(value)\", \"initcap(value)\", \"lower(upper(value))\").show()\r\n+-----+------------+------------+--------------+-------------------+\r\n|value|upper(value)|lower(value)|initcap(value)|lower(upper(value))|\r\n+-----+------------+------------+--------------+-------------------+\r\n| \u00dfeta|       SSETA|        \u00dfeta|          \u00dfeta|              sseta|\r\n|Sseta|       SSETA|       sseta|         Sseta|              sseta|\r\n+-----+------------+------------+--------------+-------------------+\r\n```\r\n\r\nI hope that this helps. Strings in Spark are kind of special as they wrote their own [UTF8String](https://github.com/apache/spark/blob/master/common/unsafe/src/main/java/org/apache/spark/unsafe/types/UTF8String.java) implementation\r\n`upper` is [`UTF8String.toUpperCase`](https://github.com/apache/spark/blob/bb0f77d076ee10ceb1365715fb75e3acb795eec7/common/unsafe/src/main/java/org/apache/spark/unsafe/types/UTF8String.java#L367-L388), \r\n`lower` is [`UTF8String.toLowerCase`](https://github.com/apache/spark/blob/bb0f77d076ee10ceb1365715fb75e3acb795eec7/common/unsafe/src/main/java/org/apache/spark/unsafe/types/UTF8String.java#L397-L418), and \r\n`initcap` is [`UTF8String.toLowerCase.toTitleCase`](https://github.com/apache/spark/blob/bb0f77d076ee10ceb1365715fb75e3acb795eec7/common/unsafe/src/main/java/org/apache/spark/unsafe/types/UTF8String.java#L427-L451).",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1881756501/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1885681110",
        "html_url": "https://github.com/rapidsai/cudf/issues/14144#issuecomment-1885681110",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14144",
        "id": 1885681110,
        "node_id": "IC_kwDOBWUGps5wZTXW",
        "user": {
            "login": "davidwendt",
            "id": 45795991,
            "node_id": "MDQ6VXNlcjQ1Nzk1OTkx",
            "avatar_url": "https://avatars.githubusercontent.com/u/45795991?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidwendt",
            "html_url": "https://github.com/davidwendt",
            "followers_url": "https://api.github.com/users/davidwendt/followers",
            "following_url": "https://api.github.com/users/davidwendt/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidwendt/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidwendt/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidwendt/subscriptions",
            "organizations_url": "https://api.github.com/users/davidwendt/orgs",
            "repos_url": "https://api.github.com/users/davidwendt/repos",
            "events_url": "https://api.github.com/users/davidwendt/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidwendt/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-01-10T20:35:31Z",
        "updated_at": "2024-01-10T20:35:31Z",
        "author_association": "CONTRIBUTOR",
        "body": "The `initcap()` appears to match results I see with `org.apache.commons.lang3.StringUtils.capitalize()` both of which just pass through the `\u00df` character unchanged. \r\n\r\nI found a few more characters that are not part of the titlecase Unicode definition and behave like `\u00df`:\r\n\r\n```\r\n\u00df   (223) -> SS (83,83)     : Ss (83,115)\r\n\u0587  (1415) -> \u0535\u0552 (1333,1362) : \u0535\u0582 (1333,1410)\r\n\ufb00 (64256) -> FF (70,70)     : Ff (70,102)\r\n\ufb01 (64257) -> FI (70,73)     : Fi (70,105)\r\n\ufb02 (64258) -> FL (70,76)     : Fl (70,108)\r\n\ufb03 (64259) -> FFI (70,70,73) : Ffi (70,102,105)\r\n\ufb04 (64260) -> FFL (70,70,76) : Ffl (70,102,108)\r\n\ufb05 (64261) -> ST (83,84)     : St (83,116)\r\n\ufb06 (64262) -> ST (83,84)     : St (83,116)\r\n\ufb13 (64275) -> \u0544\u0546 (1348,1350) : \u0544\u0576 (1348,1398)\r\n\ufb14 (64276) -> \u0544\u0535 (1348,1333) : \u0544\u0565 (1348,1381)\r\n\ufb15 (64277) -> \u0544\u053b (1348,1339) : \u0544\u056b (1348,1387)\r\n\ufb16 (64278) -> \u054e\u0546 (1358,1350) : \u054e\u0576 (1358,1398)\r\n\ufb17 (64279) -> \u0544\u053d (1348,1341) : \u0544\u056d (1348,1389)\r\n```\r\n\r\nThe Python (and Pandas) output for `capitalize()` (which also matches`title()`) is included above after the `:`. Generally, in the multi-character output for `upper()` the characters after the first character are lower-cased for `capitalize()` (and `title()`).\r\n\r\nBut all of these pass through unchanged with `org.apache.commons.lang3.StringUtils.capitalize()` so I suspect the same pass through result from `initcap()` for these as well.\r\n\r\nRegardless, the libcudf result matches neither and so the inclination is to fix it to match the Python/Pandas result.\r\nI was also able to verify that C++ `Boost Locale` library supports these characters and match the Python results as well.\r\nThe [`boost::locale` class](https://www.boost.org/doc/libs/1_82_0/libs/locale/doc/html/group__convert.html#ga0cf65ff4ea4bf502c667823c0137a225) is implemented using the [ICU library](https://icu.unicode.org/) which provides a rich set of globalization functions for software applications.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1885681110/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1904802469",
        "html_url": "https://github.com/rapidsai/cudf/issues/14144#issuecomment-1904802469",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14144",
        "id": 1904802469,
        "node_id": "IC_kwDOBWUGps5xiPql",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-01-22T20:56:22Z",
        "updated_at": "2024-01-22T20:56:22Z",
        "author_association": "CONTRIBUTOR",
        "body": "Sorry I have not been following this as closely as I should.\r\n\r\n@davidwendt so the proposal is to make the CUDF code match python/pandas, but not Spark?\r\n\r\n@sameerz if that is true then we will need to write a custom kernel for initcap for Spark.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1904802469/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1904833984",
        "html_url": "https://github.com/rapidsai/cudf/issues/14144#issuecomment-1904833984",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14144",
        "id": 1904833984,
        "node_id": "IC_kwDOBWUGps5xiXXA",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-01-22T21:17:39Z",
        "updated_at": "2024-01-22T21:17:39Z",
        "author_association": "CONTRIBUTOR",
        "body": "Just FYI: From a Spark perspective I found 265 characters that produce different values between the CPU implementation and the GPU one.  Their code points are.\r\n\r\n(223, 304, 329, 452, 454, 455, 457, 458, 460, 496, 497, 499, 604, 609, 618, 620, 642, 647, 669, 670, 912, 944, 1011, 1012, 1321, 1323, 1325, 1327, 1415, 4304, 4305, 4306, 4307, 4308, 4309, 4310, 4311, 4312, 4313, 4314, 4315, 4316, 4317, 4318, 4319, 4320, 4321, 4322, 4323, 4324, 4325, 4326, 4327, 4328, 4329, 4330, 4331, 4332, 4333, 4334, 4335, 4336, 4337, 4338, 4339, 4340, 4341, 4342, 4343, 4344, 4345, 4346, 4349, 4350, 4351, 5112, 5113, 5114, 5115, 5116, 5117, 7296, 7297, 7298, 7299, 7300, 7301, 7302, 7303, 7304, 7566, 7830, 7831, 7832, 7833, 7834, 7838, 8016, 8018, 8020, 8022, 8064, 8065, 8066, 8067, 8068, 8069, 8070, 8071, 8080, 8081, 8082, 8083, 8084, 8085, 8086, 8087, 8096, 8097, 8098, 8099, 8100, 8101, 8102, 8103, 8114, 8115, 8116, 8118, 8119, 8130, 8131, 8132, 8134, 8135, 8146, 8147, 8150, 8151, 8162, 8163, 8164, 8166, 8167, 8178, 8179, 8180, 8182, 8183, 8486, 8490, 8491, 42649, 42651, 42900, 42903, 42905, 42907, 42909, 42911, 42933, 42935, 42937, 42939, 42941, 42943, 42947, 43859, 43888, 43889, 43890, 43891, 43892, 43893, 43894, 43895, 43896, 43897, 43898, 43899, 43900, 43901, 43902, 43903, 43904, 43905, 43906, 43907, 43908, 43909, 43910, 43911, 43912, 43913, 43914, 43915, 43916, 43917, 43918, 43919, 43920, 43921, 43922, 43923, 43924, 43925, 43926, 43927, 43928, 43929, 43930, 43931, 43932, 43933, 43934, 43935, 43936, 43937, 43938, 43939, 43940, 43941, 43942, 43943, 43944, 43945, 43946, 43947, 43948, 43949, 43950, 43951, 43952, 43953, 43954, 43955, 43956, 43957, 43958, 43959, 43960, 43961, 43962, 43963, 43964, 43965, 43966, 43967, 64256, 64257, 64258, 64259, 64260, 64261, 64262, 64265, 64266, 64267, 64268, 64269, 64275, 64276, 64277, 64278, 64279)",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1904833984/reactions",
            "total_count": 2,
            "+1": 1,
            "-1": 0,
            "laugh": 1,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
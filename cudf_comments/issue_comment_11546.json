[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1217161070",
        "html_url": "https://github.com/rapidsai/cudf/issues/11546#issuecomment-1217161070",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/11546",
        "id": 1217161070,
        "node_id": "IC_kwDOBWUGps5IjGdu",
        "user": {
            "login": "jrhemstad",
            "id": 15221289,
            "node_id": "MDQ6VXNlcjE1MjIxMjg5",
            "avatar_url": "https://avatars.githubusercontent.com/u/15221289?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrhemstad",
            "html_url": "https://github.com/jrhemstad",
            "followers_url": "https://api.github.com/users/jrhemstad/followers",
            "following_url": "https://api.github.com/users/jrhemstad/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrhemstad/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrhemstad/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrhemstad/subscriptions",
            "organizations_url": "https://api.github.com/users/jrhemstad/orgs",
            "repos_url": "https://api.github.com/users/jrhemstad/repos",
            "events_url": "https://api.github.com/users/jrhemstad/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrhemstad/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-16T21:01:47Z",
        "updated_at": "2022-08-16T21:01:47Z",
        "author_association": "CONTRIBUTOR",
        "body": "The gist of doing LD_PRELOAD injection for `cudaMalloc` is:\r\n\r\n- Write an init function annotated with `__attribute__((constructor))` to ensure it runs during load time\r\n- In the init, use `dlsym(RTLD_NEXT, \"cudaMalloc\")` to get a pointer to the _real_ cudaMalloc function\r\n- Write an overload of `cudaMalloc` with an identical signature to the real one\r\n- In that overload, add a `static` counter that ensures it is only called once and simply invokes the previously stored function pointer\r\n\r\nHere's an example of how I did this in the past for `pthread_mutex_lock/unlock` when I was experimenting with annotating the Python GIL with NVTX (it didn't work because NVTX calls `pthread_mutex_lock` internally and you end up with infinite recursion :( ): \r\n\r\nhttps://github.com/jrhemstad/gil_preload/blob/main/gil_preload.cpp#L62-L80",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1217161070/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1248627213",
        "html_url": "https://github.com/rapidsai/cudf/issues/11546#issuecomment-1248627213",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/11546",
        "id": 1248627213,
        "node_id": "IC_kwDOBWUGps5KbIoN",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2022-09-15T21:02:59Z",
        "updated_at": "2022-09-15T21:02:59Z",
        "author_association": "NONE",
        "body": "This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1248627213/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/786749797",
        "html_url": "https://github.com/rapidsai/cudf/issues/7185#issuecomment-786749797",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7185",
        "id": 786749797,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc4Njc0OTc5Nw==",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2021-02-26T16:26:16Z",
        "updated_at": "2021-02-26T16:26:16Z",
        "author_association": "NONE",
        "body": "This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/786749797/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/849811822",
        "html_url": "https://github.com/rapidsai/cudf/issues/7185#issuecomment-849811822",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7185",
        "id": 849811822,
        "node_id": "MDEyOklzc3VlQ29tbWVudDg0OTgxMTgyMg==",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2021-05-27T17:31:02Z",
        "updated_at": "2021-05-27T17:31:02Z",
        "author_association": "NONE",
        "body": "This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/849811822/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/904310152",
        "html_url": "https://github.com/rapidsai/cudf/issues/7185#issuecomment-904310152",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7185",
        "id": 904310152,
        "node_id": "IC_kwDOBWUGps415q2I",
        "user": {
            "login": "kevinbird15",
            "id": 7451178,
            "node_id": "MDQ6VXNlcjc0NTExNzg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7451178?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kevinbird15",
            "html_url": "https://github.com/kevinbird15",
            "followers_url": "https://api.github.com/users/kevinbird15/followers",
            "following_url": "https://api.github.com/users/kevinbird15/following{/other_user}",
            "gists_url": "https://api.github.com/users/kevinbird15/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kevinbird15/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kevinbird15/subscriptions",
            "organizations_url": "https://api.github.com/users/kevinbird15/orgs",
            "repos_url": "https://api.github.com/users/kevinbird15/repos",
            "events_url": "https://api.github.com/users/kevinbird15/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kevinbird15/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-24T04:17:37Z",
        "updated_at": "2021-08-24T04:17:37Z",
        "author_association": "NONE",
        "body": "I am seeing something similar to this for powers as well: \r\n\r\n```\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-28-56dd126ffdea> in <module>\r\n----> 1 book_train_df.groupby(['time_id'], as_index=False).agg({'log_return1':[realized_volatility]})\r\n\r\n/opt/conda/lib/python3.7/contextlib.py in inner(*args, **kwds)\r\n     72         def inner(*args, **kwds):\r\n     73             with self._recreate_cm():\r\n---> 74                 return func(*args, **kwds)\r\n     75         return inner\r\n     76 \r\n\r\n/opt/conda/lib/python3.7/site-packages/cudf/core/groupby/groupby.py in agg(self, func)\r\n    179         # a Float64Index, while Pandas returns an Int64Index\r\n    180         # (GH: 6945)\r\n--> 181         result = self._groupby.aggregate(self.obj, normalized_aggs)\r\n    182 \r\n    183         result = cudf.DataFrame._from_table(result)\r\n\r\ncudf/_lib/groupby.pyx in cudf._lib.groupby.GroupBy.aggregate()\r\n\r\ncudf/_lib/aggregation.pyx in cudf._lib.aggregation.make_aggregation()\r\n\r\n<ipython-input-27-404c0c674354> in realized_volatility(series)\r\n      8 def realized_volatility(series):\r\n      9     #series=list(series)\r\n---> 10     return np.sqrt(np.sum(series**2))\r\n\r\nTypeError: unsupported operand type(s) for ** or pow(): 'type' and 'int'\r\n```\r\n\r\nMy version is '21.06.01+2.g101fc0fda4' (from kaggle)",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/904310152/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/904310554",
        "html_url": "https://github.com/rapidsai/cudf/issues/7185#issuecomment-904310554",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7185",
        "id": 904310554,
        "node_id": "IC_kwDOBWUGps415q8a",
        "user": {
            "login": "kevinbird15",
            "id": 7451178,
            "node_id": "MDQ6VXNlcjc0NTExNzg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7451178?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kevinbird15",
            "html_url": "https://github.com/kevinbird15",
            "followers_url": "https://api.github.com/users/kevinbird15/followers",
            "following_url": "https://api.github.com/users/kevinbird15/following{/other_user}",
            "gists_url": "https://api.github.com/users/kevinbird15/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kevinbird15/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kevinbird15/subscriptions",
            "organizations_url": "https://api.github.com/users/kevinbird15/orgs",
            "repos_url": "https://api.github.com/users/kevinbird15/repos",
            "events_url": "https://api.github.com/users/kevinbird15/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kevinbird15/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-24T04:18:39Z",
        "updated_at": "2021-08-24T04:18:39Z",
        "author_association": "NONE",
        "body": "(in case the args from %debug are helpful)\r\n![image](https://user-images.githubusercontent.com/7451178/130555017-e61f3223-0859-4693-80eb-bf0d9d0daacf.png)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/904310554/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/904654262",
        "html_url": "https://github.com/rapidsai/cudf/issues/7185#issuecomment-904654262",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7185",
        "id": 904654262,
        "node_id": "IC_kwDOBWUGps416-22",
        "user": {
            "login": "beckernick",
            "id": 8457388,
            "node_id": "MDQ6VXNlcjg0NTczODg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8457388?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/beckernick",
            "html_url": "https://github.com/beckernick",
            "followers_url": "https://api.github.com/users/beckernick/followers",
            "following_url": "https://api.github.com/users/beckernick/following{/other_user}",
            "gists_url": "https://api.github.com/users/beckernick/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/beckernick/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/beckernick/subscriptions",
            "organizations_url": "https://api.github.com/users/beckernick/orgs",
            "repos_url": "https://api.github.com/users/beckernick/repos",
            "events_url": "https://api.github.com/users/beckernick/events{/privacy}",
            "received_events_url": "https://api.github.com/users/beckernick/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-24T13:42:39Z",
        "updated_at": "2021-08-24T13:43:11Z",
        "author_association": "MEMBER",
        "body": "If you're using a custom aggregation function (`realized_volatility`), you'll want to use the `groupby.apply` API. Note that this API will operate serially on a per group basis, so it will not be performant if you have many small groups.\r\n\r\nIt may be possible to convert your function into a combination of built-in operations, which would be high performance.\r\n\r\n```python\r\ndf[\"squared\"] = df.col.pow(2)\r\ndf.groupby(['key']).squared.sum() ** 0.5\r\n```\r\n\r\nEDIT: This would be higher performance in pandas as well, if it accomplishes the desired goal",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/904654262/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
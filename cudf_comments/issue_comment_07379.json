[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/778240211",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-778240211",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 778240211,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc3ODI0MDIxMQ==",
        "user": {
            "login": "jrhemstad",
            "id": 15221289,
            "node_id": "MDQ6VXNlcjE1MjIxMjg5",
            "avatar_url": "https://avatars.githubusercontent.com/u/15221289?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrhemstad",
            "html_url": "https://github.com/jrhemstad",
            "followers_url": "https://api.github.com/users/jrhemstad/followers",
            "following_url": "https://api.github.com/users/jrhemstad/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrhemstad/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrhemstad/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrhemstad/subscriptions",
            "organizations_url": "https://api.github.com/users/jrhemstad/orgs",
            "repos_url": "https://api.github.com/users/jrhemstad/repos",
            "events_url": "https://api.github.com/users/jrhemstad/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrhemstad/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-02-12T14:50:14Z",
        "updated_at": "2021-02-12T14:50:14Z",
        "author_association": "CONTRIBUTOR",
        "body": "I don't quite follow the psuedocode. Using a priority queue will break the original input ordering. It looks like you're just suggesting merging `(0,1)` then merginging that result with `2`, e.g., `(((0,1), 2), 3)),...`? Is that right?\r\n\r\nThat would work, but would defeat the optimization of always merging the smallest tables first (which makes a significant difference).\r\n\r\nIt should be possible to still maintain the original order and merge the smallest tables first, it will just be a bit complicated. E.g., if we have 5 tables A, B, C, D, E whose sizes are (100, 10, 50, 10, 100) then we could merge `B' = (B,D)`  (size is 20) then `B'' = (B', C)` (size is 70), then `A' = (A, B'')` (size is 170) and finally `Result = (A', E)` (size is 270).\r\n\r\nSo long as we always merge right to left, that should still result in the same order as if we did `((((A,B), C), D), E)`.  There's probably a clever algorithm to do this nicely. Maybe @codereport can think of it. ",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/778240211/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/778252274",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-778252274",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 778252274,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc3ODI1MjI3NA==",
        "user": {
            "login": "jlowe",
            "id": 1360766,
            "node_id": "MDQ6VXNlcjEzNjA3NjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1360766?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jlowe",
            "html_url": "https://github.com/jlowe",
            "followers_url": "https://api.github.com/users/jlowe/followers",
            "following_url": "https://api.github.com/users/jlowe/following{/other_user}",
            "gists_url": "https://api.github.com/users/jlowe/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jlowe/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jlowe/subscriptions",
            "organizations_url": "https://api.github.com/users/jlowe/orgs",
            "repos_url": "https://api.github.com/users/jlowe/repos",
            "events_url": "https://api.github.com/users/jlowe/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jlowe/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-02-12T15:11:24Z",
        "updated_at": "2021-02-12T15:28:45Z",
        "author_association": "MEMBER",
        "body": "> It should be possible to still maintain the original order and merge the smallest tables first\r\n\r\nI don't think that sort remains stable.  I'm assuming the final table ordering between tied sort keys needs to be A->E to match the order in which the tables were generated. No matter whether we merge (B,D) with C or C with (B,D), the stable ordering between B, C, and D has been violated.  (B,D) will be treated as a new input table, and there's no way to properly insert the C keys since we lost the ability to distinguish B from D once they merged. I think we'd have to manifest a discriminator column (e.g.: table ID) to be able to skip table ordering when finding a pair to merge yet maintain a stable sort.\r\n\r\nWithout a discriminator we could still be smart about merging smaller pairs first, but those pairs always have to be adjacent tables in the table ordering.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/778252274/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/778300513",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-778300513",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 778300513,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc3ODMwMDUxMw==",
        "user": {
            "login": "jrhemstad",
            "id": 15221289,
            "node_id": "MDQ6VXNlcjE1MjIxMjg5",
            "avatar_url": "https://avatars.githubusercontent.com/u/15221289?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrhemstad",
            "html_url": "https://github.com/jrhemstad",
            "followers_url": "https://api.github.com/users/jrhemstad/followers",
            "following_url": "https://api.github.com/users/jrhemstad/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrhemstad/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrhemstad/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrhemstad/subscriptions",
            "organizations_url": "https://api.github.com/users/jrhemstad/orgs",
            "repos_url": "https://api.github.com/users/jrhemstad/repos",
            "events_url": "https://api.github.com/users/jrhemstad/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrhemstad/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-02-12T16:34:01Z",
        "updated_at": "2021-02-12T16:34:01Z",
        "author_association": "CONTRIBUTOR",
        "body": "> No matter whether we merge (B,D) with C or C with (B,D), the stable ordering between B, C, and D has been violated. (B,D) will be treated as a new input table, and there's no way to properly insert the C keys since we lost the ability to distinguish B from D once they merged.\r\n\r\nYeah, that's a good point. My idea won't work.\r\n\r\n> we could still be smart about merging smaller pairs first, but those pairs always have to be adjacent tables in the table ordering.\r\n\r\nYeah, this would work. It may not be as optimal as merging the exact smallest tables first, but it would at least be better than the naive left fold. \r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/778300513/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/779980098",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-779980098",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 779980098,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc3OTk4MDA5OA==",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-02-16T17:08:03Z",
        "updated_at": "2021-02-16T17:08:03Z",
        "author_association": "CONTRIBUTOR",
        "body": "I do want to reiterate that this is for a minor corner case in Spark. We don't have a customer yet that is complaining about the corner case either. The priority should be fairly low until we do hit a customer complaint.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/779980098/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/780222938",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-780222938",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 780222938,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDIyMjkzOA==",
        "user": {
            "login": "harrism",
            "id": 783069,
            "node_id": "MDQ6VXNlcjc4MzA2OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/783069?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/harrism",
            "html_url": "https://github.com/harrism",
            "followers_url": "https://api.github.com/users/harrism/followers",
            "following_url": "https://api.github.com/users/harrism/following{/other_user}",
            "gists_url": "https://api.github.com/users/harrism/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/harrism/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/harrism/subscriptions",
            "organizations_url": "https://api.github.com/users/harrism/orgs",
            "repos_url": "https://api.github.com/users/harrism/repos",
            "events_url": "https://api.github.com/users/harrism/events{/privacy}",
            "received_events_url": "https://api.github.com/users/harrism/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-02-17T01:07:58Z",
        "updated_at": "2021-02-17T01:07:58Z",
        "author_association": "MEMBER",
        "body": "Why not just provide a choice between fast and stable?",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/780222938/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/802455359",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-802455359",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 802455359,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwMjQ1NTM1OQ==",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2021-03-19T01:51:14Z",
        "updated_at": "2021-03-19T01:51:14Z",
        "author_association": "NONE",
        "body": "This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/802455359/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/802822291",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-802822291",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 802822291,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwMjgyMjI5MQ==",
        "user": {
            "login": "jlowe",
            "id": 1360766,
            "node_id": "MDQ6VXNlcjEzNjA3NjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1360766?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jlowe",
            "html_url": "https://github.com/jlowe",
            "followers_url": "https://api.github.com/users/jlowe/followers",
            "following_url": "https://api.github.com/users/jlowe/following{/other_user}",
            "gists_url": "https://api.github.com/users/jlowe/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jlowe/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jlowe/subscriptions",
            "organizations_url": "https://api.github.com/users/jlowe/orgs",
            "repos_url": "https://api.github.com/users/jlowe/repos",
            "events_url": "https://api.github.com/users/jlowe/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jlowe/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-19T13:11:24Z",
        "updated_at": "2021-03-19T13:11:24Z",
        "author_association": "MEMBER",
        "body": "This is still desired but not high priority.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/802822291/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/802843672",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-802843672",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 802843672,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwMjg0MzY3Mg==",
        "user": {
            "login": "jrhemstad",
            "id": 15221289,
            "node_id": "MDQ6VXNlcjE1MjIxMjg5",
            "avatar_url": "https://avatars.githubusercontent.com/u/15221289?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrhemstad",
            "html_url": "https://github.com/jrhemstad",
            "followers_url": "https://api.github.com/users/jrhemstad/followers",
            "following_url": "https://api.github.com/users/jrhemstad/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrhemstad/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrhemstad/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrhemstad/subscriptions",
            "organizations_url": "https://api.github.com/users/jrhemstad/orgs",
            "repos_url": "https://api.github.com/users/jrhemstad/repos",
            "events_url": "https://api.github.com/users/jrhemstad/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrhemstad/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-19T13:44:46Z",
        "updated_at": "2021-03-19T13:44:46Z",
        "author_association": "CONTRIBUTOR",
        "body": "As @harrism mentioned, I think we can just have `merge` and `stable_merge` APIs to satisfy the different requirements. ",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/802843672/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/821996834",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-821996834",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 821996834,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTk5NjgzNA==",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2021-04-18T14:04:51Z",
        "updated_at": "2021-04-18T14:04:51Z",
        "author_association": "NONE",
        "body": "This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/821996834/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/822491055",
        "html_url": "https://github.com/rapidsai/cudf/issues/7379#issuecomment-822491055",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/7379",
        "id": 822491055,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgyMjQ5MTA1NQ==",
        "user": {
            "login": "jlowe",
            "id": 1360766,
            "node_id": "MDQ6VXNlcjEzNjA3NjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1360766?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jlowe",
            "html_url": "https://github.com/jlowe",
            "followers_url": "https://api.github.com/users/jlowe/followers",
            "following_url": "https://api.github.com/users/jlowe/following{/other_user}",
            "gists_url": "https://api.github.com/users/jlowe/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jlowe/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jlowe/subscriptions",
            "organizations_url": "https://api.github.com/users/jlowe/orgs",
            "repos_url": "https://api.github.com/users/jlowe/repos",
            "events_url": "https://api.github.com/users/jlowe/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jlowe/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-04-19T14:01:49Z",
        "updated_at": "2021-04-19T14:01:49Z",
        "author_association": "MEMBER",
        "body": "Still desired.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/822491055/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
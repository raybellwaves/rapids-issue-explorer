[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/834834910",
        "html_url": "https://github.com/rapidsai/cudf/issues/8182#issuecomment-834834910",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8182",
        "id": 834834910,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgzNDgzNDkxMA==",
        "user": {
            "login": "VibhuJawa",
            "id": 4837571,
            "node_id": "MDQ6VXNlcjQ4Mzc1NzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4837571?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/VibhuJawa",
            "html_url": "https://github.com/VibhuJawa",
            "followers_url": "https://api.github.com/users/VibhuJawa/followers",
            "following_url": "https://api.github.com/users/VibhuJawa/following{/other_user}",
            "gists_url": "https://api.github.com/users/VibhuJawa/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/VibhuJawa/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/VibhuJawa/subscriptions",
            "organizations_url": "https://api.github.com/users/VibhuJawa/orgs",
            "repos_url": "https://api.github.com/users/VibhuJawa/repos",
            "events_url": "https://api.github.com/users/VibhuJawa/events{/privacy}",
            "received_events_url": "https://api.github.com/users/VibhuJawa/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-05-07T22:47:58Z",
        "updated_at": "2021-05-07T22:47:58Z",
        "author_association": "MEMBER",
        "body": "Hey  Lai, \r\n\r\nSeems like you are running into this issue because the output merge of small chunks may be too big (> 2,147,483,648) .  \r\n\r\nThis can happen if you have a lot of repeated keys as we repeat each row in the right table that matches the left table. See the below example for an explanation. \r\n\r\n```python\r\ndf_1 = cudf.DataFrame({'id_a':[1,2,3,4,5,6],'key':[0,0,0,0,0,0]})\r\ndf_2 = cudf.DataFrame({'id_b':[10,20],'key':[0,0]})\r\ndf_1.merge(df_2)\r\n```\r\n\r\n```\r\n\tid_a\tkey\tid_b\r\n0\t1\t0\t10\r\n1\t2\t0\t10\r\n2\t3\t0\t10\r\n3\t4\t0\t10\r\n4\t5\t0\t10\r\n5\t6\t0\t10\r\n6\t1\t0\t20\r\n7\t2\t0\t20\r\n8\t3\t0\t20\r\n9\t4\t0\t20\r\n10\t5\t0\t20\r\n11\t6\t0\t20\r\n````\r\n\r\nNow mitigating this can be done in multiple ways : \r\n\r\n### 1.  If one of the frames is a single partitions (For broadcast joints) :\r\n\r\nRepartition the multi partitioned table upfront into  more partitions:\r\n\r\n```python\r\n## the right frame is a single partition\r\nassert ddf_2.npartitions == 1 \r\n\r\nmerged_df = ddf_1 = ddf_1.repartition(npartitions=ddf_1.npartitions*2) \r\nddf_1.merge(ddf_2,how=inner)\r\n\r\n```\r\n\r\n### 2.  If both of them have multiple partitions (Hash-Join)\r\n\r\nUsing `npartitions`: This argument controls the number of output partitions. \r\n\r\no_partitions = max(ddf_1.npartitions, ddf_2.npartitions )*2 \r\n\r\n```python\r\nmerged_df = ddf_1.merge(ddf_2,npartitions= o_partitions,  how=inner)\r\n``` \r\n\r\n\r\n\r\nIt's still tough to know how to mitigate this error without more information like the `number of left `and `right` partitions but I hope that this still helps. \r\n",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/834834910/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/834904729",
        "html_url": "https://github.com/rapidsai/cudf/issues/8182#issuecomment-834904729",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8182",
        "id": 834904729,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgzNDkwNDcyOQ==",
        "user": {
            "login": "kkraus14",
            "id": 3665167,
            "node_id": "MDQ6VXNlcjM2NjUxNjc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3665167?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kkraus14",
            "html_url": "https://github.com/kkraus14",
            "followers_url": "https://api.github.com/users/kkraus14/followers",
            "following_url": "https://api.github.com/users/kkraus14/following{/other_user}",
            "gists_url": "https://api.github.com/users/kkraus14/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kkraus14/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kkraus14/subscriptions",
            "organizations_url": "https://api.github.com/users/kkraus14/orgs",
            "repos_url": "https://api.github.com/users/kkraus14/repos",
            "events_url": "https://api.github.com/users/kkraus14/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kkraus14/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-05-08T00:37:44Z",
        "updated_at": "2021-05-08T00:37:44Z",
        "author_association": "COLLABORATOR",
        "body": "@rjzamora @shwina this is something that we have primitives to potential handle within dask-cudf. We have APIs that can now return a pair of device vectors to use for gather maps to materialize the join output. The device vectors don't have this int32 size limitation, so we can logically split them into multiple gather calls and output multiple partitions instead of a single partition.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/834904729/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/835260421",
        "html_url": "https://github.com/rapidsai/cudf/issues/8182#issuecomment-835260421",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8182",
        "id": 835260421,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgzNTI2MDQyMQ==",
        "user": {
            "login": "shwina",
            "id": 3190405,
            "node_id": "MDQ6VXNlcjMxOTA0MDU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3190405?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/shwina",
            "html_url": "https://github.com/shwina",
            "followers_url": "https://api.github.com/users/shwina/followers",
            "following_url": "https://api.github.com/users/shwina/following{/other_user}",
            "gists_url": "https://api.github.com/users/shwina/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/shwina/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/shwina/subscriptions",
            "organizations_url": "https://api.github.com/users/shwina/orgs",
            "repos_url": "https://api.github.com/users/shwina/repos",
            "events_url": "https://api.github.com/users/shwina/events{/privacy}",
            "received_events_url": "https://api.github.com/users/shwina/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-05-08T10:01:20Z",
        "updated_at": "2021-05-08T10:01:20Z",
        "author_association": "CONTRIBUTOR",
        "body": "Ideally I'd like for dask-cudf to do this in a way that doesn't interact with cudf internals. To that end, I think it makes sense to expose a join API that returns either (1) chunked results or (2) the gathermaps as CuPy arrays.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/835260421/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/969319185",
        "html_url": "https://github.com/rapidsai/cudf/issues/8182#issuecomment-969319185",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8182",
        "id": 969319185,
        "node_id": "IC_kwDOBWUGps45xqMR",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2021-11-15T21:04:19Z",
        "updated_at": "2021-11-15T21:04:19Z",
        "author_association": "NONE",
        "body": "This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/969319185/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
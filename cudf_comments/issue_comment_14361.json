[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1793322153",
        "html_url": "https://github.com/rapidsai/cudf/issues/14361#issuecomment-1793322153",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14361",
        "id": 1793322153,
        "node_id": "IC_kwDOBWUGps5q4-yp",
        "user": {
            "login": "kkraus14",
            "id": 3665167,
            "node_id": "MDQ6VXNlcjM2NjUxNjc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3665167?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kkraus14",
            "html_url": "https://github.com/kkraus14",
            "followers_url": "https://api.github.com/users/kkraus14/followers",
            "following_url": "https://api.github.com/users/kkraus14/following{/other_user}",
            "gists_url": "https://api.github.com/users/kkraus14/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kkraus14/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kkraus14/subscriptions",
            "organizations_url": "https://api.github.com/users/kkraus14/orgs",
            "repos_url": "https://api.github.com/users/kkraus14/repos",
            "events_url": "https://api.github.com/users/kkraus14/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kkraus14/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-11-04T03:22:49Z",
        "updated_at": "2023-11-04T03:22:49Z",
        "author_association": "COLLABORATOR",
        "body": "If we wanted to match Pandas behavior here it looks like it should be using `NULL_LOGICAL_OR` and `NULL_LOGICAL_AND` instead of `LOGICAL_OR` and `LOGICAL_AND`",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1793322153/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1819214957",
        "html_url": "https://github.com/rapidsai/cudf/issues/14361#issuecomment-1819214957",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14361",
        "id": 1819214957,
        "node_id": "IC_kwDOBWUGps5sbwRt",
        "user": {
            "login": "wence-",
            "id": 1126981,
            "node_id": "MDQ6VXNlcjExMjY5ODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1126981?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wence-",
            "html_url": "https://github.com/wence-",
            "followers_url": "https://api.github.com/users/wence-/followers",
            "following_url": "https://api.github.com/users/wence-/following{/other_user}",
            "gists_url": "https://api.github.com/users/wence-/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wence-/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wence-/subscriptions",
            "organizations_url": "https://api.github.com/users/wence-/orgs",
            "repos_url": "https://api.github.com/users/wence-/repos",
            "events_url": "https://api.github.com/users/wence-/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wence-/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-11-20T14:52:33Z",
        "updated_at": "2023-11-20T14:52:33Z",
        "author_association": "CONTRIBUTOR",
        "body": "There are two issues here:\r\n\r\n1. `cudf.from_pandas` maps nans to nulls by default: if you run `gdf = cudf.from_pandas(df, nan_as_null=False)` then you get the same results as pandas.\r\n2. NULL handling differences between cudf and pandas\r\n\r\n(1) is a footgun that I don't really know how best to square.\r\n\r\nNote that if you use pandas _nullable_ dtypes, the value_counts result is `[4, 1]` (not `[4, 2]`) since the first row is neither true nor false.\r\n\r\nFor (2), the operators `or`, `and`, and `~` are _bitwise_, not logical (so both the existing code and @kkraus14's suggestion would produce the wrong answer):\r\n```\r\nIn [89]: df = pd.DataFrame({\"s\": [5, 6, 7], \"y\": [12, 12, 12]})\r\n\r\nIn [90]: df.eval(\"s or y\")\r\nOut[90]: \r\n0    13\r\n1    14\r\n2    15\r\ndtype: int64\r\n```\r\n\r\nSupposing we fixed that, we need to special-case bitwise ops between two boolean columns :( when they contain nulls. Specifically (and this translates to the series case):\r\n\r\n```\r\nl = pd.Series([False, True], dtype=\"bool\")\r\nr = pd.Series([pd.NA, pd.NA], dtype=\"boolean\") # nullable bool column\r\nl | r\r\n# 0    <NA>\r\n# 1    True\r\n# dtype: boolean\r\n\r\n# Whereas\r\nl.astype(\"Int32\") | r\r\n0    <NA>\r\n1    <NA>\r\ndtype: boolean\r\n\r\n# Or\r\nl | r.astype(\"Int32\")\r\n0    <NA>\r\n1    <NA>\r\ndtype: boolean\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1819214957/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1856311813",
        "html_url": "https://github.com/rapidsai/cudf/issues/14361#issuecomment-1856311813",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14361",
        "id": 1856311813,
        "node_id": "IC_kwDOBWUGps5upRIF",
        "user": {
            "login": "GregoryKimball",
            "id": 12725111,
            "node_id": "MDQ6VXNlcjEyNzI1MTEx",
            "avatar_url": "https://avatars.githubusercontent.com/u/12725111?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GregoryKimball",
            "html_url": "https://github.com/GregoryKimball",
            "followers_url": "https://api.github.com/users/GregoryKimball/followers",
            "following_url": "https://api.github.com/users/GregoryKimball/following{/other_user}",
            "gists_url": "https://api.github.com/users/GregoryKimball/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GregoryKimball/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GregoryKimball/subscriptions",
            "organizations_url": "https://api.github.com/users/GregoryKimball/orgs",
            "repos_url": "https://api.github.com/users/GregoryKimball/repos",
            "events_url": "https://api.github.com/users/GregoryKimball/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GregoryKimball/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-14T17:43:54Z",
        "updated_at": "2023-12-14T17:44:10Z",
        "author_association": "CONTRIBUTOR",
        "body": "Thank you @wence- for analyzing this. \r\n\r\n1) for Nan/null handling in pandas, do you think pandas 2.0 (or beyond) will improve the user experience with cudf?\r\n\r\n2) Do you think the operators `or`, `and`, and `~` should be logical instead of bitwise in cudf?",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1856311813/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1856320663",
        "html_url": "https://github.com/rapidsai/cudf/issues/14361#issuecomment-1856320663",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/14361",
        "id": 1856320663,
        "node_id": "IC_kwDOBWUGps5upTSX",
        "user": {
            "login": "wence-",
            "id": 1126981,
            "node_id": "MDQ6VXNlcjExMjY5ODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1126981?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wence-",
            "html_url": "https://github.com/wence-",
            "followers_url": "https://api.github.com/users/wence-/followers",
            "following_url": "https://api.github.com/users/wence-/following{/other_user}",
            "gists_url": "https://api.github.com/users/wence-/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wence-/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wence-/subscriptions",
            "organizations_url": "https://api.github.com/users/wence-/orgs",
            "repos_url": "https://api.github.com/users/wence-/repos",
            "events_url": "https://api.github.com/users/wence-/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wence-/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-14T17:50:17Z",
        "updated_at": "2023-12-14T17:53:53Z",
        "author_association": "CONTRIBUTOR",
        "body": "wrt 1, I am not sure what the putative future default handling of nan/null is in pandas\r\n\r\nwrt 2: currently cudf (for reasonable reasons) dispatches `and`/`or` to logical and/or and `~`/`&` to bitwise and/or. This differs from the pandas semantics which _always_ dispatch to bitwise and/or. I think the way to fix this is to run a type-inference pass on the parsed AST expression and then we can figure out what to dispatch to on the backend. This can be done walking over the Python AST but it is a bit messy. The reason currently cudf handles and/or separately from ~/& is because in the backend libcudf AST code we need to emit different operators for those cases. Without type inference we don't know what to do.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1856320663/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1557979555",
        "html_url": "https://github.com/rapidsai/cudf/issues/13409#issuecomment-1557979555",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/13409",
        "id": 1557979555,
        "node_id": "IC_kwDOBWUGps5c3OGj",
        "user": {
            "login": "galipremsagar",
            "id": 11664259,
            "node_id": "MDQ6VXNlcjExNjY0MjU5",
            "avatar_url": "https://avatars.githubusercontent.com/u/11664259?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/galipremsagar",
            "html_url": "https://github.com/galipremsagar",
            "followers_url": "https://api.github.com/users/galipremsagar/followers",
            "following_url": "https://api.github.com/users/galipremsagar/following{/other_user}",
            "gists_url": "https://api.github.com/users/galipremsagar/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/galipremsagar/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/galipremsagar/subscriptions",
            "organizations_url": "https://api.github.com/users/galipremsagar/orgs",
            "repos_url": "https://api.github.com/users/galipremsagar/repos",
            "events_url": "https://api.github.com/users/galipremsagar/events{/privacy}",
            "received_events_url": "https://api.github.com/users/galipremsagar/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-22T20:55:10Z",
        "updated_at": "2023-06-07T21:29:48Z",
        "author_association": "CONTRIBUTOR",
        "body": "Maybe a related PR previously worked on similar issue: https://github.com/rapidsai/cudf/pull/11854",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1557979555/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1558200971",
        "html_url": "https://github.com/rapidsai/cudf/issues/13409#issuecomment-1558200971",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/13409",
        "id": 1558200971,
        "node_id": "IC_kwDOBWUGps5c4EKL",
        "user": {
            "login": "galipremsagar",
            "id": 11664259,
            "node_id": "MDQ6VXNlcjExNjY0MjU5",
            "avatar_url": "https://avatars.githubusercontent.com/u/11664259?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/galipremsagar",
            "html_url": "https://github.com/galipremsagar",
            "followers_url": "https://api.github.com/users/galipremsagar/followers",
            "following_url": "https://api.github.com/users/galipremsagar/following{/other_user}",
            "gists_url": "https://api.github.com/users/galipremsagar/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/galipremsagar/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/galipremsagar/subscriptions",
            "organizations_url": "https://api.github.com/users/galipremsagar/orgs",
            "repos_url": "https://api.github.com/users/galipremsagar/repos",
            "events_url": "https://api.github.com/users/galipremsagar/events{/privacy}",
            "received_events_url": "https://api.github.com/users/galipremsagar/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-22T23:49:14Z",
        "updated_at": "2023-05-22T23:49:14Z",
        "author_association": "CONTRIBUTOR",
        "body": "[a_cudf.zip](https://github.com/rapidsai/cudf/files/11537765/a_cudf.zip)\r\n[a_pyarrow.zip](https://github.com/rapidsai/cudf/files/11537766/a_pyarrow.zip)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1558200971/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1581558989",
        "html_url": "https://github.com/rapidsai/cudf/issues/13409#issuecomment-1581558989",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/13409",
        "id": 1581558989,
        "node_id": "IC_kwDOBWUGps5eRKzN",
        "user": {
            "login": "GregoryKimball",
            "id": 12725111,
            "node_id": "MDQ6VXNlcjEyNzI1MTEx",
            "avatar_url": "https://avatars.githubusercontent.com/u/12725111?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GregoryKimball",
            "html_url": "https://github.com/GregoryKimball",
            "followers_url": "https://api.github.com/users/GregoryKimball/followers",
            "following_url": "https://api.github.com/users/GregoryKimball/following{/other_user}",
            "gists_url": "https://api.github.com/users/GregoryKimball/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GregoryKimball/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GregoryKimball/subscriptions",
            "organizations_url": "https://api.github.com/users/GregoryKimball/orgs",
            "repos_url": "https://api.github.com/users/GregoryKimball/repos",
            "events_url": "https://api.github.com/users/GregoryKimball/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GregoryKimball/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-06-07T21:54:28Z",
        "updated_at": "2023-06-07T21:55:42Z",
        "author_association": "CONTRIBUTOR",
        "body": "This seems to be a problem where libcudf is not writing `datetime64[s]` or `timedelta64[s]` correctly. My testing shows that libcudf is also not roundtripping it faithfully:\r\n\r\n```\r\nimport pyarrow as pa\r\nimport cudf\r\n\r\nfor type in [\r\n    'timedelta64[s]',\r\n    'timedelta64[ms]',\r\n    'timedelta64[us]',\r\n    'timedelta64[ns]',\r\n    'datetime64[s]',\r\n    'datetime64[ms]',\r\n    'datetime64[us]',\r\n    'datetime64[ns]',\r\n]:\r\n\r\n    df = cudf.DataFrame({\"s\": cudf.Series([1234, 3456, 32442], dtype=type)})\r\n    df.to_parquet(\"a\")\r\n    df2 = cudf.read_parquet(\"a\")\r\n    df3 = pa.parquet.read_table(\"a\")    \r\n\r\n    print(df['s'].dtype, df2['s'].dtype, df3['s'].type)\r\n```\r\n\r\noutput\r\ntimedelta64[s] **timedelta64[ms] time32[ms]**\r\ntimedelta64[ms] timedelta64[ms] time32[ms]\r\ntimedelta64[us] timedelta64[us] time64[us]\r\ntimedelta64[ns] timedelta64[ns] time64[ns]\r\ndatetime64[s] **datetime64[ms] timestamp[ms]**\r\ndatetime64[ms] datetime64[ms] timestamp[ms]\r\ndatetime64[us] datetime64[us] timestamp[us]\r\ndatetime64[ns] datetime64[ns] timestamp[ns]\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1581558989/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/2016059578",
        "html_url": "https://github.com/rapidsai/cudf/issues/13409#issuecomment-2016059578",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/13409",
        "id": 2016059578,
        "node_id": "IC_kwDOBWUGps54KqC6",
        "user": {
            "login": "mhaseeb123",
            "id": 14217455,
            "node_id": "MDQ6VXNlcjE0MjE3NDU1",
            "avatar_url": "https://avatars.githubusercontent.com/u/14217455?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mhaseeb123",
            "html_url": "https://github.com/mhaseeb123",
            "followers_url": "https://api.github.com/users/mhaseeb123/followers",
            "following_url": "https://api.github.com/users/mhaseeb123/following{/other_user}",
            "gists_url": "https://api.github.com/users/mhaseeb123/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mhaseeb123/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mhaseeb123/subscriptions",
            "organizations_url": "https://api.github.com/users/mhaseeb123/orgs",
            "repos_url": "https://api.github.com/users/mhaseeb123/repos",
            "events_url": "https://api.github.com/users/mhaseeb123/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mhaseeb123/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-22T23:02:11Z",
        "updated_at": "2024-03-25T20:40:40Z",
        "author_association": "MEMBER",
        "body": "Investigation Notes: \r\n\r\n1. `SECONDS` is not as a valid `TimeUnit` in Parquet and hence converted to milliseconds by both cudf and arrow.\r\n2. I have been able to locally update this behavior and add `SECONDS` to our `TimeUnit` enum class. It round-trips correctly with `cudf` but produces an error when read with pyarrow's parquet reader (invalid unit)\r\n3. cudf's `timedelta` actually corresponds to Arrow's `duration` type instead of `time` type as seen with cudf's `to_arrow` and `from_arrow` functions. However, it is not yet possible to convert between `timedelta64` and `duration` by only using Parquet spec. \r\n4. This is because Arrow encodes `duration` as `int64` in parquet instead of `TimeType`. Arrow does it by also writing serialized `arrow schema` with parquet files: https://github.com/apache/arrow/issues/23117 and https://github.com/apache/arrow/pull/12449/. \r\n5. Arrow types and Parquet types are different sets mapped as needed using arrow schema as a part of parquet file.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/2016059578/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/969319641",
        "html_url": "https://github.com/rapidsai/cudf/issues/8964#issuecomment-969319641",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8964",
        "id": 969319641,
        "node_id": "IC_kwDOBWUGps45xqTZ",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2021-11-15T21:04:49Z",
        "updated_at": "2021-11-15T21:04:49Z",
        "author_association": "NONE",
        "body": "This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/969319641/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/998407795",
        "html_url": "https://github.com/rapidsai/cudf/issues/8964#issuecomment-998407795",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8964",
        "id": 998407795,
        "node_id": "IC_kwDOBWUGps47gn5z",
        "user": {
            "login": "sameerz",
            "id": 7036315,
            "node_id": "MDQ6VXNlcjcwMzYzMTU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7036315?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sameerz",
            "html_url": "https://github.com/sameerz",
            "followers_url": "https://api.github.com/users/sameerz/followers",
            "following_url": "https://api.github.com/users/sameerz/following{/other_user}",
            "gists_url": "https://api.github.com/users/sameerz/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sameerz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sameerz/subscriptions",
            "organizations_url": "https://api.github.com/users/sameerz/orgs",
            "repos_url": "https://api.github.com/users/sameerz/repos",
            "events_url": "https://api.github.com/users/sameerz/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sameerz/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-12-21T02:03:43Z",
        "updated_at": "2021-12-21T02:03:43Z",
        "author_association": "CONTRIBUTOR",
        "body": "This is still required",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/998407795/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1148129111",
        "html_url": "https://github.com/rapidsai/cudf/issues/8964#issuecomment-1148129111",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8964",
        "id": 1148129111,
        "node_id": "IC_kwDOBWUGps5Ebw9X",
        "user": {
            "login": "bdice",
            "id": 3943761,
            "node_id": "MDQ6VXNlcjM5NDM3NjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3943761?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bdice",
            "html_url": "https://github.com/bdice",
            "followers_url": "https://api.github.com/users/bdice/followers",
            "following_url": "https://api.github.com/users/bdice/following{/other_user}",
            "gists_url": "https://api.github.com/users/bdice/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bdice/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bdice/subscriptions",
            "organizations_url": "https://api.github.com/users/bdice/orgs",
            "repos_url": "https://api.github.com/users/bdice/repos",
            "events_url": "https://api.github.com/users/bdice/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bdice/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-06-07T02:36:13Z",
        "updated_at": "2022-06-07T02:36:13Z",
        "author_association": "CONTRIBUTOR",
        "body": "This code snippet demonstrates some behavior with NaNs that I investigated with @rwlee. tl;dr Spark treats NaN the same in binary operators `<, <=, ==, ...` as in the comparators `<, ==` used for sorting and equality. This follows the rules in #4760 but with elementwise comparison of structs.\r\n\r\n<details><summary>Show snippet</summary>\r\n\r\nSave as `binops.scala` and run with: `$ spark-shell -i binops.scala`\r\n\r\n```scala\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.types.{DoubleType, StructType}\r\nimport org.apache.spark.sql.Row\r\n\r\nval schema = new StructType()\r\n  .add(\"struct1\", new StructType()\r\n    .add(\"x\", DoubleType)\r\n    .add(\"y\", DoubleType))\r\n  .add(\"struct2\", new StructType()\r\n    .add(\"x\", DoubleType)\r\n    .add(\"y\", DoubleType))\r\n\r\nval v1 = 1.0\r\nval v2 = Double.NaN\r\n\r\nval structData = Seq(\r\n  Row(Row(v1, v1), Row(v1, v1)),\r\n  Row(Row(v1, v1), Row(v1, v2)),\r\n  Row(Row(v1, v1), Row(v2, v1)),\r\n  Row(Row(v1, v1), Row(v2, v2)),\r\n  Row(Row(v1, v2), Row(v1, v1)),\r\n  Row(Row(v1, v2), Row(v1, v2)),\r\n  Row(Row(v1, v2), Row(v2, v1)),\r\n  Row(Row(v1, v2), Row(v2, v2)),\r\n  Row(Row(v2, v1), Row(v1, v1)),\r\n  Row(Row(v2, v1), Row(v1, v2)),\r\n  Row(Row(v2, v1), Row(v2, v1)),\r\n  Row(Row(v2, v1), Row(v2, v2)),\r\n  Row(Row(v2, v2), Row(v1, v1)),\r\n  Row(Row(v2, v2), Row(v1, v2)),\r\n  Row(Row(v2, v2), Row(v2, v1)),\r\n  Row(Row(v2, v2), Row(v2, v2)),\r\n)\r\n\r\nval df = spark.createDataFrame(\r\n  spark.sparkContext.parallelize(structData), schema)\r\ndf.printSchema()\r\ndf.show(false)\r\n\r\nval df2 = df.selectExpr(\"struct1\", \"struct2\", \"struct1 < struct2\", \"struct1 <= struct2\", \"struct1 == struct2\")\r\ndf2.printSchema()\r\ndf2.show(false)\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Show output</summary>\r\n\r\nThis is the relevant part of the output for understanding NaN behavior.\r\n\r\n```\r\n+----------+----------+-------------------+--------------------+-------------------+\r\n|struct1   |struct2   |(struct1 < struct2)|(struct1 <= struct2)|(struct1 = struct2)|\r\n+----------+----------+-------------------+--------------------+-------------------+\r\n|{1.0, 1.0}|{1.0, 1.0}|false              |true                |true               |\r\n|{1.0, 1.0}|{1.0, NaN}|true               |true                |false              |\r\n|{1.0, 1.0}|{NaN, 1.0}|true               |true                |false              |\r\n|{1.0, 1.0}|{NaN, NaN}|true               |true                |false              |\r\n|{1.0, NaN}|{1.0, 1.0}|false              |false               |false              |\r\n|{1.0, NaN}|{1.0, NaN}|false              |true                |true               |\r\n|{1.0, NaN}|{NaN, 1.0}|true               |true                |false              |\r\n|{1.0, NaN}|{NaN, NaN}|true               |true                |false              |\r\n|{NaN, 1.0}|{1.0, 1.0}|false              |false               |false              |\r\n|{NaN, 1.0}|{1.0, NaN}|false              |false               |false              |\r\n|{NaN, 1.0}|{NaN, 1.0}|false              |true                |true               |\r\n|{NaN, 1.0}|{NaN, NaN}|true               |true                |false              |\r\n|{NaN, NaN}|{1.0, 1.0}|false              |false               |false              |\r\n|{NaN, NaN}|{1.0, NaN}|false              |false               |false              |\r\n|{NaN, NaN}|{NaN, 1.0}|false              |false               |false              |\r\n|{NaN, NaN}|{NaN, NaN}|false              |true                |true               |\r\n+----------+----------+-------------------+--------------------+-------------------+\r\n```\r\n\r\n</details>",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1148129111/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
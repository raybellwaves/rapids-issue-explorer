[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/696822053",
        "html_url": "https://github.com/rapidsai/cudf/issues/6276#issuecomment-696822053",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6276",
        "id": 696822053,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5NjgyMjA1Mw==",
        "user": {
            "login": "ShashaankV",
            "id": 6562289,
            "node_id": "MDQ6VXNlcjY1NjIyODk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6562289?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ShashaankV",
            "html_url": "https://github.com/ShashaankV",
            "followers_url": "https://api.github.com/users/ShashaankV/followers",
            "following_url": "https://api.github.com/users/ShashaankV/following{/other_user}",
            "gists_url": "https://api.github.com/users/ShashaankV/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ShashaankV/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ShashaankV/subscriptions",
            "organizations_url": "https://api.github.com/users/ShashaankV/orgs",
            "repos_url": "https://api.github.com/users/ShashaankV/repos",
            "events_url": "https://api.github.com/users/ShashaankV/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ShashaankV/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-22T16:10:19Z",
        "updated_at": "2020-09-22T16:10:19Z",
        "author_association": "NONE",
        "body": "If someone solves this, I'd like to understand the solution because the denominator in the robust z-score is more complicated than a rolling median (https://medium.com/james-blogs/outliers-make-us-go-mad-univariate-outlier-detection-b3a72f1ea8c7). I'll need to write a UDF for the MAD that hopefully can use similar machinery needed to solve the rolling median. ",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/696822053/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/696906662",
        "html_url": "https://github.com/rapidsai/cudf/issues/6276#issuecomment-696906662",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6276",
        "id": 696906662,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5NjkwNjY2Mg==",
        "user": {
            "login": "jakirkham",
            "id": 3019665,
            "node_id": "MDQ6VXNlcjMwMTk2NjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3019665?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jakirkham",
            "html_url": "https://github.com/jakirkham",
            "followers_url": "https://api.github.com/users/jakirkham/followers",
            "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
            "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
            "organizations_url": "https://api.github.com/users/jakirkham/orgs",
            "repos_url": "https://api.github.com/users/jakirkham/repos",
            "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jakirkham/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-22T18:39:35Z",
        "updated_at": "2020-09-22T18:39:35Z",
        "author_association": "MEMBER",
        "body": "FWIW this is something I [solved before in C++]( https://github.com/nanshe-org/rank_filter/blob/49cd0a35998aaccebab680d14f0f3fb8ac85e5ea/include/rank_filter.hxx#L24 ). May be useful here too.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/696906662/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/697936824",
        "html_url": "https://github.com/rapidsai/cudf/issues/6276#issuecomment-697936824",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6276",
        "id": 697936824,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzkzNjgyNA==",
        "user": {
            "login": "ShashaankV",
            "id": 6562289,
            "node_id": "MDQ6VXNlcjY1NjIyODk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6562289?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ShashaankV",
            "html_url": "https://github.com/ShashaankV",
            "followers_url": "https://api.github.com/users/ShashaankV/followers",
            "following_url": "https://api.github.com/users/ShashaankV/following{/other_user}",
            "gists_url": "https://api.github.com/users/ShashaankV/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ShashaankV/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ShashaankV/subscriptions",
            "organizations_url": "https://api.github.com/users/ShashaankV/orgs",
            "repos_url": "https://api.github.com/users/ShashaankV/repos",
            "events_url": "https://api.github.com/users/ShashaankV/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ShashaankV/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-23T19:51:53Z",
        "updated_at": "2020-09-23T19:51:53Z",
        "author_association": "NONE",
        "body": "Thank you. Hoping for a higher level solution using the cuDF or other RAPIDS objects. However, I'll take a closer look at your C++ solution later. \r\n\r\nFYI - This is my latest version using pandas for calculating a rolling robust z-score (which calls for a rolling median and UDF). It takes 50 minutes per dataframe. Love to speed this up. \r\n\r\n```\r\n##CPU numba version\r\n@nb.njit()\r\ndef fun_mad(x):\r\n  return np.median(np.absolute(x - np.median(x)))\r\n\r\ndef rzscore(df,win):\r\n  mu = df.rolling(window=win).median() \r\n  mad = df.rolling(window=win).apply(fun_mad, engine='numba',raw=True) \r\n  df = 0.6745*(df.subtract(mu)).divide(mad)\r\n  return df\r\n\r\ndfz = rzscore(df,int(2*sHz))\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/697936824/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/713228125",
        "html_url": "https://github.com/rapidsai/cudf/issues/6276#issuecomment-713228125",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6276",
        "id": 713228125,
        "node_id": "MDEyOklzc3VlQ29tbWVudDcxMzIyODEyNQ==",
        "user": {
            "login": "ShashaankV",
            "id": 6562289,
            "node_id": "MDQ6VXNlcjY1NjIyODk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6562289?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ShashaankV",
            "html_url": "https://github.com/ShashaankV",
            "followers_url": "https://api.github.com/users/ShashaankV/followers",
            "following_url": "https://api.github.com/users/ShashaankV/following{/other_user}",
            "gists_url": "https://api.github.com/users/ShashaankV/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ShashaankV/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ShashaankV/subscriptions",
            "organizations_url": "https://api.github.com/users/ShashaankV/orgs",
            "repos_url": "https://api.github.com/users/ShashaankV/repos",
            "events_url": "https://api.github.com/users/ShashaankV/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ShashaankV/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-10-21T01:09:37Z",
        "updated_at": "2020-10-21T01:09:37Z",
        "author_association": "NONE",
        "body": "Working on a selection sorter UDF for the rolling median. ",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/713228125/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/713238967",
        "html_url": "https://github.com/rapidsai/cudf/issues/6276#issuecomment-713238967",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6276",
        "id": 713238967,
        "node_id": "MDEyOklzc3VlQ29tbWVudDcxMzIzODk2Nw==",
        "user": {
            "login": "jakirkham",
            "id": 3019665,
            "node_id": "MDQ6VXNlcjMwMTk2NjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3019665?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jakirkham",
            "html_url": "https://github.com/jakirkham",
            "followers_url": "https://api.github.com/users/jakirkham/followers",
            "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
            "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
            "organizations_url": "https://api.github.com/users/jakirkham/orgs",
            "repos_url": "https://api.github.com/users/jakirkham/repos",
            "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jakirkham/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-10-21T01:46:58Z",
        "updated_at": "2020-10-21T01:46:58Z",
        "author_association": "MEMBER",
        "body": "cc @gmarkall (in case you have ideas on the Numba side of things \ud83d\ude42)",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/713238967/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/713280182",
        "html_url": "https://github.com/rapidsai/cudf/issues/6276#issuecomment-713280182",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6276",
        "id": 713280182,
        "node_id": "MDEyOklzc3VlQ29tbWVudDcxMzI4MDE4Mg==",
        "user": {
            "login": "ShashaankV",
            "id": 6562289,
            "node_id": "MDQ6VXNlcjY1NjIyODk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6562289?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ShashaankV",
            "html_url": "https://github.com/ShashaankV",
            "followers_url": "https://api.github.com/users/ShashaankV/followers",
            "following_url": "https://api.github.com/users/ShashaankV/following{/other_user}",
            "gists_url": "https://api.github.com/users/ShashaankV/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ShashaankV/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ShashaankV/subscriptions",
            "organizations_url": "https://api.github.com/users/ShashaankV/orgs",
            "repos_url": "https://api.github.com/users/ShashaankV/repos",
            "events_url": "https://api.github.com/users/ShashaankV/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ShashaankV/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-10-21T03:49:25Z",
        "updated_at": "2020-10-21T04:05:50Z",
        "author_association": "NONE",
        "body": "Maybe crude but this UDF seems to work for rolling median with cuDF.\r\n\r\n\r\n```\r\ndef median_select(x):\r\n  #get min in array\r\n  minx = x[0]\r\n  for x2 in x[1:]:\r\n    if x2<minx:\r\n      minx = x2\r\n  #iterate until center index\r\n  kcenter = int(len(x)/2)\r\n  #if odd\r\n  if len(x)%2 != 0:\r\n    lb = minx\r\n    for k in range(kcenter):\r\n      ub = 1*10^100\r\n      for x2 in x:\r\n        if x2>lb and x2<ub:\r\n          ub = x2\r\n      lb = ub\r\n    mu = lb\r\n  #if even\r\n  else:\r\n    lb = minx\r\n    for k in range(kcenter-1):\r\n      ub = 1*10^100\r\n      for x2 in x:\r\n        if x2>lb and x2<ub:\r\n          ub = x2\r\n      lb = ub\r\n    mu = lb\r\n    lb = minx\r\n    for k in range(kcenter):\r\n      ub = 1*10^100\r\n      for x2 in x:\r\n        if x2>lb and x2<ub:\r\n          ub = x2\r\n      lb = ub\r\n    mu += lb\r\n    mu = mu/2\r\n  return mu\r\n```\r\n\r\n```\r\nwin = 28\r\nn = win+2\r\n\r\ndf = cudf.DataFrame()\r\ndf['a'] = np.random.normal(0,1,n)\r\ndf['b'] = np.random.normal(0,1,n)\r\nrolling = df.rolling(window=win,axis=0)\r\nprint(rolling.apply(median_select))\r\n\r\npdf = df.to_pandas()\r\nprint(np.median(pdf.iloc[:-2,:],axis=0))\r\nprint(np.median(pdf.iloc[1:-1,:],axis=0))\r\nprint(np.median(pdf.iloc[2:,:],axis=0))\r\n\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/713280182/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/713300575",
        "html_url": "https://github.com/rapidsai/cudf/issues/6276#issuecomment-713300575",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6276",
        "id": 713300575,
        "node_id": "MDEyOklzc3VlQ29tbWVudDcxMzMwMDU3NQ==",
        "user": {
            "login": "ShashaankV",
            "id": 6562289,
            "node_id": "MDQ6VXNlcjY1NjIyODk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6562289?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ShashaankV",
            "html_url": "https://github.com/ShashaankV",
            "followers_url": "https://api.github.com/users/ShashaankV/followers",
            "following_url": "https://api.github.com/users/ShashaankV/following{/other_user}",
            "gists_url": "https://api.github.com/users/ShashaankV/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ShashaankV/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ShashaankV/subscriptions",
            "organizations_url": "https://api.github.com/users/ShashaankV/orgs",
            "repos_url": "https://api.github.com/users/ShashaankV/repos",
            "events_url": "https://api.github.com/users/ShashaankV/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ShashaankV/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-10-21T04:47:59Z",
        "updated_at": "2020-10-21T14:21:58Z",
        "author_association": "NONE",
        "body": "This is two times slower than running the equivalent pandas rolling median. Could try a quicksort but not sure how to implement partition without generating new arrays or altering the original data. ",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/713300575/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/780123476",
        "html_url": "https://github.com/rapidsai/cudf/issues/6276#issuecomment-780123476",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6276",
        "id": 780123476,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDEyMzQ3Ng==",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2021-02-16T21:17:39Z",
        "updated_at": "2021-02-16T21:17:39Z",
        "author_association": "NONE",
        "body": "This issue has been marked rotten due to no recent activity in the past 90d. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/780123476/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
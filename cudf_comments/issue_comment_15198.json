[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1976255700",
        "html_url": "https://github.com/rapidsai/cudf/issues/15198#issuecomment-1976255700",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/15198",
        "id": 1976255700,
        "node_id": "IC_kwDOBWUGps51y0TU",
        "user": {
            "login": "wence-",
            "id": 1126981,
            "node_id": "MDQ6VXNlcjExMjY5ODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1126981?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wence-",
            "html_url": "https://github.com/wence-",
            "followers_url": "https://api.github.com/users/wence-/followers",
            "following_url": "https://api.github.com/users/wence-/following{/other_user}",
            "gists_url": "https://api.github.com/users/wence-/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wence-/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wence-/subscriptions",
            "organizations_url": "https://api.github.com/users/wence-/orgs",
            "repos_url": "https://api.github.com/users/wence-/repos",
            "events_url": "https://api.github.com/users/wence-/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wence-/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-04T10:26:50Z",
        "updated_at": "2024-03-04T10:26:50Z",
        "author_association": "CONTRIBUTOR",
        "body": "I think there should be no default parameters, to force the python-side caller to be fully explicit about stream and memory management.\r\n\r\nMy rationale is that since RMM objects are (deliberately) not smart pointers, there is no way to safely take ownership of an `rmm::device_buffer` from Python. Specifically, if I am passed a `device_buffer` whose memory resource is of a provenance I do not control, I cannot guarantee that I keep the memory resource alive for the lifetime of the buffer.\r\n\r\nIndeed, in RMM, we _don't even try_! \r\n\r\nhttps://github.com/rapidsai/rmm/blob/f132d4b0daa976e1ec6cbcef24f5454fe510a394/python/rmm/_lib/device_buffer.pyx#L160-L171\r\n\r\nWe just do:\r\n```cython\r\n        buf.c_obj = move(ptr)\r\n        buf.mr = get_current_device_resource()\r\n```\r\n\r\nand fingers crossed, `ptr.mr` is the same as `get_current_device_resource()`.\r\n\r\nThere's no way to work around this, so really the only safe way is to document in RMM that if taking ownership of a `device_buffer` from Python, one _must_ only do so when the buffer has been allocated via a memory resource that the python process controls. In libcudf, we can always pass a memory resource in to any allocating routines, so if we do that from the python side with a memory resource whose lifetime we control, we can match the required contract and ensure that we do things safely.\r\n\r\nRight now, everything works through happenstance.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1976255700/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1976349972",
        "html_url": "https://github.com/rapidsai/cudf/issues/15198#issuecomment-1976349972",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/15198",
        "id": 1976349972,
        "node_id": "IC_kwDOBWUGps51zLUU",
        "user": {
            "login": "wence-",
            "id": 1126981,
            "node_id": "MDQ6VXNlcjExMjY5ODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1126981?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wence-",
            "html_url": "https://github.com/wence-",
            "followers_url": "https://api.github.com/users/wence-/followers",
            "following_url": "https://api.github.com/users/wence-/following{/other_user}",
            "gists_url": "https://api.github.com/users/wence-/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wence-/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wence-/subscriptions",
            "organizations_url": "https://api.github.com/users/wence-/orgs",
            "repos_url": "https://api.github.com/users/wence-/repos",
            "events_url": "https://api.github.com/users/wence-/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wence-/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-04T11:17:08Z",
        "updated_at": "2024-03-04T11:17:08Z",
        "author_association": "CONTRIBUTOR",
        "body": "I've opened https://github.com/rapidsai/rmm/issues/1492 to clarify the requirements in docs on the RMM side.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1976349972/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1977153884",
        "html_url": "https://github.com/rapidsai/cudf/issues/15198#issuecomment-1977153884",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/15198",
        "id": 1977153884,
        "node_id": "IC_kwDOBWUGps512Plc",
        "user": {
            "login": "vyasr",
            "id": 1538165,
            "node_id": "MDQ6VXNlcjE1MzgxNjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1538165?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vyasr",
            "html_url": "https://github.com/vyasr",
            "followers_url": "https://api.github.com/users/vyasr/followers",
            "following_url": "https://api.github.com/users/vyasr/following{/other_user}",
            "gists_url": "https://api.github.com/users/vyasr/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/vyasr/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/vyasr/subscriptions",
            "organizations_url": "https://api.github.com/users/vyasr/orgs",
            "repos_url": "https://api.github.com/users/vyasr/repos",
            "events_url": "https://api.github.com/users/vyasr/events{/privacy}",
            "received_events_url": "https://api.github.com/users/vyasr/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-04T17:56:43Z",
        "updated_at": "2024-03-04T17:56:43Z",
        "author_association": "CONTRIBUTOR",
        "body": "Right, the mr discussion is in #14229.\r\n\r\nPlaying devil's advocate: while the pitfalls of default mrs are clear, that also makes the overall API very cumbersome when you have a libcudf API with 7 parameters (including stream/mr) of which 5 are defaulted because there are sensible choices. This would force users to also provide the other 3 in addition to stream/mr.\r\n\r\nIf we restrict the \"no defaults\" choice to only APIs then it would still allow us to make some improvements like those suggested in #15130, but if we disallowed defaults everywhere it could have additional impacts on how much syntactic sugar we can add to the pylibcudf API in a performant manner.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1977153884/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1979113843",
        "html_url": "https://github.com/rapidsai/cudf/issues/15198#issuecomment-1979113843",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/15198",
        "id": 1979113843,
        "node_id": "IC_kwDOBWUGps519uFz",
        "user": {
            "login": "wence-",
            "id": 1126981,
            "node_id": "MDQ6VXNlcjExMjY5ODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1126981?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wence-",
            "html_url": "https://github.com/wence-",
            "followers_url": "https://api.github.com/users/wence-/followers",
            "following_url": "https://api.github.com/users/wence-/following{/other_user}",
            "gists_url": "https://api.github.com/users/wence-/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wence-/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wence-/subscriptions",
            "organizations_url": "https://api.github.com/users/wence-/orgs",
            "repos_url": "https://api.github.com/users/wence-/repos",
            "events_url": "https://api.github.com/users/wence-/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wence-/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-05T16:04:21Z",
        "updated_at": "2024-03-05T16:04:21Z",
        "author_association": "CONTRIBUTOR",
        "body": "I think I am advocating only that the wrapping of the libcudf API provides no defaults. I would alternately be happy if the `cpdef` functions took keyword defaulted arguments for stream and mr (so that one can provide, say, the mr but not the stream if one wants)",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1979113843/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
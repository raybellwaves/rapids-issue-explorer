[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/866132729",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-866132729",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 866132729,
        "node_id": "MDEyOklzc3VlQ29tbWVudDg2NjEzMjcyOQ==",
        "user": {
            "login": "beckernick",
            "id": 8457388,
            "node_id": "MDQ6VXNlcjg0NTczODg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8457388?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/beckernick",
            "html_url": "https://github.com/beckernick",
            "followers_url": "https://api.github.com/users/beckernick/followers",
            "following_url": "https://api.github.com/users/beckernick/following{/other_user}",
            "gists_url": "https://api.github.com/users/beckernick/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/beckernick/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/beckernick/subscriptions",
            "organizations_url": "https://api.github.com/users/beckernick/orgs",
            "repos_url": "https://api.github.com/users/beckernick/repos",
            "events_url": "https://api.github.com/users/beckernick/events{/privacy}",
            "received_events_url": "https://api.github.com/users/beckernick/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-06-22T16:21:33Z",
        "updated_at": "2021-06-22T16:21:33Z",
        "author_association": "MEMBER",
        "body": "Thanks for including a simple reproducer gist. I've included it below for ease of access.\r\n\r\n```python\r\nimport pandas as pd\r\nimport cudf\r\nimport numpy as np\r\n\u200b\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 00:00+0000',  '%Y-%m-%d %H:%M%z'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 03:00+0000',  '%Y-%m-%d %H:%M%z'))\r\ntimestamps = pd.date_range(start, end, freq='1H')\r\nlabels = ['A', 'B', 'C']\r\nindex = pd.MultiIndex.from_product([timestamps, labels], names=[\"timestamp\", \"label\"])\r\nvalue = np.random.normal(size=12)\r\ndf = pd.DataFrame(value, index=index, columns=['value'])\r\ndf_gpu = cudf.from_pandas(df)\r\n\u200b\r\nstamp = pd.Timestamp(datetime.strptime('2021-03-12 02:00+0000',  '%Y-%m-%d %H:%M%z'))\r\n\u200b\r\nprint(df.loc[stamp]) # SUCCEEDS\r\nprint(df_gpu.loc[stamp]) # FAILS\r\n          value\r\nlabel          \r\nA      1.184793\r\nB     -0.253166\r\nC     -0.790236\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/indexing.py in __getitem__(self, arg)\r\n    234             try:\r\n--> 235                 return self._getitem_tuple_arg(arg)\r\n    236             except (TypeError, KeyError, IndexError, ValueError):\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/contextlib.py in inner(*args, **kwds)\r\n     74             with self._recreate_cm():\r\n---> 75                 return func(*args, **kwds)\r\n     76         return inner\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/indexing.py in _getitem_tuple_arg(self, arg)\r\n    360                 else:\r\n--> 361                     return columns_df.index._get_row_major(columns_df, arg)\r\n    362         else:\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/multiindex.py in _get_row_major(self, df, row_tuple)\r\n    926                 row_tuple = slice(row_tuple.start, self[-1], row_tuple.step)\r\n--> 927         self._validate_indexer(row_tuple)\r\n    928         valid_indices = self._get_valid_indices_by_tuple(\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/multiindex.py in _validate_indexer(self, indexer)\r\n    958         else:\r\n--> 959             for i in indexer:\r\n    960                 self._validate_indexer(i)\r\n\r\nTypeError: 'Timestamp' object is not iterable\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-87-fe779946243b> in <module>\r\n     15 \r\n     16 print(df.loc[stamp]) # SUCCEEDS\r\n---> 17 print(df_gpu.loc[stamp]) # FAILS\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/indexing.py in __getitem__(self, arg)\r\n    235                 return self._getitem_tuple_arg(arg)\r\n    236             except (TypeError, KeyError, IndexError, ValueError):\r\n--> 237                 return self._getitem_tuple_arg((arg, slice(None)))\r\n    238         else:\r\n    239             if not isinstance(arg, tuple):\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/contextlib.py in inner(*args, **kwds)\r\n     73         def inner(*args, **kwds):\r\n     74             with self._recreate_cm():\r\n---> 75                 return func(*args, **kwds)\r\n     76         return inner\r\n     77 \r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/indexing.py in _getitem_tuple_arg(self, arg)\r\n    357             else:\r\n    358                 if isinstance(arg, tuple):\r\n--> 359                     return columns_df.index._get_row_major(columns_df, arg[0])\r\n    360                 else:\r\n    361                     return columns_df.index._get_row_major(columns_df, arg)\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/multiindex.py in _get_row_major(self, df, row_tuple)\r\n    925             if row_tuple.stop is None:\r\n    926                 row_tuple = slice(row_tuple.start, self[-1], row_tuple.step)\r\n--> 927         self._validate_indexer(row_tuple)\r\n    928         valid_indices = self._get_valid_indices_by_tuple(\r\n    929             df.index, row_tuple, len(df.index)\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/multiindex.py in _validate_indexer(self, indexer)\r\n    957             self._validate_indexer(indexer.stop)\r\n    958         else:\r\n--> 959             for i in indexer:\r\n    960                 self._validate_indexer(i)\r\n    961 \r\n\r\nTypeError: 'Timestamp' object is not iterable\r\n```\r\n\r\nIt looks like we go down a codepath that expects an iterable, which explains why wrapping with a tuple works (and may resolve your problem in the short term):\r\n\r\n```python\r\nprint(df_gpu.loc[(stamp,)]) # SUCCEEDS\r\n          value\r\nlabel          \r\nA      1.184793\r\nB     -0.253166\r\nC     -0.790236\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/866132729/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/867041028",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-867041028",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 867041028,
        "node_id": "MDEyOklzc3VlQ29tbWVudDg2NzA0MTAyOA==",
        "user": {
            "login": "pbruneau",
            "id": 4252621,
            "node_id": "MDQ6VXNlcjQyNTI2MjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4252621?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pbruneau",
            "html_url": "https://github.com/pbruneau",
            "followers_url": "https://api.github.com/users/pbruneau/followers",
            "following_url": "https://api.github.com/users/pbruneau/following{/other_user}",
            "gists_url": "https://api.github.com/users/pbruneau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pbruneau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pbruneau/subscriptions",
            "organizations_url": "https://api.github.com/users/pbruneau/orgs",
            "repos_url": "https://api.github.com/users/pbruneau/repos",
            "events_url": "https://api.github.com/users/pbruneau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pbruneau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-06-23T17:52:44Z",
        "updated_at": "2021-06-23T17:52:44Z",
        "author_association": "NONE",
        "body": "Hi @beckernick, thanks for the answer!\r\n\r\nThe \"tuple trick\" above seems to do the job for accessing a single value. However, I'm back into trouble if I want to fetch values for a timestamp range.\r\n\r\nElaborating from my previous gist example, if I type:\r\n\r\n```\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 01:00+0000',  '%Y-%m-%d %H:%M%z'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 02:00+0000',  '%Y-%m-%d %H:%M%z'))\r\nprint(df.loc[start:end])\r\n```\r\n\r\nI get the expected result:\r\n\r\n```\r\n                                    value\r\ntimestamp                 label          \r\n2021-03-12 01:00:00+00:00 A     -0.466112\r\n                          B     -0.781473\r\n                          C     -1.010174\r\n2021-03-12 02:00:00+00:00 A      0.160179\r\n                          B      1.007183\r\n                          C     -1.053772\r\n```\r\n\r\nWith cuDF, the following gets the usual `TypeError: 'Timestamp' object is not iterable`:\r\n\r\n```\r\nprint(df_gpu.loc[start:end])\r\n```\r\n\r\nAlternatively, trying:\r\n\r\n```\r\nprint(df_gpu.loc[(start:end,)])\r\n```\r\n\r\ngets a `SyntaxError: invalid syntax`. Using a _regular_ Timestamp range with:\r\n\r\n```\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 01:00+0000',  '%Y-%m-%d %H:%M%z'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 02:00+0000',  '%Y-%m-%d %H:%M%z'))\r\ntimestamps = pd.date_range(start, end, freq='1H')\r\nprint(df_gpu.loc[(timestamps,)])\r\n```\r\n\r\nI get `ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()`. Any idea for circumventing this issue?",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/867041028/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/877636167",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-877636167",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 877636167,
        "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzYzNjE2Nw==",
        "user": {
            "login": "pbruneau",
            "id": 4252621,
            "node_id": "MDQ6VXNlcjQyNTI2MjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4252621?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pbruneau",
            "html_url": "https://github.com/pbruneau",
            "followers_url": "https://api.github.com/users/pbruneau/followers",
            "following_url": "https://api.github.com/users/pbruneau/following{/other_user}",
            "gists_url": "https://api.github.com/users/pbruneau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pbruneau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pbruneau/subscriptions",
            "organizations_url": "https://api.github.com/users/pbruneau/orgs",
            "repos_url": "https://api.github.com/users/pbruneau/repos",
            "events_url": "https://api.github.com/users/pbruneau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pbruneau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-07-10T13:14:38Z",
        "updated_at": "2021-07-10T13:14:38Z",
        "author_association": "NONE",
        "body": "Hi,\r\n\r\nI'm following up about the bug reported above,\r\nas reported in my last answer, using a tuple to access a Timestamp first level of a MultiIndex circumvents the issue pointed out initially,\r\nbut the proposed solution fails if one wants to access a Timestamp range.\r\n\r\nI realize that the title is not accurately reflecting the actually remaining bug: should I create a new issue which singles out the Timestamp range bug, or rename this one?",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/877636167/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/953187085",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-953187085",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 953187085,
        "node_id": "IC_kwDOBWUGps440HsN",
        "user": {
            "login": "beckernick",
            "id": 8457388,
            "node_id": "MDQ6VXNlcjg0NTczODg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8457388?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/beckernick",
            "html_url": "https://github.com/beckernick",
            "followers_url": "https://api.github.com/users/beckernick/followers",
            "following_url": "https://api.github.com/users/beckernick/following{/other_user}",
            "gists_url": "https://api.github.com/users/beckernick/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/beckernick/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/beckernick/subscriptions",
            "organizations_url": "https://api.github.com/users/beckernick/orgs",
            "repos_url": "https://api.github.com/users/beckernick/repos",
            "events_url": "https://api.github.com/users/beckernick/events{/privacy}",
            "received_events_url": "https://api.github.com/users/beckernick/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-27T18:12:16Z",
        "updated_at": "2021-10-27T18:12:16Z",
        "author_association": "MEMBER",
        "body": "We've been refactoring our MultiIndex implementation to help make it more efficient and maintainable. Is the pandas snippet in the comment above a minimal example of the desired behavior @pbruneau ?",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/953187085/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/957636459",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-957636459",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 957636459,
        "node_id": "IC_kwDOBWUGps45FF9r",
        "user": {
            "login": "pbruneau",
            "id": 4252621,
            "node_id": "MDQ6VXNlcjQyNTI2MjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4252621?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pbruneau",
            "html_url": "https://github.com/pbruneau",
            "followers_url": "https://api.github.com/users/pbruneau/followers",
            "following_url": "https://api.github.com/users/pbruneau/following{/other_user}",
            "gists_url": "https://api.github.com/users/pbruneau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pbruneau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pbruneau/subscriptions",
            "organizations_url": "https://api.github.com/users/pbruneau/orgs",
            "repos_url": "https://api.github.com/users/pbruneau/repos",
            "events_url": "https://api.github.com/users/pbruneau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pbruneau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-11-02T13:59:15Z",
        "updated_at": "2021-11-02T13:59:15Z",
        "author_association": "NONE",
        "body": "Hi @beckernick,\r\n\r\n[Here is an updated minimal gist](https://gist.github.com/pbruneau/53312fe4bef649b7780f8f63bf09fbe1) which lists in details what works, does not work, and workarounds (as of version 21.08.02 installed on my side).\r\n\r\nIn a nutshell (please refer to the gist for details): with a MultiIndex and timestamps as primary key, pandas allows to do this kind of operation:\r\n\r\n```\r\ndf.loc[stamp]\r\ndf.loc[timestamps]\r\n```\r\nwith `stamp` and `timestamps` valid timestamp and timestamp range, respectively. I would like to do the same with cudf, but as of v21.08.02, it is impossible.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/957636459/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1025774228",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-1025774228",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 1025774228,
        "node_id": "IC_kwDOBWUGps49JBKU",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2022-01-31T14:07:30Z",
        "updated_at": "2022-01-31T14:07:30Z",
        "author_association": "NONE",
        "body": "This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1025774228/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1027915260",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-1027915260",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 1027915260,
        "node_id": "IC_kwDOBWUGps49RL38",
        "user": {
            "login": "pbruneau",
            "id": 4252621,
            "node_id": "MDQ6VXNlcjQyNTI2MjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4252621?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pbruneau",
            "html_url": "https://github.com/pbruneau",
            "followers_url": "https://api.github.com/users/pbruneau/followers",
            "following_url": "https://api.github.com/users/pbruneau/following{/other_user}",
            "gists_url": "https://api.github.com/users/pbruneau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pbruneau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pbruneau/subscriptions",
            "organizations_url": "https://api.github.com/users/pbruneau/orgs",
            "repos_url": "https://api.github.com/users/pbruneau/repos",
            "events_url": "https://api.github.com/users/pbruneau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pbruneau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-02-02T12:57:38Z",
        "updated_at": "2022-02-02T12:57:38Z",
        "author_association": "NONE",
        "body": "The problems reported above and highlighted [in this minimal gist](https://gist.github.com/pbruneau/53312fe4bef649b7780f8f63bf09fbe1) still occur with v21.12, with exactly the same error messages.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1027915260/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1531749435",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-1531749435",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 1531749435,
        "node_id": "IC_kwDOBWUGps5bTKQ7",
        "user": {
            "login": "wence-",
            "id": 1126981,
            "node_id": "MDQ6VXNlcjExMjY5ODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1126981?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wence-",
            "html_url": "https://github.com/wence-",
            "followers_url": "https://api.github.com/users/wence-/followers",
            "following_url": "https://api.github.com/users/wence-/following{/other_user}",
            "gists_url": "https://api.github.com/users/wence-/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wence-/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wence-/subscriptions",
            "organizations_url": "https://api.github.com/users/wence-/orgs",
            "repos_url": "https://api.github.com/users/wence-/repos",
            "events_url": "https://api.github.com/users/wence-/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wence-/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-02T16:13:46Z",
        "updated_at": "2023-05-02T16:18:39Z",
        "author_association": "CONTRIBUTOR",
        "body": "An update here (I am working through many indexing corner cases), apologies for the very slow responses.\r\n\r\nIn 23.06 (the current development version) there is an error constructing time-zone aware timestamps (previously they were accepted but handled incorrectly, now they are not accepted, soon they will be accepted and handled correctly). However, if I remove the timezone portion of the timestamps, then only your last example now fails (I reproduce here for posterity):\r\n```python\r\nimport pandas as pd\r\nfrom datetime import datetime\r\nimport cudf\r\nimport numpy as np\r\n\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 00:00',  '%Y-%m-%d %H:%M'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 03:00',  '%Y-%m-%d %H:%M'))\r\ntimestamps = pd.date_range(start, end, freq='1H')\r\nlabels = ['A', 'B', 'C']\r\nindex = pd.MultiIndex.from_product([timestamps, labels], names=[\"timestamp\", \"label\"])\r\nvalue = np.random.normal(size=12)\r\ndf = pd.DataFrame(value, index=index, columns=['value'])\r\n\r\ndf_gpu = cudf.from_pandas(df)\r\n\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 01:00',  '%Y-%m-%d %H:%M'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 02:00',  '%Y-%m-%d %H:%M'))\r\ntimestamps = pd.date_range(start, end, freq='1H')\r\n\r\n# SUCCEEDS\r\nprint(df.loc[timestamps])\r\n\r\n# FAILS\r\nprint(df_gpu.loc[timestamps])\r\n\r\n# indexing with a slice range also fails in this case.\r\ndf_gpu.loc[start:end] # Fails\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1531749435/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1532505485",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-1532505485",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 1532505485,
        "node_id": "IC_kwDOBWUGps5bWC2N",
        "user": {
            "login": "pbruneau",
            "id": 4252621,
            "node_id": "MDQ6VXNlcjQyNTI2MjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4252621?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pbruneau",
            "html_url": "https://github.com/pbruneau",
            "followers_url": "https://api.github.com/users/pbruneau/followers",
            "following_url": "https://api.github.com/users/pbruneau/following{/other_user}",
            "gists_url": "https://api.github.com/users/pbruneau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pbruneau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pbruneau/subscriptions",
            "organizations_url": "https://api.github.com/users/pbruneau/orgs",
            "repos_url": "https://api.github.com/users/pbruneau/repos",
            "events_url": "https://api.github.com/users/pbruneau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pbruneau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-03T06:29:04Z",
        "updated_at": "2023-05-03T06:29:04Z",
        "author_association": "NONE",
        "body": "Hi @wence-,\r\n\r\nI'm installing via Docker, so I can't check out by myself (23.06 does not seem to be available then),\r\n\r\nIf I get it right, this means that:\r\n```\r\nprint(df_gpu.loc[timestamps])\r\n```\r\nworks fine? I would already have a workaround, then!",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1532505485/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1532657541",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-1532657541",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 1532657541,
        "node_id": "IC_kwDOBWUGps5bWn-F",
        "user": {
            "login": "wence-",
            "id": 1126981,
            "node_id": "MDQ6VXNlcjExMjY5ODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1126981?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wence-",
            "html_url": "https://github.com/wence-",
            "followers_url": "https://api.github.com/users/wence-/followers",
            "following_url": "https://api.github.com/users/wence-/following{/other_user}",
            "gists_url": "https://api.github.com/users/wence-/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wence-/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wence-/subscriptions",
            "organizations_url": "https://api.github.com/users/wence-/orgs",
            "repos_url": "https://api.github.com/users/wence-/repos",
            "events_url": "https://api.github.com/users/wence-/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wence-/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-03T08:44:42Z",
        "updated_at": "2023-05-03T08:44:42Z",
        "author_association": "CONTRIBUTOR",
        "body": "> Hi @wence-,\r\n> \r\n> I'm installing via Docker, so I can't check out by myself (23.06 does not seem to be available then),\r\n> \r\n> If I get it right, this means that:\r\n> \r\n> ```\r\n> print(df_gpu.loc[timestamps])\r\n> ```\r\n> \r\n> works fine? I would already have a workaround, then!\r\n\r\nIf your dataframe has a multiindex, that example does not _yet_ work. If you just have a normal index, it does work.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1532657541/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1532779661",
        "html_url": "https://github.com/rapidsai/cudf/issues/8585#issuecomment-1532779661",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/8585",
        "id": 1532779661,
        "node_id": "IC_kwDOBWUGps5bXFyN",
        "user": {
            "login": "pbruneau",
            "id": 4252621,
            "node_id": "MDQ6VXNlcjQyNTI2MjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4252621?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pbruneau",
            "html_url": "https://github.com/pbruneau",
            "followers_url": "https://api.github.com/users/pbruneau/followers",
            "following_url": "https://api.github.com/users/pbruneau/following{/other_user}",
            "gists_url": "https://api.github.com/users/pbruneau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pbruneau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pbruneau/subscriptions",
            "organizations_url": "https://api.github.com/users/pbruneau/orgs",
            "repos_url": "https://api.github.com/users/pbruneau/repos",
            "events_url": "https://api.github.com/users/pbruneau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pbruneau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-03T10:19:40Z",
        "updated_at": "2023-05-03T10:19:40Z",
        "author_association": "NONE",
        "body": "> > Hi @wence-,\r\n> > I'm installing via Docker, so I can't check out by myself (23.06 does not seem to be available then),\r\n> > If I get it right, this means that:\r\n> > ```\r\n> > print(df_gpu.loc[timestamps])\r\n> > ```\r\n> > \r\n> > \r\n> >     \r\n> >       \r\n> >     \r\n> > \r\n> >       \r\n> >     \r\n> > \r\n> >     \r\n> >   \r\n> > works fine? I would already have a workaround, then!\r\n> \r\n> If your dataframe has a multiindex, that example does not _yet_ work. If you just have a normal index, it does work.\r\n\r\nOK! Good luck with the development then (even if luck has nothing to do with it :)",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/1532779661/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
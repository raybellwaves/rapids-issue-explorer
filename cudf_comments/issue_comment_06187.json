[
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/689801723",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-689801723",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 689801723,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTgwMTcyMw==",
        "user": {
            "login": "vuule",
            "id": 16005690,
            "node_id": "MDQ6VXNlcjE2MDA1Njkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/16005690?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vuule",
            "html_url": "https://github.com/vuule",
            "followers_url": "https://api.github.com/users/vuule/followers",
            "following_url": "https://api.github.com/users/vuule/following{/other_user}",
            "gists_url": "https://api.github.com/users/vuule/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/vuule/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/vuule/subscriptions",
            "organizations_url": "https://api.github.com/users/vuule/orgs",
            "repos_url": "https://api.github.com/users/vuule/repos",
            "events_url": "https://api.github.com/users/vuule/events{/privacy}",
            "received_events_url": "https://api.github.com/users/vuule/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-09T20:24:08Z",
        "updated_at": "2020-09-09T20:24:08Z",
        "author_association": "CONTRIBUTOR",
        "body": "I had the same suggestion in the PR that added the `supports_device_write` logic. It was rejected because readers/writers have the context to better optimize the IO operations compared to having the host/device logic in the source/sink.\r\n\r\n> Looks like ORC doesn't have this logic at all, which might be a bug?\r\n\r\nYeah, it's a missing feature. In all components but Parquet. We'll be adding this logic to every format soon, including readers. So, `supports_device_read` will also be used very soon :)",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/689801723/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/689861703",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-689861703",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 689861703,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTg2MTcwMw==",
        "user": {
            "login": "cwharris",
            "id": 1445368,
            "node_id": "MDQ6VXNlcjE0NDUzNjg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1445368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/cwharris",
            "html_url": "https://github.com/cwharris",
            "followers_url": "https://api.github.com/users/cwharris/followers",
            "following_url": "https://api.github.com/users/cwharris/following{/other_user}",
            "gists_url": "https://api.github.com/users/cwharris/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/cwharris/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/cwharris/subscriptions",
            "organizations_url": "https://api.github.com/users/cwharris/orgs",
            "repos_url": "https://api.github.com/users/cwharris/repos",
            "events_url": "https://api.github.com/users/cwharris/events{/privacy}",
            "received_events_url": "https://api.github.com/users/cwharris/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-09T22:44:46Z",
        "updated_at": "2020-09-09T22:44:46Z",
        "author_association": "CONTRIBUTOR",
        "body": "> because readers/writers have the context to better optimize the IO operations compared to having the host/device logic in the source/sink.\r\n\r\n:(\r\n\r\nAny chance you have the PR number? I'd like to see the reasoning. I imagining the control could still be inverted...",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/689861703/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/689864555",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-689864555",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 689864555,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTg2NDU1NQ==",
        "user": {
            "login": "vuule",
            "id": 16005690,
            "node_id": "MDQ6VXNlcjE2MDA1Njkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/16005690?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vuule",
            "html_url": "https://github.com/vuule",
            "followers_url": "https://api.github.com/users/vuule/followers",
            "following_url": "https://api.github.com/users/vuule/following{/other_user}",
            "gists_url": "https://api.github.com/users/vuule/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/vuule/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/vuule/subscriptions",
            "organizations_url": "https://api.github.com/users/vuule/orgs",
            "repos_url": "https://api.github.com/users/vuule/repos",
            "events_url": "https://api.github.com/users/vuule/events{/privacy}",
            "received_events_url": "https://api.github.com/users/vuule/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-09T22:52:38Z",
        "updated_at": "2020-09-09T22:52:38Z",
        "author_association": "CONTRIBUTOR",
        "body": "@cwharris here you go: https://github.com/rapidsai/cudf/pull/4231#discussion_r384104534",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/689864555/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/689876187",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-689876187",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 689876187,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTg3NjE4Nw==",
        "user": {
            "login": "cwharris",
            "id": 1445368,
            "node_id": "MDQ6VXNlcjE0NDUzNjg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1445368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/cwharris",
            "html_url": "https://github.com/cwharris",
            "followers_url": "https://api.github.com/users/cwharris/followers",
            "following_url": "https://api.github.com/users/cwharris/following{/other_user}",
            "gists_url": "https://api.github.com/users/cwharris/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/cwharris/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/cwharris/subscriptions",
            "organizations_url": "https://api.github.com/users/cwharris/orgs",
            "repos_url": "https://api.github.com/users/cwharris/repos",
            "events_url": "https://api.github.com/users/cwharris/events{/privacy}",
            "received_events_url": "https://api.github.com/users/cwharris/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-09T23:26:32Z",
        "updated_at": "2020-09-09T23:26:32Z",
        "author_association": "CONTRIBUTOR",
        "body": "Is this device or host memory we're concerned with? @nvdbaranec ",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/689876187/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/690343997",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-690343997",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 690343997,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5MDM0Mzk5Nw==",
        "user": {
            "login": "nvdbaranec",
            "id": 56695930,
            "node_id": "MDQ6VXNlcjU2Njk1OTMw",
            "avatar_url": "https://avatars.githubusercontent.com/u/56695930?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nvdbaranec",
            "html_url": "https://github.com/nvdbaranec",
            "followers_url": "https://api.github.com/users/nvdbaranec/followers",
            "following_url": "https://api.github.com/users/nvdbaranec/following{/other_user}",
            "gists_url": "https://api.github.com/users/nvdbaranec/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nvdbaranec/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nvdbaranec/subscriptions",
            "organizations_url": "https://api.github.com/users/nvdbaranec/orgs",
            "repos_url": "https://api.github.com/users/nvdbaranec/repos",
            "events_url": "https://api.github.com/users/nvdbaranec/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nvdbaranec/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-10T14:53:51Z",
        "updated_at": "2020-09-10T14:53:51Z",
        "author_association": "CONTRIBUTOR",
        "body": "Are you asking about my comment re: having to alloc/free on the spot for a default implementation?  The thinking there was that it would have to allocate host memory, do a memcpy, then do it's write, then immediately free that memory even though it would probably be doing that multiple times.  If you look at how the code is structured here:  https://github.com/rapidsai/cudf/blob/ac39e372d771b604b64d1c704c2c846ee1edde2d/cpp/src/io/parquet/writer_impl.cu#L835\r\n\r\nIt allocates one worst-case sized buffer and then reuses that for multiple write calls.   A default implementation would have no context what's going on and what have to alloc/free every time which is undesirable from a performance perspective (doubly so because we're using pinned memory here)\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/690343997/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/691506851",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-691506851",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 691506851,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTUwNjg1MQ==",
        "user": {
            "login": "cwharris",
            "id": 1445368,
            "node_id": "MDQ6VXNlcjE0NDUzNjg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1445368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/cwharris",
            "html_url": "https://github.com/cwharris",
            "followers_url": "https://api.github.com/users/cwharris/followers",
            "following_url": "https://api.github.com/users/cwharris/following{/other_user}",
            "gists_url": "https://api.github.com/users/cwharris/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/cwharris/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/cwharris/subscriptions",
            "organizations_url": "https://api.github.com/users/cwharris/orgs",
            "repos_url": "https://api.github.com/users/cwharris/repos",
            "events_url": "https://api.github.com/users/cwharris/events{/privacy}",
            "received_events_url": "https://api.github.com/users/cwharris/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-12T15:34:36Z",
        "updated_at": "2020-09-12T15:39:40Z",
        "author_association": "CONTRIBUTOR",
        "body": "If the invocation sites are bifurcated due to the need for multiple passes using the same buffer, we could use a two-step API instead. The first step uses RAII to obtain a worst-case-size buffer, and the second step writes using that buffer. The second step could be called any number of times. Since the buffer type can differ (or simply be unnecessary), we could wrap it in a context to hide the details. For instance:\r\n```c++\r\n{\r\n  // may or may not create a buffer, depending on what type of sink is being used.\r\n  auto sink_context = out_sink->create_write_context(max_chunk_bfr_size);\r\n  for (; r < rnext; r++, global_r++) {\r\n    for (auto i = 0; i < num_columns; i++) {\r\n      ...\r\n      // writes using the worst-case-size buffer, if one was required.\r\n      sink_context.write(dev_bfr + ck->ck_stat_size, ck.compressed_size, state.stream);\r\n      ...\r\n    }\r\n  }   \r\n}\r\n// buffer goes out of scope and associated memory is released\r\n```\r\n\r\nThat `create_write_context` api should accept any relevant information about the data that's going to be written, with regards to the number of passes and size of each pass.\r\n\r\nAlternatively, we could use a memory allocator behind the scenes, but that could be more complicated given that the situation is pretty clearly defined in this case.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/691506851/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/692164907",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-692164907",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 692164907,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5MjE2NDkwNw==",
        "user": {
            "login": "vuule",
            "id": 16005690,
            "node_id": "MDQ6VXNlcjE2MDA1Njkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/16005690?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vuule",
            "html_url": "https://github.com/vuule",
            "followers_url": "https://api.github.com/users/vuule/followers",
            "following_url": "https://api.github.com/users/vuule/following{/other_user}",
            "gists_url": "https://api.github.com/users/vuule/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/vuule/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/vuule/subscriptions",
            "organizations_url": "https://api.github.com/users/vuule/orgs",
            "repos_url": "https://api.github.com/users/vuule/repos",
            "events_url": "https://api.github.com/users/vuule/events{/privacy}",
            "received_events_url": "https://api.github.com/users/vuule/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-14T16:20:51Z",
        "updated_at": "2020-09-14T16:20:51Z",
        "author_association": "CONTRIBUTOR",
        "body": "There is a plan to improve performance by processing files in batches (when possible) so that IO can be overlapped with kernels. We don't currently have the infrastructure to make this change. \r\nSince this would significantly change how the sources/sinks are used, I would postpone addressing this issue for now. In addition, I don't think this part of the code is what we need to focus on in the refactoring effort. There are many other components that would benefit more from clean up.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/692164907/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/692234400",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-692234400",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 692234400,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY5MjIzNDQwMA==",
        "user": {
            "login": "vuule",
            "id": 16005690,
            "node_id": "MDQ6VXNlcjE2MDA1Njkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/16005690?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vuule",
            "html_url": "https://github.com/vuule",
            "followers_url": "https://api.github.com/users/vuule/followers",
            "following_url": "https://api.github.com/users/vuule/following{/other_user}",
            "gists_url": "https://api.github.com/users/vuule/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/vuule/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/vuule/subscriptions",
            "organizations_url": "https://api.github.com/users/vuule/orgs",
            "repos_url": "https://api.github.com/users/vuule/repos",
            "events_url": "https://api.github.com/users/vuule/events{/privacy}",
            "received_events_url": "https://api.github.com/users/vuule/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-14T18:31:17Z",
        "updated_at": "2020-09-14T18:31:17Z",
        "author_association": "CONTRIBUTOR",
        "body": "IMO this is not a 'tech debt' issue, removed the tag. \r\nDepending on future changes to how IO is pipelined, this issue might not get implemented. Keeping open for now.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/692234400/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/780123597",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-780123597",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 780123597,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDEyMzU5Nw==",
        "user": {
            "login": "github-actions[bot]",
            "id": 41898282,
            "node_id": "MDM6Qm90NDE4OTgyODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/github-actions%5Bbot%5D",
            "html_url": "https://github.com/apps/github-actions",
            "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2021-02-16T21:17:52Z",
        "updated_at": "2021-02-16T21:17:52Z",
        "author_association": "NONE",
        "body": "This issue has been marked rotten due to no recent activity in the past 90d. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/780123597/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/780899827",
        "html_url": "https://github.com/rapidsai/cudf/issues/6187#issuecomment-780899827",
        "issue_url": "https://api.github.com/repos/rapidsai/cudf/issues/6187",
        "id": 780899827,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDg5OTgyNw==",
        "user": {
            "login": "vuule",
            "id": 16005690,
            "node_id": "MDQ6VXNlcjE2MDA1Njkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/16005690?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vuule",
            "html_url": "https://github.com/vuule",
            "followers_url": "https://api.github.com/users/vuule/followers",
            "following_url": "https://api.github.com/users/vuule/following{/other_user}",
            "gists_url": "https://api.github.com/users/vuule/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/vuule/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/vuule/subscriptions",
            "organizations_url": "https://api.github.com/users/vuule/orgs",
            "repos_url": "https://api.github.com/users/vuule/repos",
            "events_url": "https://api.github.com/users/vuule/events{/privacy}",
            "received_events_url": "https://api.github.com/users/vuule/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-02-17T22:35:35Z",
        "updated_at": "2021-02-17T22:35:35Z",
        "author_association": "CONTRIBUTOR",
        "body": "Keeping this open, will be potentially addressed at a later date.",
        "reactions": {
            "url": "https://api.github.com/repos/rapidsai/cudf/issues/comments/780899827/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
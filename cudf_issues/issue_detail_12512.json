{
    "url": "https://api.github.com/repos/rapidsai/cudf/issues/12512",
    "repository_url": "https://api.github.com/repos/rapidsai/cudf",
    "labels_url": "https://api.github.com/repos/rapidsai/cudf/issues/12512/labels{/name}",
    "comments_url": "https://api.github.com/repos/rapidsai/cudf/issues/12512/comments",
    "events_url": "https://api.github.com/repos/rapidsai/cudf/issues/12512/events",
    "html_url": "https://github.com/rapidsai/cudf/issues/12512",
    "id": 1527373755,
    "node_id": "I_kwDOBWUGps5bCd-7",
    "number": 12512,
    "title": "[BUG] read_parquet/read_orc with filters do not filter specific rows",
    "user": {
        "login": "ayushdg",
        "id": 19949207,
        "node_id": "MDQ6VXNlcjE5OTQ5MjA3",
        "avatar_url": "https://avatars.githubusercontent.com/u/19949207?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ayushdg",
        "html_url": "https://github.com/ayushdg",
        "followers_url": "https://api.github.com/users/ayushdg/followers",
        "following_url": "https://api.github.com/users/ayushdg/following{/other_user}",
        "gists_url": "https://api.github.com/users/ayushdg/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ayushdg/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ayushdg/subscriptions",
        "organizations_url": "https://api.github.com/users/ayushdg/orgs",
        "repos_url": "https://api.github.com/users/ayushdg/repos",
        "events_url": "https://api.github.com/users/ayushdg/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ayushdg/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 599626559,
            "node_id": "MDU6TGFiZWw1OTk2MjY1NTk=",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        },
        {
            "id": 599626561,
            "node_id": "MDU6TGFiZWw1OTk2MjY1NjE=",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/feature%20request",
            "name": "feature request",
            "color": "a2eeef",
            "default": false,
            "description": "New feature or request"
        },
        {
            "id": 1013987352,
            "node_id": "MDU6TGFiZWwxMDEzOTg3MzUy",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/0%20-%20Backlog",
            "name": "0 - Backlog",
            "color": "d4c5f9",
            "default": false,
            "description": "In queue waiting for assignment"
        },
        {
            "id": 1139740666,
            "node_id": "MDU6TGFiZWwxMTM5NzQwNjY2",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/libcudf",
            "name": "libcudf",
            "color": "c5def5",
            "default": false,
            "description": "Affects libcudf (C++/CUDA) code."
        },
        {
            "id": 1139741213,
            "node_id": "MDU6TGFiZWwxMTM5NzQxMjEz",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/Python",
            "name": "Python",
            "color": "1d76db",
            "default": false,
            "description": "Affects Python cuDF API."
        },
        {
            "id": 1185244142,
            "node_id": "MDU6TGFiZWwxMTg1MjQ0MTQy",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/cuIO",
            "name": "cuIO",
            "color": "fef2c0",
            "default": false,
            "description": "cuIO issue"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/rapidsai/cudf/milestones/23",
        "html_url": "https://github.com/rapidsai/cudf/milestone/23",
        "labels_url": "https://api.github.com/repos/rapidsai/cudf/milestones/23/labels",
        "id": 8672406,
        "node_id": "MI_kwDOBWUGps4AhFSW",
        "number": 23,
        "title": "ORC continuous improvement",
        "description": "",
        "creator": {
            "login": "GregoryKimball",
            "id": 12725111,
            "node_id": "MDQ6VXNlcjEyNzI1MTEx",
            "avatar_url": "https://avatars.githubusercontent.com/u/12725111?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GregoryKimball",
            "html_url": "https://github.com/GregoryKimball",
            "followers_url": "https://api.github.com/users/GregoryKimball/followers",
            "following_url": "https://api.github.com/users/GregoryKimball/following{/other_user}",
            "gists_url": "https://api.github.com/users/GregoryKimball/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GregoryKimball/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GregoryKimball/subscriptions",
            "organizations_url": "https://api.github.com/users/GregoryKimball/orgs",
            "repos_url": "https://api.github.com/users/GregoryKimball/repos",
            "events_url": "https://api.github.com/users/GregoryKimball/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GregoryKimball/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 16,
        "closed_issues": 21,
        "state": "open",
        "created_at": "2022-11-19T18:16:16Z",
        "updated_at": "2024-05-17T15:24:31Z",
        "due_on": null,
        "closed_at": null
    },
    "comments": 2,
    "created_at": "2023-01-10T13:15:09Z",
    "updated_at": "2023-06-06T03:41:51Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "**Describe the bug**\r\nWhen using `cudf.read_parquet` or `read_orc` with the filters argument to filter out rows based on certain predicates, the methods today just filter out reading row groups (or stripes) that can be completely eliminated based on the given condition, but does return all rows from the read row groups without applying the given filters again. This behavior can be confusing to users assuming that all the relevant data has already been filtered out and is contrary to how dask, dask-cuDF and PyArrow behave today.\r\n\r\nExample:\r\n\r\nData:\r\n```\r\nCol Name: A\r\nRow Group 0: 1,5,1\r\nRow Group 1: 5,5,5\r\n```\r\n```python\r\ncudf.read_parquet(\"data\", filters=[('a','!=',5)])\r\n```\r\nWould return 1 , 5, 1 which is all elements from RG0 (RG1 gets filtered out).\r\nExpected output would be 1,1\r\n\r\n\r\n**Steps/Code to reproduce bug**\r\n```python\r\ndf = cudf.DataFrame()\r\n\r\nIn [6]: df[\"a\"] = [1,5]*2500 + [5]*5000\r\n\r\nIn [7]: df.to_parquet(\"rg_test.parquet\", row_group_size_rows=5000)\r\n\r\nIn [8]: cudf.read_parquet(\"rg_test.parquet\")\r\n[10000 rows x 1 columns]\r\n\r\nIn [9]: cudf.read_parquet(\"rg_test.parquet\", filters=[(\"a\", \"!=\", 5)])\r\n[5000 rows x 1 columns]\r\n```\r\n\r\n**Expected behavior**\r\nThe 5's from row group 0 also get filtered returning only 1's, which is inline with how pyarrow, dask/dask-cudf return return the result.\r\n\r\n**Environment overview (please complete the following information)**\r\n - Environment location: bare-metal\r\n - Method of cuDF install: conda\r\n   - If method of install is [Docker], provide `docker pull` & `docker run` commands used\r\n\r\n**Environment details**\r\nPlease run and paste the output of the `cudf/print_env.sh` script here, to gather any other relevant environment details\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/12512/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/rapidsai/cudf/issues/12512/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
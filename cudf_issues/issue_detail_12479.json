{
    "url": "https://api.github.com/repos/rapidsai/cudf/issues/12479",
    "repository_url": "https://api.github.com/repos/rapidsai/cudf",
    "labels_url": "https://api.github.com/repos/rapidsai/cudf/issues/12479/labels{/name}",
    "comments_url": "https://api.github.com/repos/rapidsai/cudf/issues/12479/comments",
    "events_url": "https://api.github.com/repos/rapidsai/cudf/issues/12479/events",
    "html_url": "https://github.com/rapidsai/cudf/issues/12479",
    "id": 1520288992,
    "node_id": "I_kwDOBWUGps5ancTg",
    "number": 12479,
    "title": "[BUG] libcudf::read_parquet performance worse than arrow::file_reader",
    "user": {
        "login": "JacoCheung",
        "id": 32166257,
        "node_id": "MDQ6VXNlcjMyMTY2MjU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/32166257?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JacoCheung",
        "html_url": "https://github.com/JacoCheung",
        "followers_url": "https://api.github.com/users/JacoCheung/followers",
        "following_url": "https://api.github.com/users/JacoCheung/following{/other_user}",
        "gists_url": "https://api.github.com/users/JacoCheung/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/JacoCheung/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/JacoCheung/subscriptions",
        "organizations_url": "https://api.github.com/users/JacoCheung/orgs",
        "repos_url": "https://api.github.com/users/JacoCheung/repos",
        "events_url": "https://api.github.com/users/JacoCheung/events{/privacy}",
        "received_events_url": "https://api.github.com/users/JacoCheung/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 599626559,
            "node_id": "MDU6TGFiZWw1OTk2MjY1NTk=",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        },
        {
            "id": 1013987352,
            "node_id": "MDU6TGFiZWwxMDEzOTg3MzUy",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/0%20-%20Backlog",
            "name": "0 - Backlog",
            "color": "d4c5f9",
            "default": false,
            "description": "In queue waiting for assignment"
        },
        {
            "id": 1139740666,
            "node_id": "MDU6TGFiZWwxMTM5NzQwNjY2",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/libcudf",
            "name": "libcudf",
            "color": "c5def5",
            "default": false,
            "description": "Affects libcudf (C++/CUDA) code."
        },
        {
            "id": 1185244142,
            "node_id": "MDU6TGFiZWwxMTg1MjQ0MTQy",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/cuIO",
            "name": "cuIO",
            "color": "fef2c0",
            "default": false,
            "description": "cuIO issue"
        },
        {
            "id": 1322252617,
            "node_id": "MDU6TGFiZWwxMzIyMjUyNjE3",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/Performance",
            "name": "Performance",
            "color": "C2E0C6",
            "default": false,
            "description": "Performance related issue"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/rapidsai/cudf/milestones/22",
        "html_url": "https://github.com/rapidsai/cudf/milestone/22",
        "labels_url": "https://api.github.com/repos/rapidsai/cudf/milestones/22/labels",
        "id": 8672393,
        "node_id": "MI_kwDOBWUGps4AhFSJ",
        "number": 22,
        "title": "Parquet continuous improvement",
        "description": "",
        "creator": {
            "login": "GregoryKimball",
            "id": 12725111,
            "node_id": "MDQ6VXNlcjEyNzI1MTEx",
            "avatar_url": "https://avatars.githubusercontent.com/u/12725111?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GregoryKimball",
            "html_url": "https://github.com/GregoryKimball",
            "followers_url": "https://api.github.com/users/GregoryKimball/followers",
            "following_url": "https://api.github.com/users/GregoryKimball/following{/other_user}",
            "gists_url": "https://api.github.com/users/GregoryKimball/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GregoryKimball/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GregoryKimball/subscriptions",
            "organizations_url": "https://api.github.com/users/GregoryKimball/orgs",
            "repos_url": "https://api.github.com/users/GregoryKimball/repos",
            "events_url": "https://api.github.com/users/GregoryKimball/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GregoryKimball/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 38,
        "closed_issues": 37,
        "state": "open",
        "created_at": "2022-11-19T18:08:31Z",
        "updated_at": "2024-06-06T18:40:39Z",
        "due_on": null,
        "closed_at": null
    },
    "comments": 1,
    "created_at": "2023-01-05T08:10:28Z",
    "updated_at": "2024-02-16T23:28:59Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "**Describe the bug**\r\nHi teams. I'm from HugeCTR team. I know that`libcudf::read_parquet()` is gpu-accelerated and I'm using it to load data for my application. Recently, I found out `arrow` also has implemented a file_reader which is a cpu reader. I have some performance results for both readers, and the cudf performance seems not promising. I have tested on 3 datasets, and the row_group distributition is illustrated in the left table. For arrow reader, I was parallelizing the reading of each columnchunk. The result demonstrated that for all three files, the arrow was much faster than cudf, 6x for criteo  in particular. The criteo is a prevalent dataset used in recommendation system.\r\n\r\n![image](https://user-images.githubusercontent.com/32166257/210726184-b360cdcb-bd2d-48a8-998f-6da32fd9cb20.png)\r\n\r\nFor both readers, I used c++ api to read data. \r\n\r\n**Steps/Code to reproduce bug**\r\n\r\nSince I was using the C++ api, so one has to compile following two code snippets manually,\r\nThe files linked to are actually cpp source files (Sorry for the file suffix). The compiling command is prepended in the source files. \r\n[read_arrow.txt](https://github.com/rapidsai/cudf/files/10350353/read_arrow.txt)\r\n[read_cudf.txt](https://github.com/rapidsai/cudf/files/10350354/read_cudf.txt)\r\n\r\nAfter compilation, running the executables:\r\n- Running arrow reader: `./arrow_parquet <filepath> false`\r\n- Running cudf reader: `./cudf_parquet <filepath>`\r\n\r\n**Expected behavior**\r\nMore performant data reading.\r\n\r\n**Environment overview**\r\nI was using Selene cluster (DGX-A100). Docker image [dockerfile](https://github.com/NVIDIA-Merlin/Merlin/blob/v22.12.00/docker/dockerfile.merlin)\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/12479/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/rapidsai/cudf/issues/12479/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
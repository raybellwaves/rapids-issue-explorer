{
    "url": "https://api.github.com/repos/rapidsai/cudf/issues/13087",
    "repository_url": "https://api.github.com/repos/rapidsai/cudf",
    "labels_url": "https://api.github.com/repos/rapidsai/cudf/issues/13087/labels{/name}",
    "comments_url": "https://api.github.com/repos/rapidsai/cudf/issues/13087/comments",
    "events_url": "https://api.github.com/repos/rapidsai/cudf/issues/13087/events",
    "html_url": "https://github.com/rapidsai/cudf/issues/13087",
    "id": 1659014047,
    "node_id": "I_kwDOBWUGps5i4ouf",
    "number": 13087,
    "title": "[FEA] Async mode for cudf.series operations",
    "user": {
        "login": "lmeyerov",
        "id": 4249447,
        "node_id": "MDQ6VXNlcjQyNDk0NDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4249447?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lmeyerov",
        "html_url": "https://github.com/lmeyerov",
        "followers_url": "https://api.github.com/users/lmeyerov/followers",
        "following_url": "https://api.github.com/users/lmeyerov/following{/other_user}",
        "gists_url": "https://api.github.com/users/lmeyerov/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/lmeyerov/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lmeyerov/subscriptions",
        "organizations_url": "https://api.github.com/users/lmeyerov/orgs",
        "repos_url": "https://api.github.com/users/lmeyerov/repos",
        "events_url": "https://api.github.com/users/lmeyerov/events{/privacy}",
        "received_events_url": "https://api.github.com/users/lmeyerov/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 599626561,
            "node_id": "MDU6TGFiZWw1OTk2MjY1NjE=",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/feature%20request",
            "name": "feature request",
            "color": "a2eeef",
            "default": false,
            "description": "New feature or request"
        },
        {
            "id": 1013987352,
            "node_id": "MDU6TGFiZWwxMDEzOTg3MzUy",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/0%20-%20Backlog",
            "name": "0 - Backlog",
            "color": "d4c5f9",
            "default": false,
            "description": "In queue waiting for assignment"
        },
        {
            "id": 1139740666,
            "node_id": "MDU6TGFiZWwxMTM5NzQwNjY2",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/libcudf",
            "name": "libcudf",
            "color": "c5def5",
            "default": false,
            "description": "Affects libcudf (C++/CUDA) code."
        },
        {
            "id": 1139741213,
            "node_id": "MDU6TGFiZWwxMTM5NzQxMjEz",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/Python",
            "name": "Python",
            "color": "1d76db",
            "default": false,
            "description": "Affects Python cuDF API."
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/rapidsai/cudf/milestones/19",
        "html_url": "https://github.com/rapidsai/cudf/milestone/19",
        "labels_url": "https://api.github.com/repos/rapidsai/cudf/milestones/19/labels",
        "id": 8550966,
        "node_id": "MI_kwDOBWUGps4Agno2",
        "number": 19,
        "title": "Enable streams",
        "description": "Enable safe usage of a stream-ordered libcudf API",
        "creator": {
            "login": "vyasr",
            "id": 1538165,
            "node_id": "MDQ6VXNlcjE1MzgxNjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1538165?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vyasr",
            "html_url": "https://github.com/vyasr",
            "followers_url": "https://api.github.com/users/vyasr/followers",
            "following_url": "https://api.github.com/users/vyasr/following{/other_user}",
            "gists_url": "https://api.github.com/users/vyasr/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/vyasr/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/vyasr/subscriptions",
            "organizations_url": "https://api.github.com/users/vyasr/orgs",
            "repos_url": "https://api.github.com/users/vyasr/repos",
            "events_url": "https://api.github.com/users/vyasr/events{/privacy}",
            "received_events_url": "https://api.github.com/users/vyasr/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 7,
        "closed_issues": 35,
        "state": "open",
        "created_at": "2022-10-17T21:56:16Z",
        "updated_at": "2024-05-17T13:49:40Z",
        "due_on": null,
        "closed_at": null
    },
    "comments": 3,
    "created_at": "2023-04-07T17:09:44Z",
    "updated_at": "2023-06-06T21:59:22Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "**Is your feature request related to a problem? Please describe.**\r\n\r\nWe get wide dataframes in situations like machine learning (easily 1-5K cols) and genomics (10K+ cols), and while there is some speedup from cudf (say 2-3X), it'd be easy to get to the 10X+ level with much higher GPU utilization if we could spawn concurrent tasks for each column . Getting this all the way to the df level seems tricky, but async primitives at the column level would get us far. \r\n\r\nOne Python-native idea is doing via `async/await`, when one cudf operation is getting scheduled, allocated, & run, we can be scheduling the next, and ideally, cudf can run them independently . It smoothed out 2-3 years ago in python + javascript as a popular native choice, and has since been  a lot more popular in pydata, e.g., langchain just rewrote to support async versions of all methods. Ex: https://trends.google.com/trends/explore?date=all&q=async%20await&hl=en . Separately, there's heightened value for pydata dashboarding scenarios like plotly, streamlit, etc as these ecosystem increasingly build for async io underneath as well.\r\n\r\n(Another idea with precedent is a lazy mode similar to haskell or dask, discussed below as well)\r\n\r\n**Describe the solution you'd like**\r\n\r\nI'd like to be do something like:\r\n\r\n```python\r\n\r\nasync def f(s: cudf.Series) -> cudf.Series:\r\n    # async mode for core series operations lets other f() calls proceed while this runs\r\n    s2 = await  s.stra.hex_to_int('AABBCC')\r\n   \r\n    # math can be clean and enable the same\r\n    # if we're super clever, this may even unlock query plan optimizations like fusion in the future\r\n    async with cudf.async.binop_mode:\r\n        s3_a = s2 + 1 / 3\r\n        s3 = await s3_a\r\n\r\n   return s3\r\n  \r\ncols2 = await async.gather([  f(df[col]) for col in df ])\r\n```\r\n\r\n**Describe alternatives you've considered**\r\n\r\n1. Use existing abstractions\r\n\r\nIn theory we can setup threads or multiple dask workers, but (1) both are super awkward, (2) underneath, cudf will not do concurrent jobs\r\n\r\n2. Lazy cudf\r\n\r\nAnother thought is to create a lazy mode for cudf. This has precedent with Haskell, and in modern pydata land, more so with polars. Dask does this too, and we'd use it if that can work, but it's awkward -- I haven't used, but polars sounds to be more friendly in practice:\r\n\r\n```python\r\n\r\ndef f(s: cudf.Series) -> cudf.Series:\r\n    # explicitly lazy ops\r\n    s2 = s.str_lazy.hex_to_int('AABBCC')\r\n\r\n    # binops know they're lazy\r\n    s3 = s2 + 1 / 3\r\n\r\n    return s3\r\n\r\n# force with async friendliness  \r\ncols2 = await cudf_client.compute_async([  f(df[col]) for col in df ])\r\n```\r\n\r\nUnderneath, cudf can reinvent async/io, dask, or whatever\r\n\r\n\r\n**Additional context**\r\n\r\nSlack thread: https://rapids-goai.slack.com/archives/C5E06F4DC/p1680710488795869 \r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/13087/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/rapidsai/cudf/issues/13087/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
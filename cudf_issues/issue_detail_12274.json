{
    "url": "https://api.github.com/repos/rapidsai/cudf/issues/12274",
    "repository_url": "https://api.github.com/repos/rapidsai/cudf",
    "labels_url": "https://api.github.com/repos/rapidsai/cudf/issues/12274/labels{/name}",
    "comments_url": "https://api.github.com/repos/rapidsai/cudf/issues/12274/comments",
    "events_url": "https://api.github.com/repos/rapidsai/cudf/issues/12274/events",
    "html_url": "https://github.com/rapidsai/cudf/issues/12274",
    "id": 1470253584,
    "node_id": "I_kwDOBWUGps5XokoQ",
    "number": 12274,
    "title": "[BUG] fillna with dataframe containing list dtypes fails ",
    "user": {
        "login": "VibhuJawa",
        "id": 4837571,
        "node_id": "MDQ6VXNlcjQ4Mzc1NzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4837571?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/VibhuJawa",
        "html_url": "https://github.com/VibhuJawa",
        "followers_url": "https://api.github.com/users/VibhuJawa/followers",
        "following_url": "https://api.github.com/users/VibhuJawa/following{/other_user}",
        "gists_url": "https://api.github.com/users/VibhuJawa/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/VibhuJawa/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/VibhuJawa/subscriptions",
        "organizations_url": "https://api.github.com/users/VibhuJawa/orgs",
        "repos_url": "https://api.github.com/users/VibhuJawa/repos",
        "events_url": "https://api.github.com/users/VibhuJawa/events{/privacy}",
        "received_events_url": "https://api.github.com/users/VibhuJawa/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 599626559,
            "node_id": "MDU6TGFiZWw1OTk2MjY1NTk=",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        },
        {
            "id": 1013987352,
            "node_id": "MDU6TGFiZWwxMDEzOTg3MzUy",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/0%20-%20Backlog",
            "name": "0 - Backlog",
            "color": "d4c5f9",
            "default": false,
            "description": "In queue waiting for assignment"
        },
        {
            "id": 1139741213,
            "node_id": "MDU6TGFiZWwxMTM5NzQxMjEz",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/Python",
            "name": "Python",
            "color": "1d76db",
            "default": false,
            "description": "Affects Python cuDF API."
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/rapidsai/cudf/milestones/2",
        "html_url": "https://github.com/rapidsai/cudf/milestone/2",
        "labels_url": "https://api.github.com/repos/rapidsai/cudf/milestones/2/labels",
        "id": 6946310,
        "node_id": "MDk6TWlsZXN0b25lNjk0NjMxMA==",
        "number": 2,
        "title": "List and Struct data types and operations",
        "description": "",
        "creator": {
            "login": "beckernick",
            "id": 8457388,
            "node_id": "MDQ6VXNlcjg0NTczODg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8457388?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/beckernick",
            "html_url": "https://github.com/beckernick",
            "followers_url": "https://api.github.com/users/beckernick/followers",
            "following_url": "https://api.github.com/users/beckernick/following{/other_user}",
            "gists_url": "https://api.github.com/users/beckernick/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/beckernick/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/beckernick/subscriptions",
            "organizations_url": "https://api.github.com/users/beckernick/orgs",
            "repos_url": "https://api.github.com/users/beckernick/repos",
            "events_url": "https://api.github.com/users/beckernick/events{/privacy}",
            "received_events_url": "https://api.github.com/users/beckernick/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 19,
        "closed_issues": 49,
        "state": "open",
        "created_at": "2021-07-14T18:07:53Z",
        "updated_at": "2024-05-15T19:11:54Z",
        "due_on": null,
        "closed_at": null
    },
    "comments": 2,
    "created_at": "2022-11-30T21:44:12Z",
    "updated_at": "2023-03-23T02:05:45Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "**Describe the bug**\r\n\r\nfillna with dataframe containing list dtypes fails . \r\n\r\n**Steps/Code to reproduce bug**\r\n```python3\r\nimport cudf\r\ns1 = cudf.Series(['game', 'game', None,None,None])\r\ns2 = cudf.Series([[1], [1], None,None,None])\r\ndf = cudf.DataFrame({'_TYPE_':s1, 'h':s2})\r\n\r\nc1 = cudf.Series([None,None, 'user', 'user', 'user'])\r\nc2 = cudf.Series([None, None, [2], [2], [2]])\r\nsubdf = cudf.DataFrame({'_TYPE_':c1, 'h':c2})\r\ndf.fillna(subdf)\r\n```\r\n\r\n```python3\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\nCell In [23], line 9\r\n      7 c2 = cudf.Series([None, None, [2], [2], [2]])\r\n      8 subdf = cudf.DataFrame({'_TYPE_':c1, 'h':c2})\r\n----> 9 df.fillna(subdf)\r\n\r\nFile /datasets/vjawa/miniconda3/envs/cugraph_dgl_dev/lib/python3.9/contextlib.py:79, in ContextDecorator.__call__.<locals>.inner(*args, **kwds)\r\n     76 @wraps(func)\r\n     77 def inner(*args, **kwds):\r\n     78     with self._recreate_cm():\r\n---> 79         return func(*args, **kwds)\r\n\r\nFile /datasets/vjawa/miniconda3/envs/cugraph_dgl_dev/lib/python3.9/site-packages/cudf/core/indexed_frame.py:1842, in IndexedFrame.fillna(self, value, method, axis, inplace, limit)\r\n   1837 @_cudf_nvtx_annotate\r\n   1838 def fillna(\r\n   1839     self, value=None, method=None, axis=None, inplace=False, limit=None\r\n   1840 ):  # noqa: D102\r\n   1841     old_index = self._index\r\n-> 1842     ret = super().fillna(value, method, axis, inplace, limit)\r\n   1843     if inplace:\r\n   1844         self._index = old_index\r\n\r\nFile /datasets/vjawa/miniconda3/envs/cugraph_dgl_dev/lib/python3.9/contextlib.py:79, in ContextDecorator.__call__.<locals>.inner(*args, **kwds)\r\n     76 @wraps(func)\r\n     77 def inner(*args, **kwds):\r\n     78     with self._recreate_cm():\r\n---> 79         return func(*args, **kwds)\r\n\r\nFile /datasets/vjawa/miniconda3/envs/cugraph_dgl_dev/lib/python3.9/site-packages/cudf/core/frame.py:905, in Frame.fillna(self, value, method, axis, inplace, limit)\r\n    899 should_fill = (\r\n    900     col_name in value\r\n    901     and col.contains_na_entries\r\n    902     and not libcudf.scalar._is_null_host_scalar(replace_val)\r\n    903 ) or method is not None\r\n    904 if should_fill:\r\n--> 905     filled_data[col_name] = col.fillna(replace_val, method)\r\n    906 else:\r\n    907     filled_data[col_name] = col.copy(deep=True)\r\n\r\nFile /datasets/vjawa/miniconda3/envs/cugraph_dgl_dev/lib/python3.9/site-packages/cudf/core/column/column.py:609, in ColumnBase.fillna(self, value, method, dtype)\r\n    599 def fillna(\r\n    600     self: T,\r\n    601     value: Any = None,\r\n    602     method: str = None,\r\n    603     dtype: Dtype = None,\r\n    604 ) -> T:\r\n    605     \"\"\"Fill null values with ``value``.\r\n    606 \r\n    607     Returns a copy with null filled.\r\n    608     \"\"\"\r\n--> 609     return libcudf.replace.replace_nulls(\r\n    610         input_col=self, replacement=value, method=method, dtype=dtype\r\n    611     )\r\n\r\nFile replace.pyx:139, in cudf._lib.replace.replace_nulls()\r\n\r\nFile /datasets/vjawa/miniconda3/envs/cugraph_dgl_dev/lib/python3.9/site-packages/cudf/core/single_column_frame.py:95, in SingleColumnFrame.__bool__(self)\r\n     94 def __bool__(self):\r\n---> 95     raise TypeError(\r\n     96         f\"The truth value of a {type(self)} is ambiguous. Use \"\r\n     97         \"a.empty, a.bool(), a.item(), a.any() or a.all().\"\r\n     98     )\r\n\r\nTypeError: The truth value of a <class 'cudf.core.series.Series'> is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().\r\n```\r\n\r\n**Expected behavior**\r\n\r\nI expect this to work like it does for non list columns. \r\n\r\n```python3\r\nimport cudf\r\ns1 = cudf.Series(['game', 'game', None,None,None])\r\ns2 = cudf.Series([1, 1, None,None,None])\r\ndf = cudf.DataFrame({'_TYPE_':s1, 'h':s2})\r\n\r\nc1 = cudf.Series([None,None, 'user', 'user', 'user'])\r\nc2 = cudf.Series([None, None, 2, 2, 2])\r\nsubdf = cudf.DataFrame({'_TYPE_':c1, 'h':c2})\r\ndf.fillna(subdf)\r\n```\r\n```python3\r\n\t_TYPE_\th\r\n0\tgame\t1\r\n1\tgame\t1\r\n2\tuser\t2\r\n3\tuser\t2\r\n4\tuser\t2\r\n```\r\n\r\n**Environment overview (please complete the following information)**\r\n - Method of cuDF install: [conda]\r\ncudf                      22.12.00a221128 cuda_11_py39_g0c60819cf3_305    rapidsai-nightly\r\n\r\n\r\n**Additional context**\r\n\r\nImpacts property graph in cugraph where we use it for replacing fillna \r\n\r\nhttps://github.com/rapidsai/cugraph/blob/cb0d0923616f656ec816f999aa633ecbf3c57267/python/cugraph/cugraph/structure/property_graph.py#L758\r\n\r\nhttps://github.com/rapidsai/cugraph/blob/cb0d0923616f656ec816f999aa633ecbf3c57267/python/cugraph/cugraph/structure/property_graph.py#L1155",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/12274/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/rapidsai/cudf/issues/12274/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
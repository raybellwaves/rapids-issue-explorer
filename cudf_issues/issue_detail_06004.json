{
    "url": "https://api.github.com/repos/rapidsai/cudf/issues/6004",
    "repository_url": "https://api.github.com/repos/rapidsai/cudf",
    "labels_url": "https://api.github.com/repos/rapidsai/cudf/issues/6004/labels{/name}",
    "comments_url": "https://api.github.com/repos/rapidsai/cudf/issues/6004/comments",
    "events_url": "https://api.github.com/repos/rapidsai/cudf/issues/6004/events",
    "html_url": "https://github.com/rapidsai/cudf/issues/6004",
    "id": 680463733,
    "node_id": "MDU6SXNzdWU2ODA0NjM3MzM=",
    "number": 6004,
    "title": "[FEA] Profiling duplicate reading of metadata",
    "user": {
        "login": "calebwin",
        "id": 20741909,
        "node_id": "MDQ6VXNlcjIwNzQxOTA5",
        "avatar_url": "https://avatars.githubusercontent.com/u/20741909?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/calebwin",
        "html_url": "https://github.com/calebwin",
        "followers_url": "https://api.github.com/users/calebwin/followers",
        "following_url": "https://api.github.com/users/calebwin/following{/other_user}",
        "gists_url": "https://api.github.com/users/calebwin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/calebwin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/calebwin/subscriptions",
        "organizations_url": "https://api.github.com/users/calebwin/orgs",
        "repos_url": "https://api.github.com/users/calebwin/repos",
        "events_url": "https://api.github.com/users/calebwin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/calebwin/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 599626561,
            "node_id": "MDU6TGFiZWw1OTk2MjY1NjE=",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/feature%20request",
            "name": "feature request",
            "color": "a2eeef",
            "default": false,
            "description": "New feature or request"
        },
        {
            "id": 1139740666,
            "node_id": "MDU6TGFiZWwxMTM5NzQwNjY2",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/libcudf",
            "name": "libcudf",
            "color": "c5def5",
            "default": false,
            "description": "Affects libcudf (C++/CUDA) code."
        },
        {
            "id": 1139741213,
            "node_id": "MDU6TGFiZWwxMTM5NzQxMjEz",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/Python",
            "name": "Python",
            "color": "1d76db",
            "default": false,
            "description": "Affects Python cuDF API."
        },
        {
            "id": 1185244142,
            "node_id": "MDU6TGFiZWwxMTg1MjQ0MTQy",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/cuIO",
            "name": "cuIO",
            "color": "fef2c0",
            "default": false,
            "description": "cuIO issue"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/rapidsai/cudf/milestones/22",
        "html_url": "https://github.com/rapidsai/cudf/milestone/22",
        "labels_url": "https://api.github.com/repos/rapidsai/cudf/milestones/22/labels",
        "id": 8672393,
        "node_id": "MI_kwDOBWUGps4AhFSJ",
        "number": 22,
        "title": "Parquet continuous improvement",
        "description": "",
        "creator": {
            "login": "GregoryKimball",
            "id": 12725111,
            "node_id": "MDQ6VXNlcjEyNzI1MTEx",
            "avatar_url": "https://avatars.githubusercontent.com/u/12725111?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GregoryKimball",
            "html_url": "https://github.com/GregoryKimball",
            "followers_url": "https://api.github.com/users/GregoryKimball/followers",
            "following_url": "https://api.github.com/users/GregoryKimball/following{/other_user}",
            "gists_url": "https://api.github.com/users/GregoryKimball/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GregoryKimball/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GregoryKimball/subscriptions",
            "organizations_url": "https://api.github.com/users/GregoryKimball/orgs",
            "repos_url": "https://api.github.com/users/GregoryKimball/repos",
            "events_url": "https://api.github.com/users/GregoryKimball/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GregoryKimball/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 38,
        "closed_issues": 37,
        "state": "open",
        "created_at": "2022-11-19T18:08:31Z",
        "updated_at": "2024-06-06T18:40:39Z",
        "due_on": null,
        "closed_at": null
    },
    "comments": 3,
    "created_at": "2020-08-17T19:09:26Z",
    "updated_at": "2024-02-17T10:31:15Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "The row-group-level filtered reading for Parquet that is introduced by #5843 creates an issue of duplicate metadata (metadata is stored in the footers of Parquet files) reading in the case when filters are specified. Arrow is used to read metadata and select a subset of data to read given user-provided filters [4] . Information about this subset is then passed to libcudf which reads in the subset [5]. The issue is that metadata gets read twice - first when Arrow reads metadata to do filtering and second when libcudf reads data.\r\n\r\nThis issue was initially raised here [1].\r\n\r\n# What to profile\r\n\r\n- [ ] Perf penalty of reading metadata using Arrow for filtering in the same vein as [2] but with datasets of varying # of files\r\n- [ ] Perf penalty of parsing metadata buffer [3] as fraction of total time Arrow spends reading metadata\r\n\r\n# What to determine\r\n\r\n- [ ] Determine whether or not perf penalty of the additional reading of metadata using Arrow is significant\r\n- [ ] Determine whether the duplicate reading should be resolved by passing metadata struct (steps to implement [6]) or metadata buffer (which is then parsed into metadata struct in libcudf) (steps to implement [7]) from Arrow `Dataset` to libcudf reader functions\r\n\r\n# Relevant discussion/code\r\n\r\n[1] https://github.com/rapidsai/cudf/pull/5843#discussion_r467191621\r\n[2] https://github.com/rapidsai/cudf/pull/5843#issuecomment-673566456\r\n[3] https://github.com/apache/arrow/blob/2e6009621011d7df43882aa883905b84d1647018/cpp/src/parquet/file_reader.cc#L532\r\n[4] https://github.com/rapidsai/cudf/pull/5843/files#diff-deac873508aaa12ca2e7c0a2c9035230R316\r\n[5] https://github.com/rapidsai/cudf/pull/5843/files#diff-deac873508aaa12ca2e7c0a2c9035230R359-R375\r\n[6] https://github.com/rapidsai/cudf/pull/5843#issuecomment-674437264\r\n[7] https://github.com/rapidsai/cudf/pull/5843#issuecomment-674437709",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/6004/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/rapidsai/cudf/issues/6004/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
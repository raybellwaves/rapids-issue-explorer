{
    "url": "https://api.github.com/repos/rapidsai/cudf/issues/15027",
    "repository_url": "https://api.github.com/repos/rapidsai/cudf",
    "labels_url": "https://api.github.com/repos/rapidsai/cudf/issues/15027/labels{/name}",
    "comments_url": "https://api.github.com/repos/rapidsai/cudf/issues/15027/comments",
    "events_url": "https://api.github.com/repos/rapidsai/cudf/issues/15027/events",
    "html_url": "https://github.com/rapidsai/cudf/issues/15027",
    "id": 2130621202,
    "node_id": "I_kwDOBWUGps5-_rMS",
    "number": 15027,
    "title": "[FEA] Support \"dataframe.query-planning\" config in ``dask.dataframe``",
    "user": {
        "login": "rjzamora",
        "id": 20461013,
        "node_id": "MDQ6VXNlcjIwNDYxMDEz",
        "avatar_url": "https://avatars.githubusercontent.com/u/20461013?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rjzamora",
        "html_url": "https://github.com/rjzamora",
        "followers_url": "https://api.github.com/users/rjzamora/followers",
        "following_url": "https://api.github.com/users/rjzamora/following{/other_user}",
        "gists_url": "https://api.github.com/users/rjzamora/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rjzamora/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rjzamora/subscriptions",
        "organizations_url": "https://api.github.com/users/rjzamora/orgs",
        "repos_url": "https://api.github.com/users/rjzamora/repos",
        "events_url": "https://api.github.com/users/rjzamora/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rjzamora/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 599626561,
            "node_id": "MDU6TGFiZWw1OTk2MjY1NjE=",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/feature%20request",
            "name": "feature request",
            "color": "a2eeef",
            "default": false,
            "description": "New feature or request"
        },
        {
            "id": 1185240898,
            "node_id": "MDU6TGFiZWwxMTg1MjQwODk4",
            "url": "https://api.github.com/repos/rapidsai/cudf/labels/dask",
            "name": "dask",
            "color": "fcc25d",
            "default": false,
            "description": "Dask issue"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": {
        "login": "rjzamora",
        "id": 20461013,
        "node_id": "MDQ6VXNlcjIwNDYxMDEz",
        "avatar_url": "https://avatars.githubusercontent.com/u/20461013?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rjzamora",
        "html_url": "https://github.com/rjzamora",
        "followers_url": "https://api.github.com/users/rjzamora/followers",
        "following_url": "https://api.github.com/users/rjzamora/following{/other_user}",
        "gists_url": "https://api.github.com/users/rjzamora/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rjzamora/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rjzamora/subscriptions",
        "organizations_url": "https://api.github.com/users/rjzamora/orgs",
        "repos_url": "https://api.github.com/users/rjzamora/repos",
        "events_url": "https://api.github.com/users/rjzamora/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rjzamora/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "rjzamora",
            "id": 20461013,
            "node_id": "MDQ6VXNlcjIwNDYxMDEz",
            "avatar_url": "https://avatars.githubusercontent.com/u/20461013?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rjzamora",
            "html_url": "https://github.com/rjzamora",
            "followers_url": "https://api.github.com/users/rjzamora/followers",
            "following_url": "https://api.github.com/users/rjzamora/following{/other_user}",
            "gists_url": "https://api.github.com/users/rjzamora/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/rjzamora/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/rjzamora/subscriptions",
            "organizations_url": "https://api.github.com/users/rjzamora/orgs",
            "repos_url": "https://api.github.com/users/rjzamora/repos",
            "events_url": "https://api.github.com/users/rjzamora/events{/privacy}",
            "received_events_url": "https://api.github.com/users/rjzamora/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2024-02-12T17:33:04Z",
    "updated_at": "2024-05-28T14:49:25Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "## PSA\r\n\r\nTo unblock CI failures related to the dask-expr migration, down-stream RAPIDS libraries can set the following environment variable in CI (before `dask.dataframe`/`dask_cudf` is ever imported):\r\n\r\n```\r\nexport DASK_DATAFRAME__QUERY_PLANNING=False\r\n```\r\n\r\n**If you do this, please be sure to comment on the change, and link it to this meta issue.** (So I can make the necessary changes/fixes, and turn query-planning back on)\r\n\r\n\r\n____\r\n\r\n## Background\r\n\r\nThe `2024.2.0` release of Dask has deprecated the \"legacy\" `dask.dataframe` API. Given that dask-cudf (and much of RAPIDS) is tightly integrated with `dask.dataframe`, it is critical that `dask_cudf` be updated to use the new `dask_expr` backend smoothly.\r\n\r\nMost of the heavy lifting is already being done in https://github.com/rapidsai/cudf/pull/14805. However, there will also be some follow-up work to expand coverage/examples/documentation/benchmarks. We will also need to update dask-cuda/explicit-comms.\r\n\r\n## Action Items\r\n\r\n**Basics** (to be covered by https://github.com/rapidsai/cudf/pull/14805):\r\n- [x] Add dask-expr `DataFrameBackendEntrypoint` entrypoint for \"cudf\"\r\n- [x] Align top-level `dask_cudf` imports with `dask.dataframe` for `\"dataframe.query-planning\"` support\r\n\r\n**Expected Follow-up**:\r\n- [x] Add `read_json` support (https://github.com/rapidsai/cudf/pull/15408)\r\n- [x] Add `read_orc` support (https://github.com/rapidsai/cudf/pull/15439)\r\n- [ ] `read_parquet` should always return DataFrame (not currently the case in dask-expr if `columns=<str>`)\r\n- [ ] Remove outdated `check_file_size` functionality from `dask_cudf.read_parquet`\r\n- [x] Add s3 testing/support (https://github.com/rapidsai/cudf/pull/15408)\r\n- [x] Add `read_text` support (https://github.com/rapidsai/cudf/pull/15439)\r\n- [x] Fix unexplained test failures for categorical accessors (https://github.com/rapidsai/cudf/pull/15591)\r\n- [x] Deprecate `to_dask_dataframe` API in favor of `to_backend` (https://github.com/rapidsai/cudf/pull/15592)\r\n- [x] Deprecate `set_index(..., divisions=\"quantile\")` (https://github.com/rapidsai/cudf/pull/15804)\r\n- [x] Add `describe` support (seems to be working now? Just need to remove `xfail` markers)\r\n- [x] Add `groupby` \"collect\" support (https://github.com/rapidsai/cudf/pull/15593)\r\n- [ ] (Maybe?) add `as_index` support to `groupby`\r\n- [x] Fix `get_dummy` support (https://github.com/dask/dask-expr/pull/1053)\r\n- [ ] Fix sorting by categorical columns (https://github.com/rapidsai/cudf/pull/15701; **Related Issues**: https://github.com/rapidsai/cudf/issues/15641 & https://github.com/dask/dask/issues/11090 & https://github.com/rapidsai/cudf/pull/15801)\r\n- [x] Fix sorting with nulls (https://github.com/rapidsai/cudf/pull/15639)\r\n- [ ] `leftanti` merge support (Likely an error message in 24.06 and support in 24.08+)\r\n- [x] `to_datetime` support (https://github.com/dask/dask-expr/pull/1035)\r\n- [x] Add `melt` support (https://github.com/dask/dask-expr/pull/1049 & https://github.com/dask/dask/pull/11088)\r\n\r\n**cuDF / Dask cuDF doc build**:\r\n- [x] Revert https://github.com/rapidsai/cudf/pull/15343 (see: https://github.com/rapidsai/cudf/pull/15347)\r\n\r\n**cuML support**:\r\n- [x] [General debugging PR](https://github.com/rapidsai/cuml/pull/5835)\r\n\r\n**cuxfilter support**:\r\n- [x] (https://github.com/rapidsai/cuxfilter/pull/583, https://github.com/rapidsai/cuxfilter/pull/593)\r\n\r\n**cugraph support**:\r\n- [x] [General debugging PR](https://github.com/rapidsai/cugraph/pull/4325)\r\n\r\n**Dask CUDA**:\r\n- [ ] Explicit comms support (https://github.com/rapidsai/dask-cuda/issues/1311)\r\n\r\n**Dask SQL**:\r\n- [ ] Migrate predicate pushdown to dask-expr\r\n\r\n**NeMo Curator**:\r\n- [ ] Migrate custom-graph code and test against latest dask/cudf\r\n\r\n**Merlin**:\r\n- [ ] Port Merlin/NVTabular (Heavy lift - Aiming for 24.08)\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/rapidsai/cudf/issues/15027/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/rapidsai/cudf/issues/15027/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
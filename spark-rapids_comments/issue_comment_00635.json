[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/684662579",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/635#issuecomment-684662579",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/635",
        "id": 684662579,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4NDY2MjU3OQ==",
        "user": {
            "login": "JustPlay",
            "id": 5866501,
            "node_id": "MDQ6VXNlcjU4NjY1MDE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5866501?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/JustPlay",
            "html_url": "https://github.com/JustPlay",
            "followers_url": "https://api.github.com/users/JustPlay/followers",
            "following_url": "https://api.github.com/users/JustPlay/following{/other_user}",
            "gists_url": "https://api.github.com/users/JustPlay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/JustPlay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/JustPlay/subscriptions",
            "organizations_url": "https://api.github.com/users/JustPlay/orgs",
            "repos_url": "https://api.github.com/users/JustPlay/repos",
            "events_url": "https://api.github.com/users/JustPlay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/JustPlay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-01T09:33:18Z",
        "updated_at": "2020-09-01T09:41:08Z",
        "author_association": "NONE",
        "body": "I had already started doing this work (just started, not much work yet), And I think it's better to listen to the experts from NV firstly",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/684662579/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/684939656",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/635#issuecomment-684939656",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/635",
        "id": 684939656,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4NDkzOTY1Ng==",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-01T15:29:32Z",
        "updated_at": "2020-09-01T15:29:32Z",
        "author_association": "COLLABORATOR",
        "body": "I do like the idea of allowing more tasks through based off of the amount of free memory available in the system, but I do have a few concerns with the approach.  \r\n\r\nThe first is fragmentation, which we are working hard to find solutions to.  Having 5GB free does not mean that all 5GB are usable by another task.  There has been discussion about exposing a metric from RMM, something like largest possible allocation, to give us some kind of an idea about how bad fragmentation is.  That way we could take that into account too.\r\n\r\nSecond is that we use a BufferManager currently as a part of the UCX shuffle work, and we plan on using it more in the future for general processing, so we can hold more data on the GPU, but only spill it when we have to. You would have to find a way to take this into account in deciding what can go on the GPU and what cannot, what is more because we try to fill up the GPU it can also interfere with our measure of fragmentation, so we might need some statistics from the BufferManager about what is spillable and how big those buffers are. \r\n\r\nMy final concern is that memory allocation is all or nothing in many cases and predicting how much operating memory is needed can be very hard.  For example there is a join in the plan.  In one case nothing matches and there is no output.  In another case everything matches badly and we get a combinitorial explosion.  If there is not enough memory free for the later case the task fails.  If we are constantly trying to push the GPU to the limits of what it can do we are going to hit these types of situations more and more.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/684939656/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/685549733",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/635#issuecomment-685549733",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/635",
        "id": 685549733,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4NTU0OTczMw==",
        "user": {
            "login": "JustPlay",
            "id": 5866501,
            "node_id": "MDQ6VXNlcjU4NjY1MDE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5866501?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/JustPlay",
            "html_url": "https://github.com/JustPlay",
            "followers_url": "https://api.github.com/users/JustPlay/followers",
            "following_url": "https://api.github.com/users/JustPlay/following{/other_user}",
            "gists_url": "https://api.github.com/users/JustPlay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/JustPlay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/JustPlay/subscriptions",
            "organizations_url": "https://api.github.com/users/JustPlay/orgs",
            "repos_url": "https://api.github.com/users/JustPlay/repos",
            "events_url": "https://api.github.com/users/JustPlay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/JustPlay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-02T10:08:59Z",
        "updated_at": "2020-09-02T10:08:59Z",
        "author_association": "NONE",
        "body": "https://github.com/rapidsai/rmm/issues/536",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/685549733/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/685773926",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/635#issuecomment-685773926",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/635",
        "id": 685773926,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4NTc3MzkyNg==",
        "user": {
            "login": "jlowe",
            "id": 1360766,
            "node_id": "MDQ6VXNlcjEzNjA3NjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1360766?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jlowe",
            "html_url": "https://github.com/jlowe",
            "followers_url": "https://api.github.com/users/jlowe/followers",
            "following_url": "https://api.github.com/users/jlowe/following{/other_user}",
            "gists_url": "https://api.github.com/users/jlowe/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jlowe/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jlowe/subscriptions",
            "organizations_url": "https://api.github.com/users/jlowe/orgs",
            "repos_url": "https://api.github.com/users/jlowe/repos",
            "events_url": "https://api.github.com/users/jlowe/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jlowe/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-02T14:28:31Z",
        "updated_at": "2020-09-02T14:28:31Z",
        "author_association": "MEMBER",
        "body": "@JustPlay that issue alone does not solve fragmentation problems.  It's designed to target the particularly bad fragmentation that can occur when using multiple streams, as without it each stream is essentially fragmenting the space from the perspective of other streams.\r\n\r\nWe have seen significant fragmentation in some cases with only a single stream (e.g.: cannot allocate 1.8GB when only 1.7GB of total GPU memory is allocated).  Resolving that issue will not address those scenarios.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/685773926/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/686275415",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/635#issuecomment-686275415",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/635",
        "id": 686275415,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjI3NTQxNQ==",
        "user": {
            "login": "harrism",
            "id": 783069,
            "node_id": "MDQ6VXNlcjc4MzA2OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/783069?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/harrism",
            "html_url": "https://github.com/harrism",
            "followers_url": "https://api.github.com/users/harrism/followers",
            "following_url": "https://api.github.com/users/harrism/following{/other_user}",
            "gists_url": "https://api.github.com/users/harrism/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/harrism/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/harrism/subscriptions",
            "organizations_url": "https://api.github.com/users/harrism/orgs",
            "repos_url": "https://api.github.com/users/harrism/repos",
            "events_url": "https://api.github.com/users/harrism/events{/privacy}",
            "received_events_url": "https://api.github.com/users/harrism/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-03T06:06:41Z",
        "updated_at": "2020-09-03T06:06:41Z",
        "author_association": "NONE",
        "body": "> There has been discussion about exposing a metric from RMM, something like largest possible allocation, to give us some kind of an idea about how bad fragmentation is. That way we could take that into account too.\r\n\r\nWhile I may add tracking of the largest available block to the pool memory resource, knowing the largest possible allocation requires syncing and merging all streams' free lists, which is not what you likely want to do until you fail to allocate.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/686275415/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/687169199",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/635#issuecomment-687169199",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/635",
        "id": 687169199,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4NzE2OTE5OQ==",
        "user": {
            "login": "JustPlay",
            "id": 5866501,
            "node_id": "MDQ6VXNlcjU4NjY1MDE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5866501?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/JustPlay",
            "html_url": "https://github.com/JustPlay",
            "followers_url": "https://api.github.com/users/JustPlay/followers",
            "following_url": "https://api.github.com/users/JustPlay/following{/other_user}",
            "gists_url": "https://api.github.com/users/JustPlay/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/JustPlay/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/JustPlay/subscriptions",
            "organizations_url": "https://api.github.com/users/JustPlay/orgs",
            "repos_url": "https://api.github.com/users/JustPlay/repos",
            "events_url": "https://api.github.com/users/JustPlay/events{/privacy}",
            "received_events_url": "https://api.github.com/users/JustPlay/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-04T14:09:51Z",
        "updated_at": "2020-09-04T14:09:51Z",
        "author_association": "NONE",
        "body": "> > There has been discussion about exposing a metric from RMM, something like largest possible allocation, to give us some kind of an idea about how bad fragmentation is. That way we could take that into account too.\r\n> \r\n> While I may add tracking of the largest available block to the pool memory resource, knowing the largest possible allocation requires syncing and merging all streams' free lists, which is not what you likely want to do until you fail to allocate.\r\n\r\nNo, i think you can ` tracking of the largest available block(s) to the pool memory resource` without doing stream sync (only give the user a info: there exists one or more block(s), but not guarantee usable immediately), let the sync to de done at the `actually allocating time`  (just let the task wait on the stream)\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/687169199/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/687176045",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/635#issuecomment-687176045",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/635",
        "id": 687176045,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4NzE3NjA0NQ==",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-04T14:21:26Z",
        "updated_at": "2020-09-04T14:21:26Z",
        "author_association": "COLLABORATOR",
        "body": "Also because the memory usage is changeing all the time this number will likely be out of date the instant it is reported.  I am a bit skeptical that a point in time measurement is going to give us what we want, but at least it would be a starting point.  We can iterate on rolling average memory usage and other things if we see some kind of improvement from the point in time metrics.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/687176045/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/687740032",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/635#issuecomment-687740032",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/635",
        "id": 687740032,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4Nzc0MDAzMg==",
        "user": {
            "login": "harrism",
            "id": 783069,
            "node_id": "MDQ6VXNlcjc4MzA2OQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/783069?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/harrism",
            "html_url": "https://github.com/harrism",
            "followers_url": "https://api.github.com/users/harrism/followers",
            "following_url": "https://api.github.com/users/harrism/following{/other_user}",
            "gists_url": "https://api.github.com/users/harrism/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/harrism/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/harrism/subscriptions",
            "organizations_url": "https://api.github.com/users/harrism/orgs",
            "repos_url": "https://api.github.com/users/harrism/repos",
            "events_url": "https://api.github.com/users/harrism/events{/privacy}",
            "received_events_url": "https://api.github.com/users/harrism/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-06T09:38:42Z",
        "updated_at": "2020-09-06T09:38:42Z",
        "author_association": "NONE",
        "body": "I don't think you got my point. The largest current free block is not the same as largest possible allocation. Knowing the latter requires merging all free lists to coalesce blocks from multiple streams.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/687740032/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1821016297",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9807#issuecomment-1821016297",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9807",
        "id": 1821016297,
        "node_id": "IC_kwDOD7z77c5sioDp",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-11-21T14:20:46Z",
        "updated_at": "2023-11-21T14:20:46Z",
        "author_association": "COLLABORATOR",
        "body": "I had this fail outside of cdh.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1821016297/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1821799311",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9807#issuecomment-1821799311",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9807",
        "id": 1821799311,
        "node_id": "IC_kwDOD7z77c5slnOP",
        "user": {
            "login": "sameerz",
            "id": 7036315,
            "node_id": "MDQ6VXNlcjcwMzYzMTU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7036315?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sameerz",
            "html_url": "https://github.com/sameerz",
            "followers_url": "https://api.github.com/users/sameerz/followers",
            "following_url": "https://api.github.com/users/sameerz/following{/other_user}",
            "gists_url": "https://api.github.com/users/sameerz/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sameerz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sameerz/subscriptions",
            "organizations_url": "https://api.github.com/users/sameerz/orgs",
            "repos_url": "https://api.github.com/users/sameerz/repos",
            "events_url": "https://api.github.com/users/sameerz/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sameerz/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-11-21T22:26:33Z",
        "updated_at": "2023-11-21T22:26:33Z",
        "author_association": "COLLABORATOR",
        "body": "Is this a case where the timezone is not set in the CDH test environment?  ",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1821799311/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1823143769",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9807#issuecomment-1823143769",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9807",
        "id": 1823143769,
        "node_id": "IC_kwDOD7z77c5sqvdZ",
        "user": {
            "login": "jlowe",
            "id": 1360766,
            "node_id": "MDQ6VXNlcjEzNjA3NjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1360766?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jlowe",
            "html_url": "https://github.com/jlowe",
            "followers_url": "https://api.github.com/users/jlowe/followers",
            "following_url": "https://api.github.com/users/jlowe/following{/other_user}",
            "gists_url": "https://api.github.com/users/jlowe/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jlowe/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jlowe/subscriptions",
            "organizations_url": "https://api.github.com/users/jlowe/orgs",
            "repos_url": "https://api.github.com/users/jlowe/repos",
            "events_url": "https://api.github.com/users/jlowe/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jlowe/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-11-22T16:55:06Z",
        "updated_at": "2023-11-22T16:55:06Z",
        "author_association": "MEMBER",
        "body": "The problem relates to an arguably invalid date being generated during the test.  During the failed run, the date `1582-10-13` is generated.  According to the Gregorian calendar, that date doesn't exist, because it falls in the 10 lost days during the transition from Julian to Gregorian. 1582-10-04 is followed by 1582-10-15.  When the CPU writes this to an ORC file, it marshals the date to 10-15 on both a CPU and GPU read:\r\n```\r\nscala> spark.conf.set(\"spark.rapids.sql.enabled\", \"false\")\r\n\r\nscala> Seq(\"1582-10-13\").toDF(\"s\").selectExpr(\"cast(s as date) as d\").repartition(1).write.orc(\"/tmp/orccpu\")\r\n\r\nscala> spark.read.orc(\"/tmp/orccpu\").show()\r\n+----------+\r\n|         d|\r\n+----------+\r\n|1582-10-15|\r\n+----------+\r\n\r\nscala> spark.conf.set(\"spark.rapids.sql.enabled\", \"true\")\r\n\r\nscala> spark.read.orc(\"/tmp/orccpu\").show()\r\n23/11/22 16:28:01 WARN GpuOverrides: \r\n!Exec <CollectLimitExec> cannot run on GPU because the Exec CollectLimitExec has been disabled, and is disabled by default because Collect Limit replacement can be slower on the GPU, if huge number of rows in a batch it could help by limiting the number of rows transferred from GPU to CPU. Set spark.rapids.sql.exec.CollectLimitExec to true if you wish to enable it\r\n  @Partitioning <SinglePartition$> could run on GPU\r\n\r\n+----------+\r\n|         d|\r\n+----------+\r\n|1582-10-15|\r\n+----------+\r\n```\r\n\r\nHowever when the GPU writes the date, it encodes it in such a way that the CPU and GPU readers differ on the value:\r\n```\r\nscala> spark.conf.set(\"spark.rapids.sql.enabled\", \"true\")\r\n\r\nscala> Seq(\"1582-10-13\").toDF(\"s\").selectExpr(\"cast(s as date) as d\").repartition(1).write.orc(\"/tmp/orcgpu\")\r\n23/11/22 16:26:39 WARN GpuOverrides: \r\n!Exec <ShuffleExchangeExec> cannot run on GPU because Columnar exchange without columnar children is inefficient\r\n  @Partitioning <SinglePartition$> could run on GPU\r\n  ! <LocalTableScanExec> cannot run on GPU because GPU does not currently support the operator class org.apache.spark.sql.execution.LocalTableScanExec\r\n    @Expression <AttributeReference> d#27 could run on GPU\r\n\r\nscala> spark.read.orc(\"/tmp/orcgpu\").show()\r\n23/11/22 16:28:08 WARN GpuOverrides: \r\n!Exec <CollectLimitExec> cannot run on GPU because the Exec CollectLimitExec has been disabled, and is disabled by default because Collect Limit replacement can be slower on the GPU, if huge number of rows in a batch it could help by limiting the number of rows transferred from GPU to CPU. Set spark.rapids.sql.exec.CollectLimitExec to true if you wish to enable it\r\n  @Partitioning <SinglePartition$> could run on GPU\r\n\r\n+----------+\r\n|         d|\r\n+----------+\r\n|1582-10-13|\r\n+----------+\r\n\r\nscala> spark.conf.set(\"spark.rapids.sql.enabled\", \"false\")\r\n\r\nscala> spark.read.orc(\"/tmp/orcgpu\").show()\r\n+----------+\r\n|         d|\r\n+----------+\r\n|1582-10-03|\r\n+----------+\r\n```\r\n\r\nI tried pandas and the ORC Java tools against the CPU and GPU generated ORC files.  All readers agree the CPU-written file has the date `1582-10-15`.  With the GPU-written file, Pandas and the libcudf reader see the date as `1582-10-13` whereas Spark CPU and the ORC Java tools read the date as `1582-10-03`.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1823143769/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1823149200",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9807#issuecomment-1823149200",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9807",
        "id": 1823149200,
        "node_id": "IC_kwDOD7z77c5sqwyQ",
        "user": {
            "login": "jlowe",
            "id": 1360766,
            "node_id": "MDQ6VXNlcjEzNjA3NjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1360766?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jlowe",
            "html_url": "https://github.com/jlowe",
            "followers_url": "https://api.github.com/users/jlowe/followers",
            "following_url": "https://api.github.com/users/jlowe/following{/other_user}",
            "gists_url": "https://api.github.com/users/jlowe/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jlowe/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jlowe/subscriptions",
            "organizations_url": "https://api.github.com/users/jlowe/orgs",
            "repos_url": "https://api.github.com/users/jlowe/repos",
            "events_url": "https://api.github.com/users/jlowe/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jlowe/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-11-22T16:58:45Z",
        "updated_at": "2023-11-22T16:58:45Z",
        "author_association": "MEMBER",
        "body": "Relates to #131 ",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1823149200/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1843779292",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9807#issuecomment-1843779292",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9807",
        "id": 1843779292,
        "node_id": "IC_kwDOD7z77c5t5dbc",
        "user": {
            "login": "jlowe",
            "id": 1360766,
            "node_id": "MDQ6VXNlcjEzNjA3NjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1360766?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jlowe",
            "html_url": "https://github.com/jlowe",
            "followers_url": "https://api.github.com/users/jlowe/followers",
            "following_url": "https://api.github.com/users/jlowe/following{/other_user}",
            "gists_url": "https://api.github.com/users/jlowe/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jlowe/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jlowe/subscriptions",
            "organizations_url": "https://api.github.com/users/jlowe/orgs",
            "repos_url": "https://api.github.com/users/jlowe/repos",
            "events_url": "https://api.github.com/users/jlowe/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jlowe/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-06T22:18:42Z",
        "updated_at": "2023-12-06T22:18:42Z",
        "author_association": "MEMBER",
        "body": "Updated the compatibility docs to describe the incompatibilities with the lost days associated with the switch to the Gregorian calendar.  Putting this back into the backlog since fixing is deemed low priority.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1843779292/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
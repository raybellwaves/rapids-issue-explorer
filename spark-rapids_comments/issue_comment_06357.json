[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1220451175",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6357#issuecomment-1220451175",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6357",
        "id": 1220451175,
        "node_id": "IC_kwDOD7z77c5Ivptn",
        "user": {
            "login": "sinkinben",
            "id": 31923950,
            "node_id": "MDQ6VXNlcjMxOTIzOTUw",
            "avatar_url": "https://avatars.githubusercontent.com/u/31923950?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sinkinben",
            "html_url": "https://github.com/sinkinben",
            "followers_url": "https://api.github.com/users/sinkinben/followers",
            "following_url": "https://api.github.com/users/sinkinben/following{/other_user}",
            "gists_url": "https://api.github.com/users/sinkinben/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sinkinben/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sinkinben/subscriptions",
            "organizations_url": "https://api.github.com/users/sinkinben/orgs",
            "repos_url": "https://api.github.com/users/sinkinben/repos",
            "events_url": "https://api.github.com/users/sinkinben/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sinkinben/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-19T09:20:55Z",
        "updated_at": "2022-08-22T06:02:10Z",
        "author_association": "CONTRIBUTOR",
        "body": "We need to pay attention the difference between Julian calendar and Gregorian calendar.\r\n\r\nIt seems that this is controlled by a config `orc.proleptic.gregorian` in CPU-spark.\r\n\r\nIn CPU spark, setting it to true/false, will bring different results, if the time is before `1582/10/04`.\r\n\r\n```shell\r\nscala> spark.conf.set(\"orc.proleptic.gregorian\", \"false\")\r\n\r\nscala> spark.read.schema(\"date timestamp\").orc(\"/tmp/orc/data.orc\").show(false)\r\n+-------------------+\r\n|date               |\r\n+-------------------+\r\n|1582-01-01 00:00:00|\r\n|1582-01-01 00:00:00|\r\n+-------------------+\r\n\r\n\r\nscala> spark.conf.set(\"orc.proleptic.gregorian\", \"true\")\r\n\r\nscala> spark.read.schema(\"date timestamp\").orc(\"/tmp/orc/data.orc\").show(false)\r\n+-------------------+\r\n|date               |\r\n+-------------------+\r\n|1581-12-22 00:00:00|\r\n|1581-12-22 00:00:00|\r\n+-------------------+\r\n\r\n```\r\n\r\nIn above example, the first result is actually what we want.\r\n\r\nThe solution of conversion between between Julian calendar and Gregorian calendar: https://github.com/sinkinben/spark/blob/master/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/RebaseDateTime.scala",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1220451175/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1254557371",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6357#issuecomment-1254557371",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6357",
        "id": 1254557371,
        "node_id": "IC_kwDOD7z77c5Kxwa7",
        "user": {
            "login": "GaryShen2008",
            "id": 22128535,
            "node_id": "MDQ6VXNlcjIyMTI4NTM1",
            "avatar_url": "https://avatars.githubusercontent.com/u/22128535?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GaryShen2008",
            "html_url": "https://github.com/GaryShen2008",
            "followers_url": "https://api.github.com/users/GaryShen2008/followers",
            "following_url": "https://api.github.com/users/GaryShen2008/following{/other_user}",
            "gists_url": "https://api.github.com/users/GaryShen2008/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GaryShen2008/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GaryShen2008/subscriptions",
            "organizations_url": "https://api.github.com/users/GaryShen2008/orgs",
            "repos_url": "https://api.github.com/users/GaryShen2008/repos",
            "events_url": "https://api.github.com/users/GaryShen2008/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GaryShen2008/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-22T05:48:08Z",
        "updated_at": "2022-09-22T05:48:08Z",
        "author_association": "COLLABORATOR",
        "body": "Move it from 22.10.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1254557371/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
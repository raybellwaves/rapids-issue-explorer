[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1865180567",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1865180567",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1865180567,
        "node_id": "IC_kwDOD7z77c5vLGWX",
        "user": {
            "login": "NVnavkumar",
            "id": 97137715,
            "node_id": "U_kgDOBco0Mw",
            "avatar_url": "https://avatars.githubusercontent.com/u/97137715?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/NVnavkumar",
            "html_url": "https://github.com/NVnavkumar",
            "followers_url": "https://api.github.com/users/NVnavkumar/followers",
            "following_url": "https://api.github.com/users/NVnavkumar/following{/other_user}",
            "gists_url": "https://api.github.com/users/NVnavkumar/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/NVnavkumar/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/NVnavkumar/subscriptions",
            "organizations_url": "https://api.github.com/users/NVnavkumar/orgs",
            "repos_url": "https://api.github.com/users/NVnavkumar/repos",
            "events_url": "https://api.github.com/users/NVnavkumar/events{/privacy}",
            "received_events_url": "https://api.github.com/users/NVnavkumar/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-20T21:40:42Z",
        "updated_at": "2023-12-20T21:40:42Z",
        "author_association": "COLLABORATOR",
        "body": "Confirmed reproduce via:\r\n\r\n```\r\nTZ=Iran ./run_pyspark_from_build.sh -k 'test_date_format_for_time or test_date_format_maybe_incompat'\r\n```\r\n\r\nSeed value doesn't seem to matter",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1865180567/reactions",
            "total_count": 1,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 1,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869015813",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1869015813",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1869015813,
        "node_id": "IC_kwDOD7z77c5vZusF",
        "user": {
            "login": "ttnghia",
            "id": 7416935,
            "node_id": "MDQ6VXNlcjc0MTY5MzU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7416935?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ttnghia",
            "html_url": "https://github.com/ttnghia",
            "followers_url": "https://api.github.com/users/ttnghia/followers",
            "following_url": "https://api.github.com/users/ttnghia/following{/other_user}",
            "gists_url": "https://api.github.com/users/ttnghia/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ttnghia/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ttnghia/subscriptions",
            "organizations_url": "https://api.github.com/users/ttnghia/orgs",
            "repos_url": "https://api.github.com/users/ttnghia/repos",
            "events_url": "https://api.github.com/users/ttnghia/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ttnghia/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-25T14:52:53Z",
        "updated_at": "2023-12-25T14:53:39Z",
        "author_association": "COLLABORATOR",
        "body": "It seems like an overflow for the values. The year values should be up to `9999`.\r\n```\r\n11:47:30  -Row(date_format(a, yyyy-MM-dd HH:mm:ss.SSSSSS)='+10000-01-01 03:29:59.999999')\r\n11:47:30  +Row(date_format(a, yyyy-MM-dd HH:mm:ss.SSSSSS)='0000-01-01 03:29:59.999999')\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869015813/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869221726",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1869221726",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1869221726,
        "node_id": "IC_kwDOD7z77c5vag9e",
        "user": {
            "login": "res-life",
            "id": 8166419,
            "node_id": "MDQ6VXNlcjgxNjY0MTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/res-life",
            "html_url": "https://github.com/res-life",
            "followers_url": "https://api.github.com/users/res-life/followers",
            "following_url": "https://api.github.com/users/res-life/following{/other_user}",
            "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
            "organizations_url": "https://api.github.com/users/res-life/orgs",
            "repos_url": "https://api.github.com/users/res-life/repos",
            "events_url": "https://api.github.com/users/res-life/events{/privacy}",
            "received_events_url": "https://api.github.com/users/res-life/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-26T03:15:59Z",
        "updated_at": "2023-12-26T03:31:09Z",
        "author_association": "COLLABORATOR",
        "body": "cuDF can not handle years that are bigger than 9999.\r\n\r\n```\r\n  test(\"test year 9999\") {\r\n    println(\"my debug: begin: \")\r\n    val maxSecond = Instant.parse(\"9999-12-31T23:59:59z\").getEpochSecond\r\n    // plus 8 hours\r\n    val cv = ColumnVector.timestampMicroSecondsFromBoxedLongs(\r\n      maxSecond * TimeUnit.SECONDS.toMicros(1) + TimeUnit.HOURS.toMicros(8))\r\n    val ret = cv.asStrings(\"%Y-%m-%d\")\r\n    val host = ret.copyToHost()\r\n    println(host.getJavaString(0))\r\n    println(\"my debug: end\")\r\n  }\r\n```\r\n\r\nOutput:\r\n```\r\nmy debug: begin: \r\n0000-01-01\r\nmy debug: end\r\n```\r\n\r\nI guess cuDF expect %Y prints 4 digits, so it truncates 10000 to 0000.\r\n\r\nSpark output is:\r\n```\r\n+10000-01-01\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869221726/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869222370",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1869222370",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1869222370,
        "node_id": "IC_kwDOD7z77c5vahHi",
        "user": {
            "login": "res-life",
            "id": 8166419,
            "node_id": "MDQ6VXNlcjgxNjY0MTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/res-life",
            "html_url": "https://github.com/res-life",
            "followers_url": "https://api.github.com/users/res-life/followers",
            "following_url": "https://api.github.com/users/res-life/following{/other_user}",
            "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
            "organizations_url": "https://api.github.com/users/res-life/orgs",
            "repos_url": "https://api.github.com/users/res-life/repos",
            "events_url": "https://api.github.com/users/res-life/events{/privacy}",
            "received_events_url": "https://api.github.com/users/res-life/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-26T03:17:56Z",
        "updated_at": "2023-12-26T03:25:35Z",
        "author_association": "COLLABORATOR",
        "body": "Depending on cuDF to handle years bigger than 9999:\r\n```\r\ncv.asStrings(\"%Y-%m-%d\")\r\n```\r\nThe long value in cv is: 253402329599000000L\r\n253402329599000000L = micros of 9999-12-31T23:59:59 + micors of 8 hours.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869222370/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869228104",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1869228104",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1869228104,
        "node_id": "IC_kwDOD7z77c5vaihI",
        "user": {
            "login": "ttnghia",
            "id": 7416935,
            "node_id": "MDQ6VXNlcjc0MTY5MzU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7416935?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ttnghia",
            "html_url": "https://github.com/ttnghia",
            "followers_url": "https://api.github.com/users/ttnghia/followers",
            "following_url": "https://api.github.com/users/ttnghia/following{/other_user}",
            "gists_url": "https://api.github.com/users/ttnghia/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ttnghia/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ttnghia/subscriptions",
            "organizations_url": "https://api.github.com/users/ttnghia/orgs",
            "repos_url": "https://api.github.com/users/ttnghia/repos",
            "events_url": "https://api.github.com/users/ttnghia/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ttnghia/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-26T03:36:09Z",
        "updated_at": "2023-12-26T03:36:09Z",
        "author_association": "COLLABORATOR",
        "body": "This is not trivially supported in cudf since it requires fixed width input strings for each field. For example, `%Y` requires 4 numbers like `0001`.\r\n\r\nRef: https://github.com/rapidsai/cudf/blob/branch-24.02/cpp/src/strings/convert/convert_datetime.cu#L114",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869228104/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869235291",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1869235291",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1869235291,
        "node_id": "IC_kwDOD7z77c5vakRb",
        "user": {
            "login": "res-life",
            "id": 8166419,
            "node_id": "MDQ6VXNlcjgxNjY0MTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/res-life",
            "html_url": "https://github.com/res-life",
            "followers_url": "https://api.github.com/users/res-life/followers",
            "following_url": "https://api.github.com/users/res-life/following{/other_user}",
            "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
            "organizations_url": "https://api.github.com/users/res-life/orgs",
            "repos_url": "https://api.github.com/users/res-life/repos",
            "events_url": "https://api.github.com/users/res-life/events{/privacy}",
            "received_events_url": "https://api.github.com/users/res-life/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-26T04:00:04Z",
        "updated_at": "2023-12-26T04:00:04Z",
        "author_association": "COLLABORATOR",
        "body": "Thanks @ttnghia \r\n\r\nRelated to the following issues:\r\nhttps://github.com/NVIDIA/spark-rapids-jni/issues/1655\r\nhttps://github.com/NVIDIA/spark-rapids/issues/10032\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869235291/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869291050",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1869291050",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1869291050,
        "node_id": "IC_kwDOD7z77c5vax4q",
        "user": {
            "login": "res-life",
            "id": 8166419,
            "node_id": "MDQ6VXNlcjgxNjY0MTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/res-life",
            "html_url": "https://github.com/res-life",
            "followers_url": "https://api.github.com/users/res-life/followers",
            "following_url": "https://api.github.com/users/res-life/following{/other_user}",
            "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
            "organizations_url": "https://api.github.com/users/res-life/orgs",
            "repos_url": "https://api.github.com/users/res-life/repos",
            "events_url": "https://api.github.com/users/res-life/events{/privacy}",
            "received_events_url": "https://api.github.com/users/res-life/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-26T06:20:10Z",
        "updated_at": "2023-12-26T06:20:10Z",
        "author_association": "COLLABORATOR",
        "body": "Java API returns `+10000-01-01`\r\n```\r\n    val p = DateTimeFormatter.ofPattern(\"yyyy-MM-dd\")\r\n    val s = p.format(Instant.ofEpochSecond(253402329599L).atZone(ZoneId.of(\"Asia/Shanghai\")).toLocalDate)\r\n    println(s)\r\n```\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869291050/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869865189",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1869865189",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1869865189,
        "node_id": "IC_kwDOD7z77c5vc-Dl",
        "user": {
            "login": "res-life",
            "id": 8166419,
            "node_id": "MDQ6VXNlcjgxNjY0MTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/res-life",
            "html_url": "https://github.com/res-life",
            "followers_url": "https://api.github.com/users/res-life/followers",
            "following_url": "https://api.github.com/users/res-life/following{/other_user}",
            "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
            "organizations_url": "https://api.github.com/users/res-life/orgs",
            "repos_url": "https://api.github.com/users/res-life/repos",
            "events_url": "https://api.github.com/users/res-life/events{/privacy}",
            "received_events_url": "https://api.github.com/users/res-life/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-27T01:36:47Z",
        "updated_at": "2023-12-27T09:22:32Z",
        "author_association": "COLLABORATOR",
        "body": "Temporarily fix: https://github.com/NVIDIA/spark-rapids/pull/10095\r\nFinal fix depends on: https://github.com/NVIDIA/spark-rapids/issues/10032\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1869865189/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1871454804",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1871454804",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1871454804,
        "node_id": "IC_kwDOD7z77c5vjCJU",
        "user": {
            "login": "NVnavkumar",
            "id": 97137715,
            "node_id": "U_kgDOBco0Mw",
            "avatar_url": "https://avatars.githubusercontent.com/u/97137715?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/NVnavkumar",
            "html_url": "https://github.com/NVnavkumar",
            "followers_url": "https://api.github.com/users/NVnavkumar/followers",
            "following_url": "https://api.github.com/users/NVnavkumar/following{/other_user}",
            "gists_url": "https://api.github.com/users/NVnavkumar/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/NVnavkumar/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/NVnavkumar/subscriptions",
            "organizations_url": "https://api.github.com/users/NVnavkumar/orgs",
            "repos_url": "https://api.github.com/users/NVnavkumar/repos",
            "events_url": "https://api.github.com/users/NVnavkumar/events{/privacy}",
            "received_events_url": "https://api.github.com/users/NVnavkumar/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-28T20:00:56Z",
        "updated_at": "2023-12-28T20:00:56Z",
        "author_association": "COLLABORATOR",
        "body": "@res-life I think `from_unixtime` (`GpuFromUnixTime`) will also have the same overflow issue for non-UTC timezones, since it also relies on `asStrings(strfFormat)` like `GpuDateFormatClass`",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1871454804/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1871789307",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083#issuecomment-1871789307",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
        "id": 1871789307,
        "node_id": "IC_kwDOD7z77c5vkTz7",
        "user": {
            "login": "res-life",
            "id": 8166419,
            "node_id": "MDQ6VXNlcjgxNjY0MTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/res-life",
            "html_url": "https://github.com/res-life",
            "followers_url": "https://api.github.com/users/res-life/followers",
            "following_url": "https://api.github.com/users/res-life/following{/other_user}",
            "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
            "organizations_url": "https://api.github.com/users/res-life/orgs",
            "repos_url": "https://api.github.com/users/res-life/repos",
            "events_url": "https://api.github.com/users/res-life/events{/privacy}",
            "received_events_url": "https://api.github.com/users/res-life/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-29T06:43:59Z",
        "updated_at": "2023-12-29T06:43:59Z",
        "author_association": "COLLABORATOR",
        "body": "Thanks @NVnavkumar \r\n```\r\n@pytest.mark.parametrize('data_gen', [LongGen(min_val=int(datetime(1, 2, 1).timestamp()), max_val=int(datetime(9999, 12, 30).timestamp()))], ids=idfn)\r\ntest_from_unixtime\r\n```\r\nCurrently `from_unixtime`  does not use full ragne, it will not fail.\r\n\r\nI added a sub-task in this issue to track this.\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1871789307/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1099210714",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/5221#issuecomment-1099210714",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/5221",
        "id": 1099210714,
        "node_id": "IC_kwDOD7z77c5BhJ_a",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-04-14T13:53:06Z",
        "updated_at": "2022-04-14T13:53:06Z",
        "author_association": "COLLABORATOR",
        "body": "I think CUDF already supports this through dropListDuplicates\r\n\r\nhttps://github.com/rapidsai/cudf/blob/ac27757092e9ba2bc0656b6a7dfbc79ce8b5e76a/java/src/main/java/ai/rapids/cudf/ColumnView.java#L2375-L2386\r\n\r\nWe should be able to implement this without any issues, so long at dropListDuplicates supports the types.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1099210714/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/2046320192",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/5221#issuecomment-2046320192",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/5221",
        "id": 2046320192,
        "node_id": "IC_kwDOD7z77c55-F5A",
        "user": {
            "login": "phish3y",
            "id": 44003290,
            "node_id": "MDQ6VXNlcjQ0MDAzMjkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/44003290?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phish3y",
            "html_url": "https://github.com/phish3y",
            "followers_url": "https://api.github.com/users/phish3y/followers",
            "following_url": "https://api.github.com/users/phish3y/following{/other_user}",
            "gists_url": "https://api.github.com/users/phish3y/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phish3y/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phish3y/subscriptions",
            "organizations_url": "https://api.github.com/users/phish3y/orgs",
            "repos_url": "https://api.github.com/users/phish3y/repos",
            "events_url": "https://api.github.com/users/phish3y/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phish3y/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-04-10T01:58:33Z",
        "updated_at": "2024-04-10T02:14:35Z",
        "author_association": "NONE",
        "body": "I am interested in taking this. Could anyone point me in the right direction for which file (`collectionOperations`?) this would live in and maybe a comparable Gpu* case class (`GpuArrayRemove`?)?\r\n\r\nEdit: Okay I see `ArrayDistinct` in the CPU version of `collectionOperations` so I think I'm on the right path",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/2046320192/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/2047784979",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/5221#issuecomment-2047784979",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/5221",
        "id": 2047784979,
        "node_id": "IC_kwDOD7z77c56DrgT",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-04-10T14:56:52Z",
        "updated_at": "2024-04-10T14:56:52Z",
        "author_association": "COLLABORATOR",
        "body": "@phish3y happy to have you start to work on this.\r\n\r\nhttps://github.com/apache/spark/blob/0d7c07047a628bd42eb53eb49935f5e3f81ea1a1/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/collectionOperations.scala#L4036\r\n\r\nis the CPU implementation that we want to try and target. It looks like they have special case equality for NaNs and Nulls, but I am not sure if it is going to work with -0.0 vs 0.0 properly. We probably need to do some explicit testing on different versions of Spark.\r\n\r\nThe other thing to be careful of is that it appears that Spark is purposely keeping the order of the values in the array the same and only removing duplicates that come later. I am not sure if we need to replicate this functionality or not. It would be ideal if we could, but I don't think this is critical because it started to happen after a bug fix. https://github.com/apache/spark/pull/33993\r\n\r\nAs for how you might be able to implement this I would suggest that you start with\r\n\r\nhttps://github.com/rapidsai/cudf/blob/e727814c00ce0ae13febfeb44ca3d2db66f7f2e9/cpp/include/cudf/lists/stream_compaction.hpp#L87\r\n\r\nusing the java API for it \r\nhttps://github.com/rapidsai/cudf/blob/e727814c00ce0ae13febfeb44ca3d2db66f7f2e9/java/src/main/java/ai/rapids/cudf/ColumnView.java#L2513\r\n\r\nThen we can see what data types work well out of the box and if we have to add in some special case processing to make it work.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/2047784979/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
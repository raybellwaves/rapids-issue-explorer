[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1668616315",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8926#issuecomment-1668616315",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8926",
        "id": 1668616315,
        "node_id": "IC_kwDOD7z77c5jdRB7",
        "user": {
            "login": "sameerz",
            "id": 7036315,
            "node_id": "MDQ6VXNlcjcwMzYzMTU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7036315?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sameerz",
            "html_url": "https://github.com/sameerz",
            "followers_url": "https://api.github.com/users/sameerz/followers",
            "following_url": "https://api.github.com/users/sameerz/following{/other_user}",
            "gists_url": "https://api.github.com/users/sameerz/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sameerz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sameerz/subscriptions",
            "organizations_url": "https://api.github.com/users/sameerz/orgs",
            "repos_url": "https://api.github.com/users/sameerz/repos",
            "events_url": "https://api.github.com/users/sameerz/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sameerz/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-07T21:44:56Z",
        "updated_at": "2023-08-07T21:44:56Z",
        "author_association": "COLLABORATOR",
        "body": "cudf sees the 2 x double quotes as a way to escape a single `\"`.  Spark sees 2 x double as an empty field.  \r\n\r\nPossibly related issue https://github.com/rapidsai/cudf/issues/12145",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1668616315/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1678574704",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8926#issuecomment-1678574704",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8926",
        "id": 1678574704,
        "node_id": "IC_kwDOD7z77c5kDQRw",
        "user": {
            "login": "vuule",
            "id": 16005690,
            "node_id": "MDQ6VXNlcjE2MDA1Njkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/16005690?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vuule",
            "html_url": "https://github.com/vuule",
            "followers_url": "https://api.github.com/users/vuule/followers",
            "following_url": "https://api.github.com/users/vuule/following{/other_user}",
            "gists_url": "https://api.github.com/users/vuule/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/vuule/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/vuule/subscriptions",
            "organizations_url": "https://api.github.com/users/vuule/orgs",
            "repos_url": "https://api.github.com/users/vuule/repos",
            "events_url": "https://api.github.com/users/vuule/events{/privacy}",
            "received_events_url": "https://api.github.com/users/vuule/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-15T08:16:48Z",
        "updated_at": "2023-08-15T08:16:48Z",
        "author_association": "NONE",
        "body": "@tgravescs can you please share the steps to repro the issue? I'm only seeing nulls returned for the fields containing only `\"\"`.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1678574704/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1679423979",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8926#issuecomment-1679423979",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8926",
        "id": 1679423979,
        "node_id": "IC_kwDOD7z77c5kGfnr",
        "user": {
            "login": "tgravescs",
            "id": 4563792,
            "node_id": "MDQ6VXNlcjQ1NjM3OTI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4563792?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tgravescs",
            "html_url": "https://github.com/tgravescs",
            "followers_url": "https://api.github.com/users/tgravescs/followers",
            "following_url": "https://api.github.com/users/tgravescs/following{/other_user}",
            "gists_url": "https://api.github.com/users/tgravescs/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tgravescs/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tgravescs/subscriptions",
            "organizations_url": "https://api.github.com/users/tgravescs/orgs",
            "repos_url": "https://api.github.com/users/tgravescs/repos",
            "events_url": "https://api.github.com/users/tgravescs/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tgravescs/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-15T18:45:46Z",
        "updated_at": "2023-08-15T18:45:46Z",
        "author_association": "COLLABORATOR",
        "body": "for me with Spark I just read a file with the contents in the description and it comes back wrong.  I did not create a CUDF reproduce case.  \r\n\r\nI just tested this again and there might be multiple things going on with one of them me messing up.\r\n\r\nThe original user query looked something like:\r\n`val df = spark.read.format(\"csv\").option(\"delimiter\", \"\\t\").load(\"./csvfileDir/\")`\r\n\r\nWhen I was testing to get the small repro case I left off the delimiter specification.\r\n\r\nCPU:\r\n```\r\nscala> val df = spark.read.csv(\"./foo.csv\")\r\n\r\nscala> spark.sql(\"set spark.rapids.sql.enabled=false\")\r\nres3: org.apache.spark.sql.DataFrame = [key: string, value: string]\r\n\r\nscala> df.count()\r\nres4: Long = 2\r\n\r\nscala> df.show()\r\n+-------------+\r\n|          _c0|\r\n+-------------+\r\n| row1\\t10\\t\"\"|\r\n|rows2\\t11\\t\"\"|\r\n+-------------+\r\n\r\n```\r\n\r\nGPU:\r\n```\r\nscala> spark.sql(\"set spark.rapids.sql.enabled=true\")\r\nres6: org.apache.spark.sql.DataFrame = [key: string, value: string]\r\n\r\nscala> val df = spark.read.csv(\"./foo.csv\")\r\ndf: org.apache.spark.sql.DataFrame = [_c0: string]\r\n\r\nscala> df.count()\r\nres7: Long = 1\r\n\r\nscala> df.show()\r\n+-----------+\r\n|        _c0|\r\n+-----------+\r\n|row1\\t10\\t\"|\r\n+-----------+\r\n\r\n```\r\n\r\nGoing back to specifying delimiter actually doesn't show the same problem with my reproduce case.\r\nGPU:\r\n```\r\nscala> val df = spark.read.format(\"csv\").option(\"delimiter\", \"\\t\").load(\"./foo.csv\")\r\ndf: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 1 more field]\r\n\r\nscala> df.count()\r\nres9: Long = 2\r\n\r\nscala> df.show()\r\n+-----+---+----+\r\n|  _c0|_c1| _c2|\r\n+-----+---+----+\r\n| row1| 10|null|\r\n|rows2| 11|null|\r\n+-----+---+----+\r\n\r\n```\r\nCPU:\r\n\r\n```\r\nscala> spark.sql(\"set spark.rapids.sql.enabled=false\")\r\nres15: org.apache.spark.sql.DataFrame = [key: string, value: string]\r\n\r\nscala> val df = spark.read.format(\"csv\").option(\"delimiter\", \"\\t\").load(\"./foo.csv\")\r\ndf: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 1 more field]\r\n\r\nscala> df.count()\r\nres16: Long = 2\r\n\r\nscala> df.show()\r\n+-----+---+----+\r\n|  _c0|_c1| _c2|\r\n+-----+---+----+\r\n| row1| 10|null|\r\n|rows2| 11|null|\r\n+-----+---+----+\r\n\r\n```\r\n\r\nNow if I go back to the actual customer data though using the delimiter option then it still does report the wrong number of rows. \r\n\r\n```\r\nscala> spark.sql(\"set spark.rapids.sql.enabled=true\")\r\nscala> val df = spark.read.format(\"csv\").option(\"delimiter\", \"\\t\").load(\"./customerdata/\")\r\n\r\nscala> df.count()\r\nres12: Long = 7600375     \r\n\r\nscala> spark.sql(\"set spark.rapids.sql.enabled=false\")\r\n\r\nscala> df.count()\r\nres14: Long = 7916199       \r\n```  \r\n\r\nSo to summarize:\r\n\r\n1) There is some issue when delimiter is not specified. Not sure if its plugin or cudf\r\n2) I need to go back to customer data to find repro case with delimiter ",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1679423979/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1679482502",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8926#issuecomment-1679482502",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8926",
        "id": 1679482502,
        "node_id": "IC_kwDOD7z77c5kGt6G",
        "user": {
            "login": "tgravescs",
            "id": 4563792,
            "node_id": "MDQ6VXNlcjQ1NjM3OTI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4563792?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tgravescs",
            "html_url": "https://github.com/tgravescs",
            "followers_url": "https://api.github.com/users/tgravescs/followers",
            "following_url": "https://api.github.com/users/tgravescs/following{/other_user}",
            "gists_url": "https://api.github.com/users/tgravescs/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tgravescs/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tgravescs/subscriptions",
            "organizations_url": "https://api.github.com/users/tgravescs/orgs",
            "repos_url": "https://api.github.com/users/tgravescs/repos",
            "events_url": "https://api.github.com/users/tgravescs/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tgravescs/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-15T19:29:24Z",
        "updated_at": "2023-08-15T19:29:24Z",
        "author_association": "COLLABORATOR",
        "body": "Ok so I was able to narrow down the customer data to the following to reproduce it:\r\n\r\nNote there are tabs between 27 and \"foo\\\"\" and 2 and \"bar\"\r\n```\r\n27      \"foo\\\"\"\r\n2       \"bar\"\r\n```\r\n\r\n\r\n```\r\n// CPU\r\nscala> spark.conf.set(\"spark.rapids.sql.enabled\", \"false\")\r\nscala> val df = spark.read.format(\"csv\").option(\"delimiter\", \"\\t\").load(\"./testRepro.csv\")\r\ndf: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string]\r\n\r\nscala> df.show(false)\r\n+---+----+\r\n|_c0|_c1 |\r\n+---+----+\r\n|27 |foo\"|\r\n|2  |bar |\r\n+---+----+\r\n\r\n// GPU\r\nscala> spark.conf.set(\"spark.rapids.sql.enabled\", \"true\")\r\n\r\nscala> df.show(false)\r\n\r\n\r\n+---+------------------+\r\n|_c0|_c1               |\r\n+---+------------------+\r\n|27 |\"foo\\\"\\n2\\t\"bar\"\\n|\r\n+---+------------------+\r\n```\r\n\r\nBobby pointed out this looks like https://github.com/NVIDIA/spark-rapids/issues/6435 as well.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1679482502/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1679484687",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8926#issuecomment-1679484687",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8926",
        "id": 1679484687,
        "node_id": "IC_kwDOD7z77c5kGucP",
        "user": {
            "login": "tgravescs",
            "id": 4563792,
            "node_id": "MDQ6VXNlcjQ1NjM3OTI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4563792?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tgravescs",
            "html_url": "https://github.com/tgravescs",
            "followers_url": "https://api.github.com/users/tgravescs/followers",
            "following_url": "https://api.github.com/users/tgravescs/following{/other_user}",
            "gists_url": "https://api.github.com/users/tgravescs/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tgravescs/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tgravescs/subscriptions",
            "organizations_url": "https://api.github.com/users/tgravescs/orgs",
            "repos_url": "https://api.github.com/users/tgravescs/repos",
            "events_url": "https://api.github.com/users/tgravescs/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tgravescs/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-15T19:30:58Z",
        "updated_at": "2023-08-15T19:33:43Z",
        "author_association": "COLLABORATOR",
        "body": "Note the second issue with customer data and where delimiter is specified as tab  with the reproduce data containing `\"foo\\\"\"` seems this is actually the same as https://github.com/NVIDIA/spark-rapids/issues/129",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1679484687/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1681112544",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8926#issuecomment-1681112544",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8926",
        "id": 1681112544,
        "node_id": "IC_kwDOD7z77c5kM73g",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-16T18:49:09Z",
        "updated_at": "2023-08-16T18:58:52Z",
        "author_association": "COLLABORATOR",
        "body": "This is a dupe of #6435 and the CUDF issue https://github.com/rapidsai/cudf/issues/11948 is to fix it.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1681112544/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1681331217",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8926#issuecomment-1681331217",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8926",
        "id": 1681331217,
        "node_id": "IC_kwDOD7z77c5kNxQR",
        "user": {
            "login": "vuule",
            "id": 16005690,
            "node_id": "MDQ6VXNlcjE2MDA1Njkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/16005690?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vuule",
            "html_url": "https://github.com/vuule",
            "followers_url": "https://api.github.com/users/vuule/followers",
            "following_url": "https://api.github.com/users/vuule/following{/other_user}",
            "gists_url": "https://api.github.com/users/vuule/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/vuule/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/vuule/subscriptions",
            "organizations_url": "https://api.github.com/users/vuule/orgs",
            "repos_url": "https://api.github.com/users/vuule/repos",
            "events_url": "https://api.github.com/users/vuule/events{/privacy}",
            "received_events_url": "https://api.github.com/users/vuule/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-16T22:07:12Z",
        "updated_at": "2023-08-16T22:07:12Z",
        "author_association": "NONE",
        "body": "I suspect that I had trouble reproing this because the issue only reproes when a field has other characters except `\"\"`. If that's the case, this is a duplicate of #11948.\r\nI looked into that issue earlier and found that the state machine is insufficient to deal with this case, but I can't find any comments about my findings ;(",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1681331217/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
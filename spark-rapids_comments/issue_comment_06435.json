[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1232142085",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6435#issuecomment-1232142085",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6435",
        "id": 1232142085,
        "node_id": "IC_kwDOD7z77c5JcP8F",
        "user": {
            "login": "viadea",
            "id": 9665750,
            "node_id": "MDQ6VXNlcjk2NjU3NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9665750?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/viadea",
            "html_url": "https://github.com/viadea",
            "followers_url": "https://api.github.com/users/viadea/followers",
            "following_url": "https://api.github.com/users/viadea/following{/other_user}",
            "gists_url": "https://api.github.com/users/viadea/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/viadea/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/viadea/subscriptions",
            "organizations_url": "https://api.github.com/users/viadea/orgs",
            "repos_url": "https://api.github.com/users/viadea/repos",
            "events_url": "https://api.github.com/users/viadea/events{/privacy}",
            "received_events_url": "https://api.github.com/users/viadea/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-30T20:37:41Z",
        "updated_at": "2022-08-30T20:37:41Z",
        "author_association": "COLLABORATOR",
        "body": "@ilaychen Could you send the details to spark-rapids-support <spark-rapids-support@nvidia.com>?\r\nSuch as the Spark RAPIDS version you are using and the sample dataset which can reproduce this issue?\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1232142085/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1241054956",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6435#issuecomment-1241054956",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6435",
        "id": 1241054956,
        "node_id": "IC_kwDOD7z77c5J-P7s",
        "user": {
            "login": "ilaychen",
            "id": 45047397,
            "node_id": "MDQ6VXNlcjQ1MDQ3Mzk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/45047397?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ilaychen",
            "html_url": "https://github.com/ilaychen",
            "followers_url": "https://api.github.com/users/ilaychen/followers",
            "following_url": "https://api.github.com/users/ilaychen/following{/other_user}",
            "gists_url": "https://api.github.com/users/ilaychen/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ilaychen/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ilaychen/subscriptions",
            "organizations_url": "https://api.github.com/users/ilaychen/orgs",
            "repos_url": "https://api.github.com/users/ilaychen/repos",
            "events_url": "https://api.github.com/users/ilaychen/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ilaychen/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-08T18:04:46Z",
        "updated_at": "2022-09-08T18:08:18Z",
        "author_association": "NONE",
        "body": "Hi, I found the case where this issue happens.\r\nIt seems like spark-rapids returns wrong results even for a simple df.count() after processing the sample of data that is mentioned below.\r\n**This issue doesn't appear for very small files (less than 1k rows)**\r\n\r\nYou can generate a csv file of ~1k rows with this kind of data:\r\n(try to use these rows, and generate ~1k similar rows)\r\n```\r\n3453433564704482365,7622 S Handy Street,\"\",Silva,85468,NY,United States,US\r\n1641493545665433335,241 Inlusive Road,Flat 30Trafalgar Court,Manchester,M16 8JW,\"\",United Kingdom,GB\r\n1297115076542454494,2557 Latte Blvd,#402,Kansas City,64108,MO,United States,US\r\n2119952246048784100,42 North Street,\"\",Sand-on-Sea,ZZ2 5HU,\"\",United Kingdom,GB\r\n2186678475639058807,329 Johannah Way,\"\",Bridger,07507,NJ,United States,US\r\n1730422379578793088,25 Yore Rd,\"\",MIAM,M9M 1W5,ON,Canada,CA\r\n```\r\n\r\nRead it within a spark-rapids session with:\r\n```\r\ncustomSchema = StructType([\r\n  StructField(\"id\", StringType(), True),\r\n  StructField(\"addr_1\", StringType(), True),\r\n  StructField(\"addr_2\", StringType(), True),\r\n  StructField(\"city\", StringType(), True),\r\n  StructField(\"zip\", StringType(), True),\r\n  StructField(\"state\", StringType(), True),\r\n  StructField(\"cntry\", StringType(), True),\r\n  StructField(\"cntry_code\", StringType(), True)]\r\n)\r\ndf = spark.read.csv(path, schema=customSchema)\r\n```\r\n\r\nand count the dataframe.. you'll see that the number of rows in the actual file is different than the number of rows in the dataframe.\r\nAnother way to see that the processing has a bug - is to try to read id 1730422379578793088.. spark-rapids can't read it\r\n`spark.sql(\"SELECT * from df_tmpView where cust_id = '1730422379578793088'\").count()`",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1241054956/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1241257676",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6435#issuecomment-1241257676",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6435",
        "id": 1241257676,
        "node_id": "IC_kwDOD7z77c5J_BbM",
        "user": {
            "login": "viadea",
            "id": 9665750,
            "node_id": "MDQ6VXNlcjk2NjU3NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9665750?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/viadea",
            "html_url": "https://github.com/viadea",
            "followers_url": "https://api.github.com/users/viadea/followers",
            "following_url": "https://api.github.com/users/viadea/following{/other_user}",
            "gists_url": "https://api.github.com/users/viadea/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/viadea/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/viadea/subscriptions",
            "organizations_url": "https://api.github.com/users/viadea/orgs",
            "repos_url": "https://api.github.com/users/viadea/repos",
            "events_url": "https://api.github.com/users/viadea/events{/privacy}",
            "received_events_url": "https://api.github.com/users/viadea/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-08T21:35:11Z",
        "updated_at": "2022-09-08T21:35:11Z",
        "author_association": "COLLABORATOR",
        "body": "@ilaychen I duplicated your sample data to 2000+ CSV rows(without header) and used latest 22.10 snapshot jar to test it.\r\nAnd it worked fine for me:\r\n```\r\nfrom pyspark.sql.types import *\r\n\r\ncustomSchema = StructType([\r\n  StructField(\"id\", StringType(), True),\r\n  StructField(\"addr_1\", StringType(), True),\r\n  StructField(\"addr_2\", StringType(), True),\r\n  StructField(\"city\", StringType(), True),\r\n  StructField(\"zip\", StringType(), True),\r\n  StructField(\"state\", StringType(), True),\r\n  StructField(\"cntry\", StringType(), True),\r\n  StructField(\"cntry_code\", StringType(), True)]\r\n)\r\n\r\npath = \"/home/xxx/data/xxx/samplecsv/\"\r\ndf = spark.read.csv(path, schema=customSchema)\r\ndf.count()\r\n\r\n2394\r\n```\r\n\r\nIt matches the sample CSV file:\r\n```\r\n$  wc -l a.csv\r\n2394 a.csv\r\n```\r\n\r\nCould you share below by email to us([spark-rapids-support@nvidia.com](mailto:spark-rapids-support@nvidia.com))?\r\n1. Sample data(maybe 1k+ rows) which can reproduce this issue.\r\n2. What is the exact version of your Spark RAPIDS jar?\r\n3. What are the detailed spark and spark rapids configs you are using? Maybe the whole spark-defaults.conf used",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1241257676/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1284425227",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6435#issuecomment-1284425227",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6435",
        "id": 1284425227,
        "node_id": "IC_kwDOD7z77c5MjsYL",
        "user": {
            "login": "viadea",
            "id": 9665750,
            "node_id": "MDQ6VXNlcjk2NjU3NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9665750?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/viadea",
            "html_url": "https://github.com/viadea",
            "followers_url": "https://api.github.com/users/viadea/followers",
            "following_url": "https://api.github.com/users/viadea/following{/other_user}",
            "gists_url": "https://api.github.com/users/viadea/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/viadea/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/viadea/subscriptions",
            "organizations_url": "https://api.github.com/users/viadea/orgs",
            "repos_url": "https://api.github.com/users/viadea/repos",
            "events_url": "https://api.github.com/users/viadea/events{/privacy}",
            "received_events_url": "https://api.github.com/users/viadea/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-19T18:40:09Z",
        "updated_at": "2022-10-19T18:40:09Z",
        "author_association": "COLLABORATOR",
        "body": "Thanks @ilaychen  for sharing the sample data and I can reproduce the issue now.\r\nThe key to reproduce is if there is a value with `\"\"`, then it will stop there.\r\nFor example, if one column is:\r\n```\r\nabc\"\"\r\n```\r\n\r\nGPU run:\r\n```\r\n>>> df.count()\r\n12\r\n```\r\n\r\nGPU run:\r\n```\r\n>>> spark.conf.set(\"spark.rapids.sql.enabled\",\"false\")\r\n>>> df.count()\r\n14\r\n```\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1284425227/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1284503586",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6435#issuecomment-1284503586",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6435",
        "id": 1284503586,
        "node_id": "IC_kwDOD7z77c5Mj_gi",
        "user": {
            "login": "ilaychen",
            "id": 45047397,
            "node_id": "MDQ6VXNlcjQ1MDQ3Mzk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/45047397?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ilaychen",
            "html_url": "https://github.com/ilaychen",
            "followers_url": "https://api.github.com/users/ilaychen/followers",
            "following_url": "https://api.github.com/users/ilaychen/following{/other_user}",
            "gists_url": "https://api.github.com/users/ilaychen/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ilaychen/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ilaychen/subscriptions",
            "organizations_url": "https://api.github.com/users/ilaychen/orgs",
            "repos_url": "https://api.github.com/users/ilaychen/repos",
            "events_url": "https://api.github.com/users/ilaychen/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ilaychen/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-19T19:55:58Z",
        "updated_at": "2022-10-19T19:56:09Z",
        "author_association": "NONE",
        "body": "My pleasure! @viadea \r\nAdding the example csv file that produces this error:\r\n```\r\n134324937434,#1991 N Grayhawk,\"\",Menlo Park,89025,AB,United States,US\r\n208564744937,\"63,trevion Way\",\"\",st Lothian,h7f4h8,\"\",United Kingdom,GB\r\n132709376823,16 Oakland PARK RD,\"\",ring,l1w1e4,South,Canada,CA\r\n224867848652,7 kingwell Court,\"\",United,s7jd9,South United,United Kingdom,GB\r\n169636884295,30 cartuja Road,\"\",Halifax,L0R 9p2,ON,Canada,CA\r\n859473321609,Street,\"\",Manchester,92220,OR,United States,US\r\n141096112545,99 rue des,\"\",Australia,jsd9je,\"\",France,FR\r\n160397658930,5 Rise,\"\",walligshngton,RY6 8LT,FORT,United Kingdom,GB\r\n726367494002,1852 Townsend st,666,Wallsend,90382,CA,United States,US\r\n187644735867,B\u00e4rbel-HAMPDEN-Ping 37,\"\",Miami,13355,\"\",Kingdom,ZZ\r\n948475348324,155 sw City ct,Rochdale,Germany,30864,FL,Australia,QQ\r\n164083193213,abc\"\",\"\",Jerez Fra.,11401,Cadiz,Spain,ES\r\n198732413077,3p Grove Rochdale road,BAW,Fulifax,HX4 trW,\"\",Israel,GB\r\n227433927227,95 novem blvd,\"\",RAW VILLAGE,3173,XYZ,Australia,IL\r\n```\r\nThe schema that is mentioned above still applies \ud83d\ude03 ",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1284503586/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1284556173",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6435#issuecomment-1284556173",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6435",
        "id": 1284556173,
        "node_id": "IC_kwDOD7z77c5MkMWN",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-19T20:48:01Z",
        "updated_at": "2022-10-19T20:48:01Z",
        "author_association": "COLLABORATOR",
        "body": "I filed https://github.com/rapidsai/cudf/issues/11948 in CUDF for the issue as it is their bug. I'll also try to take a look at their code to see what I can come up with.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1284556173/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1285842837",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6435#issuecomment-1285842837",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6435",
        "id": 1285842837,
        "node_id": "IC_kwDOD7z77c5MpGeV",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-20T16:30:27Z",
        "updated_at": "2022-10-20T16:30:27Z",
        "author_association": "COLLABORATOR",
        "body": "It looks like there are two issues happening here.  One of them is that CUDF is returning the wrong number of rows. It gets confused when it sees the \"\" in the row separator logic.  The second one is that CUDF does not support escape characters.  https://github.com/NVIDIA/spark-rapids/issues/129 instead it only supports the pandas default of double quotes to escape a single quote. i.e. `abc\"\"` => `abc\"` because the `\"\"` is used to escape a single quote.  I think the first one CUDF might be able to fix. The second one appears to be working as designed, at least until we can get them to add in a new feature to the CSV parser.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1285842837/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1681112908",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6435#issuecomment-1681112908",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6435",
        "id": 1681112908,
        "node_id": "IC_kwDOD7z77c5kM79M",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-08-16T18:49:27Z",
        "updated_at": "2023-08-16T18:59:13Z",
        "author_association": "COLLABORATOR",
        "body": "the CUDF issue https://github.com/rapidsai/cudf/issues/11948 is to fix it.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1681112908/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1736225055",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9302#issuecomment-1736225055",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9302",
        "id": 1736225055,
        "node_id": "IC_kwDOD7z77c5nfLEf",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-09-26T20:14:10Z",
        "updated_at": "2023-09-26T20:14:10Z",
        "author_association": "COLLABORATOR",
        "body": "Actually the regular window operation appears to be fairly good already, so this may not be needed.\r\n\r\n```\r\nspark.time(spark.range(1, 20000000L, 1, 1).selectExpr(\"id\", \"(id * 0) + 1 as p\", \"id DIV 100 as v\").selectExpr(\"*\", \"FIRST(v) over (partition by p order by id RANGE between unbounded preceding and current row) as m\").orderBy(desc(\"m\"), desc(\"id\")).show())\r\n```\r\n\r\ntook 289 ms\r\n\r\n```\r\nspark.time(spark.range(1, 20000000L, 1, 1).selectExpr(\"id\", \"(id * 0) + 1 as p\", \"id DIV 100 as v\").groupBy(\"p\").agg(first(col(\"v\")).alias(\"m\")).show())\r\n```\r\n\r\ntook 123 ms but it also didn't have to do the sorting/top n operations that the window one did, and that appeared to account for about 100 ms of the 289 ms, so it is likely to be very very close to what we have toady.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1736225055/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
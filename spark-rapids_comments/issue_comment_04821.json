[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1044096280",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4821#issuecomment-1044096280",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4821",
        "id": 1044096280,
        "node_id": "IC_kwDOD7z77c4-O6UY",
        "user": {
            "login": "HaoYang670",
            "id": 59198230,
            "node_id": "MDQ6VXNlcjU5MTk4MjMw",
            "avatar_url": "https://avatars.githubusercontent.com/u/59198230?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/HaoYang670",
            "html_url": "https://github.com/HaoYang670",
            "followers_url": "https://api.github.com/users/HaoYang670/followers",
            "following_url": "https://api.github.com/users/HaoYang670/following{/other_user}",
            "gists_url": "https://api.github.com/users/HaoYang670/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/HaoYang670/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/HaoYang670/subscriptions",
            "organizations_url": "https://api.github.com/users/HaoYang670/orgs",
            "repos_url": "https://api.github.com/users/HaoYang670/repos",
            "events_url": "https://api.github.com/users/HaoYang670/events{/privacy}",
            "received_events_url": "https://api.github.com/users/HaoYang670/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-02-18T07:59:00Z",
        "updated_at": "2022-02-24T07:33:06Z",
        "author_association": "COLLABORATOR",
        "body": "# Case sensitivity\r\n## 1\r\n```json\r\n{\"a\": 1, \"b\": 2}\r\n{\"A\": 3, \"B\": 4}\r\n```\r\nis parsed as \r\n```scala\r\n+----+----+\r\n|   a|   b|\r\n+----+----+\r\n|   1|   2|\r\n|null|null|\r\n+----+----+\r\n```\r\nin Spark, and\r\n```python\r\n      a     b     A     B\r\n0   1.0   2.0  <NA>  <NA>\r\n1  <NA>  <NA>   3.0   4.0\r\n```\r\nin CUDF\r\n## 2\r\n```json\r\n{\"a\": 1, \"B\": 2}\r\n{\"A\": 3, \"b\": 4}\r\n```\r\nis parsed as\r\n```scala\r\norg.apache.spark.sql.AnalysisException: Found duplicate column(s) in the data schema: `a`, `b`\r\n```\r\nin Spark, and\r\n```python\r\n      a     B     A     b\r\n0   1.0   2.0  <NA>  <NA>\r\n1  <NA>  <NA>   3.0   4.0\r\n```\r\nin CUDF\r\n\r\n# Number\r\n## 1\r\n```json\r\n{\"a\": 1.0}\r\n{\"a\": 0.1}\r\n{\"a\": .1} \r\n```\r\nis parsed as \r\n```scala\r\n+---------------+----+\r\n|_corrupt_record|   a|\r\n+---------------+----+\r\n|           null| 1.0|\r\n|           null| 0.1|\r\n|      {\"a\": .1}|null|\r\n+---------------+----+\r\n```\r\nin Spark (This will fall back to the CPU for parsing as it is a _corrupt_record), and\r\n```python\r\n     a\r\n0  1.0\r\n1  0.1\r\n2  0.1\r\n```\r\nin CUDF\r\n\r\n\r\n# Empty file\r\n\r\n## 1\r\n```json\r\n{}\r\n```\r\nis parsed as \r\n```scala\r\n++\r\n||\r\n++\r\n||\r\n++\r\n```\r\nin Spark, and\r\n```python\r\nRuntimeError: cuDF failure at: /workspace/.conda-bld/work/cpp/src/io/json/reader_impl.cu:609: Error determining column names.\r\n```\r\nin CUDF\r\n\r\n# Comments\r\n(although JSON does not support comments)\r\n\r\n## 1\r\n```json\r\n// comment at first line\r\n{\"a\": 1}\r\n```\r\nis parsed as \r\n```scala\r\n+--------------------+----+\r\n|     _corrupt_record|   a|\r\n+--------------------+----+\r\n|// comment at fir...|null|\r\n|                null|   1|\r\n+--------------------+----+\r\n```\r\nin Spark (This will fall back to the CPU for parsing as it is a _corrupt_record), and\r\n```python\r\nRuntimeError: cuDF failure at: /workspace/.conda-bld/work/cpp/src/io/json/reader_impl.cu:371: Input data is not a valid JSON file.\r\n```\r\nin CUDF\r\n\r\n## 2\r\n```json\r\n{\"a\": 1}\r\n// comment at last line\r\n```\r\nis parsed as \r\n```scala\r\n+--------------------+----+\r\n|     _corrupt_record|   a|\r\n+--------------------+----+\r\n|                null|   1|\r\n|// comment at las...|null|\r\n+--------------------+----+\r\n```\r\nin Spark (This will fall back to the CPU for parsing as it is a _corrupt_record), and\r\n```python\r\n      a\r\n0   1.0\r\n1  <NA>\r\n```\r\nin CUDF\r\n\r\n## 3\r\n```json\r\n// {\"a\": 0}\r\n// {\"a\": 1}\r\n```\r\nis parsed as \r\n```scala\r\norg.apache.spark.sql.AnalysisException:\r\nSince Spark 2.3, the queries from raw JSON/CSV files are disallowed when the\r\nreferenced columns only include the internal corrupt record column\r\n(named _corrupt_record by default).\r\n```\r\nin Spark, and\r\n```python\r\n   a\r\n0  0\r\n1  1\r\n```\r\nin CUDF\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1044096280/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1046414673",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4821#issuecomment-1046414673",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4821",
        "id": 1046414673,
        "node_id": "IC_kwDOD7z77c4-XwVR",
        "user": {
            "login": "HaoYang670",
            "id": 59198230,
            "node_id": "MDQ6VXNlcjU5MTk4MjMw",
            "avatar_url": "https://avatars.githubusercontent.com/u/59198230?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/HaoYang670",
            "html_url": "https://github.com/HaoYang670",
            "followers_url": "https://api.github.com/users/HaoYang670/followers",
            "following_url": "https://api.github.com/users/HaoYang670/following{/other_user}",
            "gists_url": "https://api.github.com/users/HaoYang670/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/HaoYang670/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/HaoYang670/subscriptions",
            "organizations_url": "https://api.github.com/users/HaoYang670/orgs",
            "repos_url": "https://api.github.com/users/HaoYang670/repos",
            "events_url": "https://api.github.com/users/HaoYang670/events{/privacy}",
            "received_events_url": "https://api.github.com/users/HaoYang670/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-02-21T02:36:36Z",
        "updated_at": "2022-02-24T08:29:39Z",
        "author_association": "COLLABORATOR",
        "body": "# String\r\n\r\n## 1: How many colons are there?\r\n```json\r\n{\"a\":::::::::::}\r\n```\r\nis parsed as\r\n```scala\r\norg.apache.spark.sql.AnalysisException:\r\nSince Spark 2.3, the queries from raw JSON/CSV files are disallowed when the\r\nreferenced columns only include the internal corrupt record column\r\n(named _corrupt_record by default).\r\n```\r\nin Spark, and\r\n```python\r\n            a\r\n0  ::::::::::\r\n```\r\nin CUDF\r\n\r\n## 2: something beyond `0x10ffff`\r\n(the code point of `\ud835\udfa7` is 0x1d747 )\r\n```json\r\n{\"a\": \"\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\"}\r\n{\"a\": \"\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\"}\r\n{\"a\": \"vvvvvvvvvvvvvvvvvvvv\"}\r\n{\"a\": \"vvvvvvvvvvvvvvvvvvvvv\"}\r\n```\r\nis parsed as\r\n```scala\r\n+--------------------+\r\n|                   a|\r\n+--------------------+\r\n|\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7?...|\r\n|\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7|\r\n|vvvvvvvvvvvvvvvvvvvv|\r\n|vvvvvvvvvvvvvvvvv...|\r\n+--------------------+\r\n```\r\nin Spark (the weird thing is the `?`), and\r\n```python\r\n                       a\r\n0      \ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\r\n1         \ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\ud835\udfa7\r\n2   vvvvvvvvvvvvvvvvvvvv\r\n3  vvvvvvvvvvvvvvvvvvvvv\r\n```\r\nin CUDF",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1046414673/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1046415742",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4821#issuecomment-1046415742",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4821",
        "id": 1046415742,
        "node_id": "IC_kwDOD7z77c4-Xwl-",
        "user": {
            "login": "HaoYang670",
            "id": 59198230,
            "node_id": "MDQ6VXNlcjU5MTk4MjMw",
            "avatar_url": "https://avatars.githubusercontent.com/u/59198230?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/HaoYang670",
            "html_url": "https://github.com/HaoYang670",
            "followers_url": "https://api.github.com/users/HaoYang670/followers",
            "following_url": "https://api.github.com/users/HaoYang670/following{/other_user}",
            "gists_url": "https://api.github.com/users/HaoYang670/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/HaoYang670/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/HaoYang670/subscriptions",
            "organizations_url": "https://api.github.com/users/HaoYang670/orgs",
            "repos_url": "https://api.github.com/users/HaoYang670/repos",
            "events_url": "https://api.github.com/users/HaoYang670/events{/privacy}",
            "received_events_url": "https://api.github.com/users/HaoYang670/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-02-21T02:39:49Z",
        "updated_at": "2022-02-24T09:17:35Z",
        "author_association": "COLLABORATOR",
        "body": "# How many lines are there?\r\ntest this rule:\r\n```\r\nelement\r\n    ws value ws\r\n```\r\n## 1\r\n```json\r\n{\"a\": \"This is the first line\"}\r\n\r\n\r\n\r\n\r\n\r\n\r\n```\r\nis parsed as \r\n```scala\r\n+--------------------+\r\n|                   a|\r\n+--------------------+\r\n|This is the first...|\r\n+--------------------+\r\n```\r\nin Spark, and\r\n```python\r\n                        a\r\n0  This is the first line\r\n1                    <NA>\r\n2                    <NA>\r\n3                    <NA>\r\n4                    <NA>\r\n5                    <NA>\r\n```\r\nin CUDF\r\n\r\n## 2\r\n```json\r\n\r\n{\"a\": \"Is this the first line?\"}\r\n```\r\nis parsed as \r\n```scala\r\n+--------------------+\r\n|                   a|\r\n+--------------------+\r\n|Is this the first...|\r\n+--------------------+\r\n```\r\nin Spark, and\r\n```python\r\nRuntimeError: cuDF failure at: /workspace/.conda-bld/work/cpp/src/io/json/reader_impl.cu:371: Input data is not a valid JSON file.\r\n```\r\nin CUDF.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1046415742/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1046422670",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4821#issuecomment-1046422670",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4821",
        "id": 1046422670,
        "node_id": "IC_kwDOD7z77c4-XySO",
        "user": {
            "login": "HaoYang670",
            "id": 59198230,
            "node_id": "MDQ6VXNlcjU5MTk4MjMw",
            "avatar_url": "https://avatars.githubusercontent.com/u/59198230?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/HaoYang670",
            "html_url": "https://github.com/HaoYang670",
            "followers_url": "https://api.github.com/users/HaoYang670/followers",
            "following_url": "https://api.github.com/users/HaoYang670/following{/other_user}",
            "gists_url": "https://api.github.com/users/HaoYang670/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/HaoYang670/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/HaoYang670/subscriptions",
            "organizations_url": "https://api.github.com/users/HaoYang670/orgs",
            "repos_url": "https://api.github.com/users/HaoYang670/repos",
            "events_url": "https://api.github.com/users/HaoYang670/events{/privacy}",
            "received_events_url": "https://api.github.com/users/HaoYang670/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-02-21T02:58:37Z",
        "updated_at": "2022-02-21T02:58:37Z",
        "author_association": "COLLABORATOR",
        "body": "# Array and Struct\r\n\r\n## 1\r\n```json\r\n{\"a\": [1,2]}\r\n```\r\nis parsed as \r\n```scala\r\n+------+\r\n|     a|\r\n+------+\r\n|[1, 2]|\r\n+------+\r\n```\r\nin Spark, and \r\n```python\r\n    a\r\n0  [1\r\n```\r\nin CUDF.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1046422670/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1046537940",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4821#issuecomment-1046537940",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4821",
        "id": 1046537940,
        "node_id": "IC_kwDOD7z77c4-YObU",
        "user": {
            "login": "HaoYang670",
            "id": 59198230,
            "node_id": "MDQ6VXNlcjU5MTk4MjMw",
            "avatar_url": "https://avatars.githubusercontent.com/u/59198230?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/HaoYang670",
            "html_url": "https://github.com/HaoYang670",
            "followers_url": "https://api.github.com/users/HaoYang670/followers",
            "following_url": "https://api.github.com/users/HaoYang670/following{/other_user}",
            "gists_url": "https://api.github.com/users/HaoYang670/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/HaoYang670/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/HaoYang670/subscriptions",
            "organizations_url": "https://api.github.com/users/HaoYang670/orgs",
            "repos_url": "https://api.github.com/users/HaoYang670/repos",
            "events_url": "https://api.github.com/users/HaoYang670/events{/privacy}",
            "received_events_url": "https://api.github.com/users/HaoYang670/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-02-21T07:08:57Z",
        "updated_at": "2022-02-21T07:08:57Z",
        "author_association": "COLLABORATOR",
        "body": "@revans2 Could you please help to review? Are these the `corner cases` in your mind?",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1046537940/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1047856982",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4821#issuecomment-1047856982",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4821",
        "id": 1047856982,
        "node_id": "IC_kwDOD7z77c4-dQdW",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-02-22T14:32:44Z",
        "updated_at": "2022-02-22T14:32:44Z",
        "author_association": "COLLABORATOR",
        "body": "@HaoYang670 If I know all of the corner cases I would have documented them on the original issue.  This is looking really good. But one thing you need to be careful of is that anything with `_corrupt_record` as a column in it will fall back to the CPU for parsing. So your analysis that looks at CUDF parsing this data is wrong because didn't do that. You can work around this by providing the schema to the json read command. Please make sure to check each query that it really was parsed on the GPU.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1047856982/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1132488657",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4821#issuecomment-1132488657",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4821",
        "id": 1132488657,
        "node_id": "IC_kwDOD7z77c5DgGfR",
        "user": {
            "login": "GaryShen2008",
            "id": 22128535,
            "node_id": "MDQ6VXNlcjIyMTI4NTM1",
            "avatar_url": "https://avatars.githubusercontent.com/u/22128535?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GaryShen2008",
            "html_url": "https://github.com/GaryShen2008",
            "followers_url": "https://api.github.com/users/GaryShen2008/followers",
            "following_url": "https://api.github.com/users/GaryShen2008/following{/other_user}",
            "gists_url": "https://api.github.com/users/GaryShen2008/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GaryShen2008/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GaryShen2008/subscriptions",
            "organizations_url": "https://api.github.com/users/GaryShen2008/orgs",
            "repos_url": "https://api.github.com/users/GaryShen2008/repos",
            "events_url": "https://api.github.com/users/GaryShen2008/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GaryShen2008/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-05-20T05:28:16Z",
        "updated_at": "2022-05-20T05:28:16Z",
        "author_association": "COLLABORATOR",
        "body": "We'll need to create a CI job to run fuzzing test frequently to see if we can find more corner cases.\r\nMove it to 22.08 since it's not in 22.06's target.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1132488657/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
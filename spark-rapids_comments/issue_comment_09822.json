[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1821639570",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9822#issuecomment-1821639570",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9822",
        "id": 1821639570,
        "node_id": "IC_kwDOD7z77c5slAOS",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-11-21T20:36:25Z",
        "updated_at": "2023-11-21T20:36:25Z",
        "author_association": "COLLABORATOR",
        "body": "I think this case might even change run to run. Our aggregations do not guarantee an order that the sum will happen. And floating point is not truly commutative. My guess is that the GPU got unlucky in this case and it overflowed, where the CPU which did the SUM in a strict order, didn't have the same problem.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1821639570/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1875889215",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9822#issuecomment-1875889215",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9822",
        "id": 1875889215,
        "node_id": "IC_kwDOD7z77c5vz8w_",
        "user": {
            "login": "jbrennan333",
            "id": 69316431,
            "node_id": "MDQ6VXNlcjY5MzE2NDMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/69316431?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jbrennan333",
            "html_url": "https://github.com/jbrennan333",
            "followers_url": "https://api.github.com/users/jbrennan333/followers",
            "following_url": "https://api.github.com/users/jbrennan333/following{/other_user}",
            "gists_url": "https://api.github.com/users/jbrennan333/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jbrennan333/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jbrennan333/subscriptions",
            "organizations_url": "https://api.github.com/users/jbrennan333/orgs",
            "repos_url": "https://api.github.com/users/jbrennan333/repos",
            "events_url": "https://api.github.com/users/jbrennan333/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jbrennan333/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-01-03T19:53:24Z",
        "updated_at": "2024-01-03T19:53:24Z",
        "author_association": "COLLABORATOR",
        "body": "See comments in https://github.com/NVIDIA/spark-rapids/issues/10026, which I believe is another instance of this issue.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1875889215/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1878843177",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9822#issuecomment-1878843177",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9822",
        "id": 1878843177,
        "node_id": "IC_kwDOD7z77c5v_N8p",
        "user": {
            "login": "jbrennan333",
            "id": 69316431,
            "node_id": "MDQ6VXNlcjY5MzE2NDMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/69316431?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jbrennan333",
            "html_url": "https://github.com/jbrennan333",
            "followers_url": "https://api.github.com/users/jbrennan333/followers",
            "following_url": "https://api.github.com/users/jbrennan333/following{/other_user}",
            "gists_url": "https://api.github.com/users/jbrennan333/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jbrennan333/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jbrennan333/subscriptions",
            "organizations_url": "https://api.github.com/users/jbrennan333/orgs",
            "repos_url": "https://api.github.com/users/jbrennan333/repos",
            "events_url": "https://api.github.com/users/jbrennan333/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jbrennan333/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-01-05T15:22:54Z",
        "updated_at": "2024-01-05T15:22:54Z",
        "author_association": "COLLABORATOR",
        "body": "Here is a smaller version of the test case from #10026 that still shows a difference:\r\n```\r\n+-------------+\r\n|b            |\r\n+-------------+\r\n|8.2052361E17 |\r\n|-9.615448E24 |\r\n|3.4028235E38 |\r\n|-8.9130315E23|\r\n|-3.4028235E38|\r\n|4.86208753E14|\r\n|2.825404E25  |\r\n|9.7615254E-4 |\r\n+-------------+\r\n\r\nSUM CPU: 1.7713718887409737e+25\r\nSUM GPU: 1.7718319043726909e+25\r\nAPPROX EQ: False\r\n\r\nSORTED SUM CPU: 1.7718319043726909e+25\r\nSORTED SUM GPU: 1.7718319043726909e+25\r\nAPPROX EQ: True\r\n\r\nREVERSE SORTED SUM CPU: 1.7718319043726909e+25\r\nREVERSE SORTED SUM GPU: 1.7718319043726909e+25\r\nAPPROX EQ: True\r\n```\r\nNote that in this case I got the same result on GPU every time.  It's the CPU that gave a different result in the unsorted case.\r\nOnce again, if you add an accumulation column, GPU matches the CPU for the unsorted case, even though I get a different value for GPU when I do a SUM.\r\n```\r\n+----------------------+----------------------+----------------------+\r\n|b                     |cpu_accum             |gpu_accum             |\r\n+----------------------+----------------------+----------------------+\r\n|8.2052360892841984E17 |8.2052360892841984E17 |8.2052360892841984E17 |\r\n|-9.615447782308683E24 |-9.615446961785074E24 |-9.615446961785074E24 |\r\n|3.4028234663852886E38 |3.4028234663851923E38 |3.4028234663851923E38 |\r\n|-8.913031508548466E23 |3.4028234663851832E38 |3.4028234663851832E38 |\r\n|-3.4028234663852886E38|-1.0540321989765048E25|-1.0540321989765048E25|\r\n|4.862087528448E14     |-1.0540321989278838E25|-1.0540321989278838E25|\r\n|2.8254040876688576E25 |1.7713718887409737E25 |1.7713718887409737E25 |\r\n|9.761525434441864E-4  |1.7713718887409737E25 |1.7713718887409737E25 |\r\n+----------------------+----------------------+----------------------+\r\n```\r\nIt appears that for the SUM, the order of operations in the CPU matches the input data order, but for GPU, it does not, so we sometimes get different results.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1878843177/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/2029835974",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9822#issuecomment-2029835974",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9822",
        "id": 2029835974,
        "node_id": "IC_kwDOD7z77c54_NbG",
        "user": {
            "login": "jbrennan333",
            "id": 69316431,
            "node_id": "MDQ6VXNlcjY5MzE2NDMx",
            "avatar_url": "https://avatars.githubusercontent.com/u/69316431?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jbrennan333",
            "html_url": "https://github.com/jbrennan333",
            "followers_url": "https://api.github.com/users/jbrennan333/followers",
            "following_url": "https://api.github.com/users/jbrennan333/following{/other_user}",
            "gists_url": "https://api.github.com/users/jbrennan333/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jbrennan333/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jbrennan333/subscriptions",
            "organizations_url": "https://api.github.com/users/jbrennan333/orgs",
            "repos_url": "https://api.github.com/users/jbrennan333/repos",
            "events_url": "https://api.github.com/users/jbrennan333/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jbrennan333/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-04-01T14:21:39Z",
        "updated_at": "2024-04-01T14:21:39Z",
        "author_association": "COLLABORATOR",
        "body": "We might want to split out the float and double datagens for this test into a separate test, so that all of the deterministic ones are in one test, and the ones affected by order are in a separate test.\r\n\r\nOne observation I had when I was looking into this for floats/doubles is that order really matters when the magnitudes of the values are very different.   Adding very small numbers to very large numbers can effectively ignore the small numbers, and the order can have an impact if enough small numbers add together to impact the final result.  One way to make the test more resilient to this would be to ensure that all of the random numbers are within a smaller range.  Maybe select an initial random starting value and then select a more restricted range around that initial value.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/2029835974/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
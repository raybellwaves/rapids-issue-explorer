[
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1132637238",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4940#issuecomment-1132637238",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4940",
        "id": 1132637238,
        "node_id": "IC_kwDOD7z77c5Dgqw2",
        "user": {
            "login": "res-life",
            "id": 8166419,
            "node_id": "MDQ6VXNlcjgxNjY0MTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/res-life",
            "html_url": "https://github.com/res-life",
            "followers_url": "https://api.github.com/users/res-life/followers",
            "following_url": "https://api.github.com/users/res-life/following{/other_user}",
            "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
            "organizations_url": "https://api.github.com/users/res-life/orgs",
            "repos_url": "https://api.github.com/users/res-life/repos",
            "events_url": "https://api.github.com/users/res-life/events{/privacy}",
            "received_events_url": "https://api.github.com/users/res-life/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-05-20T08:38:11Z",
        "updated_at": "2022-05-20T08:38:11Z",
        "author_association": "COLLABORATOR",
        "body": "@andygrove  @jlowe   @revans2 Help to check:\r\n\r\n- Spark does not support reading CSV numeric UNIX timestamps as timestamps.\r\n- Spark does support reading JSON numeric UNIX timestamps as timestamps. \r\n  But we have difficulty supporting this on GPU. \r\n  Spark behavoir:\r\n       `string` \"1653014790\"   =>  null \r\n       `int` 1653014790  =>  `2022-05-20 10:46:30`\r\n  If one column has both above values, we can't know the original types if read this column as String by cuDF,  because we will get two string rows with the same value.\r\n\r\nDetails:\r\n\r\n**Spark does not support reading CSV numeric UNIX timestamps as timestamps**\r\n```\r\n$SPARK_HOME/bin/pyspark \r\nfrom pyspark.sql.types import *\r\nschema = StructType([StructField(\"c1\", TimestampType())])\r\n\r\nspark.read.csv(\"/tmp/tmp.csv\").show()\r\n+----------+\r\n|       _c0|\r\n+----------+\r\n|1653012031|\r\n|       197|\r\n+----------+\r\n\r\nspark.read.schema(schema).csv(\"/tmp/tmp.csv\").show()\r\n+----+\r\n|  c1|\r\n+----+\r\n|null|\r\n|null|\r\n+----+\r\n```\r\n\r\n**Spark read JSON string int and int**\r\n\r\nSpark code:\r\nSpark uses `VALUE_STRING` and `VALUE_NUMBER_INT` tokens to distinguish `string` and `int`\r\n\r\nhttps://github.com/apache/spark/blob/v3.3.0-rc2/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/json/JacksonParser.scala#L251toL266\r\n\r\n```\r\n    case TimestampType =>\r\n      (parser: JsonParser) => parseJsonToken[java.lang.Long](parser, dataType) {\r\n        case VALUE_STRING if parser.getTextLength >= 1 =>\r\n          try {\r\n            timestampFormatter.parse(parser.getText)\r\n          } catch {\r\n            case NonFatal(e) =>\r\n              // If fails to parse, then tries the way used in 2.0 and 1.x for backwards\r\n              // compatibility.\r\n              val str = DateTimeUtils.cleanLegacyTimestampStr(UTF8String.fromString(parser.getText))\r\n              DateTimeUtils.stringToTimestamp(str, options.zoneId).getOrElse(throw e)\r\n          }\r\n\r\n        case VALUE_NUMBER_INT =>\r\n          parser.getLongValue * 1000000L\r\n      }\r\n```\r\n\r\n**Different behavior for `string int` and `int`**\r\n\r\n```\r\ncat tmp.json \r\n{ \"c1\": \"2020-01-01 00:00:00\" }\r\n{ \"c1\": 1653014790 }  // Valid int\r\n\r\n$SPARK_HOME/bin/pyspark \r\nfrom pyspark.sql.types import *\r\nschema = StructType([StructField(\"c1\", TimestampType())])\r\n\r\nspark.read.schema(schema).json(\"/tmp/tmp.json\").show()\r\n+-------------------+\r\n|                 c1|\r\n+-------------------+\r\n|2020-01-01 00:00:00|\r\n|2022-05-20 10:46:30| // Valid timestamp\r\n+-------------------+\r\n\r\n\r\ncat tmp2.json \r\n{ \"c1\": \"2020-01-01 00:00:00\" }\r\n{ \"c1\": \"1653014790\" }   // Note: it's a string, not int\r\n\r\nspark.read.schema(schema).json(\"/tmp/tmp2.json\").show()\r\n+-------------------+\r\n|                 c1|\r\n+-------------------+\r\n|2020-01-01 00:00:00|\r\n|               null|    // Note\r\n+-------------------+\r\n```\r\n\r\n\r\n**cuDF reads as `long`**\r\n```\r\njson\r\n{ \"c1\": \"2020-01-13\" }\r\n{ \"c1\": 1653014790 }\r\n{ \"c1\": 0 }\r\n\r\nresult:\r\n0                         isNull = false   // IMO, this should be false  \r\n1653014790       isNull = false  \r\n0                         isNull = false   // can't distinguish with the first row  \r\n```\r\n0 indicates the epoch `1970-01-01 00:00:00`\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1132637238/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1132991533",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4940#issuecomment-1132991533",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4940",
        "id": 1132991533,
        "node_id": "IC_kwDOD7z77c5DiBQt",
        "user": {
            "login": "andygrove",
            "id": 934084,
            "node_id": "MDQ6VXNlcjkzNDA4NA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/934084?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/andygrove",
            "html_url": "https://github.com/andygrove",
            "followers_url": "https://api.github.com/users/andygrove/followers",
            "following_url": "https://api.github.com/users/andygrove/following{/other_user}",
            "gists_url": "https://api.github.com/users/andygrove/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/andygrove/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/andygrove/subscriptions",
            "organizations_url": "https://api.github.com/users/andygrove/orgs",
            "repos_url": "https://api.github.com/users/andygrove/repos",
            "events_url": "https://api.github.com/users/andygrove/events{/privacy}",
            "received_events_url": "https://api.github.com/users/andygrove/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-05-20T14:44:55Z",
        "updated_at": "2022-05-20T14:44:55Z",
        "author_association": "CONTRIBUTOR",
        "body": "@res-life I will take a look at this later today",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1132991533/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1132995266",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4940#issuecomment-1132995266",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4940",
        "id": 1132995266,
        "node_id": "IC_kwDOD7z77c5DiCLC",
        "user": {
            "login": "revans2",
            "id": 3441321,
            "node_id": "MDQ6VXNlcjM0NDEzMjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/revans2",
            "html_url": "https://github.com/revans2",
            "followers_url": "https://api.github.com/users/revans2/followers",
            "following_url": "https://api.github.com/users/revans2/following{/other_user}",
            "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
            "organizations_url": "https://api.github.com/users/revans2/orgs",
            "repos_url": "https://api.github.com/users/revans2/repos",
            "events_url": "https://api.github.com/users/revans2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/revans2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-05-20T14:47:17Z",
        "updated_at": "2022-05-20T14:47:41Z",
        "author_association": "COLLABORATOR",
        "body": "@res-life \r\nYes this is a known issue with JSON parsing. Spark distinguishes between quoted fields and non-quoted fields. For now we are just documenting this\r\n\r\nhttps://github.com/NVIDIA/spark-rapids/blob/branch-22.06/docs/compatibility.md#json-floating-point\r\n\r\n> Another limitation of the GPU JSON reader is that it will parse strings containing non-string boolean or numeric values where Spark will treat them as invalid inputs and will just return null.\r\n\r\nAlthough it should be moved to its own section to make it more visible.\r\n\r\nWe hope that once CUDF finishes work on the new JSON parser that we can get some help from them to indicate if a field was quoted or not.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1132995266/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1178352814",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4940#issuecomment-1178352814",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4940",
        "id": 1178352814,
        "node_id": "IC_kwDOD7z77c5GPDyu",
        "user": {
            "login": "sameerz",
            "id": 7036315,
            "node_id": "MDQ6VXNlcjcwMzYzMTU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7036315?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sameerz",
            "html_url": "https://github.com/sameerz",
            "followers_url": "https://api.github.com/users/sameerz/followers",
            "following_url": "https://api.github.com/users/sameerz/following{/other_user}",
            "gists_url": "https://api.github.com/users/sameerz/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/sameerz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/sameerz/subscriptions",
            "organizations_url": "https://api.github.com/users/sameerz/orgs",
            "repos_url": "https://api.github.com/users/sameerz/repos",
            "events_url": "https://api.github.com/users/sameerz/events{/privacy}",
            "received_events_url": "https://api.github.com/users/sameerz/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-07-07T23:09:22Z",
        "updated_at": "2022-07-07T23:09:22Z",
        "author_association": "COLLABORATOR",
        "body": "Removing from 22.08.  Will put it into a release once the cudf dependencies are resolved.  ",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1178352814/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1281752446",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4940#issuecomment-1281752446",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4940",
        "id": 1281752446,
        "node_id": "IC_kwDOD7z77c5MZf1-",
        "user": {
            "login": "res-life",
            "id": 8166419,
            "node_id": "MDQ6VXNlcjgxNjY0MTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/res-life",
            "html_url": "https://github.com/res-life",
            "followers_url": "https://api.github.com/users/res-life/followers",
            "following_url": "https://api.github.com/users/res-life/following{/other_user}",
            "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
            "organizations_url": "https://api.github.com/users/res-life/orgs",
            "repos_url": "https://api.github.com/users/res-life/repos",
            "events_url": "https://api.github.com/users/res-life/events{/privacy}",
            "received_events_url": "https://api.github.com/users/res-life/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-18T03:04:52Z",
        "updated_at": "2022-10-18T03:04:52Z",
        "author_association": "COLLABORATOR",
        "body": "It's not planned in 22.12, let me unassign myself.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1281752446/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1296771711",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4940#issuecomment-1296771711",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4940",
        "id": 1296771711,
        "node_id": "IC_kwDOD7z77c5NSyp_",
        "user": {
            "login": "firestarman",
            "id": 7280411,
            "node_id": "MDQ6VXNlcjcyODA0MTE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7280411?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/firestarman",
            "html_url": "https://github.com/firestarman",
            "followers_url": "https://api.github.com/users/firestarman/followers",
            "following_url": "https://api.github.com/users/firestarman/following{/other_user}",
            "gists_url": "https://api.github.com/users/firestarman/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/firestarman/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/firestarman/subscriptions",
            "organizations_url": "https://api.github.com/users/firestarman/orgs",
            "repos_url": "https://api.github.com/users/firestarman/repos",
            "events_url": "https://api.github.com/users/firestarman/events{/privacy}",
            "received_events_url": "https://api.github.com/users/firestarman/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-31T08:42:50Z",
        "updated_at": "2022-10-31T08:57:43Z",
        "author_association": "COLLABORATOR",
        "body": "I have failed to find a case that says Spark CSV can read numeric values as timestamps, or any related config to enable this behavior.\r\nMaybe we can remove the `CSV ` word from the title,  since this issue appears to be specific to JSON reader.\r\n\r\n@andygrove Do you have any concern for removing the 'CSV' word?",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1296771711/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1297903272",
        "html_url": "https://github.com/NVIDIA/spark-rapids/issues/4940#issuecomment-1297903272",
        "issue_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/4940",
        "id": 1297903272,
        "node_id": "IC_kwDOD7z77c5NXG6o",
        "user": {
            "login": "firestarman",
            "id": 7280411,
            "node_id": "MDQ6VXNlcjcyODA0MTE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7280411?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/firestarman",
            "html_url": "https://github.com/firestarman",
            "followers_url": "https://api.github.com/users/firestarman/followers",
            "following_url": "https://api.github.com/users/firestarman/following{/other_user}",
            "gists_url": "https://api.github.com/users/firestarman/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/firestarman/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/firestarman/subscriptions",
            "organizations_url": "https://api.github.com/users/firestarman/orgs",
            "repos_url": "https://api.github.com/users/firestarman/repos",
            "events_url": "https://api.github.com/users/firestarman/events{/privacy}",
            "received_events_url": "https://api.github.com/users/firestarman/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-11-01T01:43:26Z",
        "updated_at": "2022-11-01T08:00:18Z",
        "author_association": "COLLABORATOR",
        "body": "I am going to remove the `CSV` word from the title.\r\nIf any concern, free to add it back.",
        "reactions": {
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/comments/1297903272/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]
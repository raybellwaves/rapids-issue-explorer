{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6837",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6837/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6837/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6837/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/6837",
    "id": 1413518930,
    "node_id": "I_kwDOD7z77c5UQJZS",
    "number": 6837,
    "title": "[FEA] support conversion of unix time directly to timestamp",
    "user": {
        "login": "revans2",
        "id": 3441321,
        "node_id": "MDQ6VXNlcjM0NDEzMjE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/revans2",
        "html_url": "https://github.com/revans2",
        "followers_url": "https://api.github.com/users/revans2/followers",
        "following_url": "https://api.github.com/users/revans2/following{/other_user}",
        "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
        "organizations_url": "https://api.github.com/users/revans2/orgs",
        "repos_url": "https://api.github.com/users/revans2/repos",
        "events_url": "https://api.github.com/users/revans2/events{/privacy}",
        "received_events_url": "https://api.github.com/users/revans2/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2061735884,
            "node_id": "MDU6TGFiZWwyMDYxNzM1ODg0",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/feature%20request",
            "name": "feature request",
            "color": "a2eeef",
            "default": false,
            "description": "New feature or request"
        },
        {
            "id": 2094500742,
            "node_id": "MDU6TGFiZWwyMDk0NTAwNzQy",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/performance",
            "name": "performance",
            "color": "d845b1",
            "default": false,
            "description": "A performance related task/issue"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2022-10-18T16:30:44Z",
    "updated_at": "2022-10-18T20:48:41Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "**Is your feature request related to a problem? Please describe.**\r\nIn Spark `timestamp_seconds` will take a unix timestamp (seconds since the epoch) and convert it directly into a `TimestampType`. But we see all the time operations like \r\n\r\n```\r\nhour(from_unixtime(unix_time ,'yyyy-MM-dd HH:mm:ss'))\r\n```\r\n\r\nWhich results in a cast from string to timestamp being inserted after the `from_unixtime` and before the call to `hour`. Ideally we would just skip all of this an multiply the input `unix_time` by 1,000,000 to turn it into micro-seconds with some possible overflow checks so we get the same level of error checking that the previous implementation would give.\r\n\r\n**Describe the solution you'd like**\r\nA rule that as we are translating the plan to the GPU, if it sees a `cast(from_unixtime(input, pattern) as timestamp)` would replace it with the new expression if the pattern was in an allowed list of patterns that we know cast supports, and if the time zones match each other (but that is probably a given with how the timezones work for these expressions).\r\n\r\nAnd while we are at it we really should just support `timestamp_seconds`, `timestamp_micros` and `timestamp_millis`",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6837/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/6837/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/7246",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/7246/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/7246/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/7246/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/7246",
    "id": 1476874756,
    "node_id": "I_kwDOD7z77c5YB1IE",
    "number": 7246,
    "title": "[BUG] Hive Decimal parsing cannot go above E99 or below E-99 or long values",
    "user": {
        "login": "revans2",
        "id": 3441321,
        "node_id": "MDQ6VXNlcjM0NDEzMjE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/revans2",
        "html_url": "https://github.com/revans2",
        "followers_url": "https://api.github.com/users/revans2/followers",
        "following_url": "https://api.github.com/users/revans2/following{/other_user}",
        "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
        "organizations_url": "https://api.github.com/users/revans2/orgs",
        "repos_url": "https://api.github.com/users/revans2/repos",
        "events_url": "https://api.github.com/users/revans2/events{/privacy}",
        "received_events_url": "https://api.github.com/users/revans2/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2061735874,
            "node_id": "MDU6TGFiZWwyMDYxNzM1ODc0",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2022-12-05T15:58:58Z",
    "updated_at": "2022-12-06T21:49:42Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "**Describe the bug**\r\nHive wrote their own decimal parser. The problem with their implementation is that they do not allow exponents that are above 99 or smaller than -99.  Our implementation in spark rapids JNI allows this and does the right thing.\r\n\r\nIt also has issues with numbers that are too large to fit in 39 digits before the exponent is applied.\r\n\r\n**Steps/Code to reproduce bug**\r\n\r\nAfter https://github.com/NVIDIA/spark-rapids/pull/7245 is merged in. Run the tests for \"hive-delim-text/extended-float-values\" that are against a decimal types. (they should be marked with this issue number)\r\n\r\n```\r\n1.7976931348623157E-308\r\n1.7976931348623157e-100\r\n1.2e-234\r\n```\r\n\r\non the GPU results in 0.0, but on the CPU it is null because the exponent's absolute values is above 99. I think this would work for positive exponents above 99 too, but I don't know how to get a negative scale decimal value into a hive table that spark reads.\r\n\r\nAlso if the part of the number that is before the radix point is too large (I think it is over 39 digits) that too will fail and return a null on the CPU, but not on the GPU.\r\n\r\n```\r\n1111111111111111111111111111111111111111E-39\r\n```\r\n\r\n**Expected behavior**\r\nFor hive we parse decimal values in the same buggy way as Hive does.\r\n\r\n**Additional context**\r\nI don't think this is critical to fix. I mostly want to document this.",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/7246/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/7246/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
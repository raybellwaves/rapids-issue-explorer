{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9627",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9627/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9627/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9627/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9627",
    "id": 1976130046,
    "node_id": "I_kwDOD7z77c51yVn-",
    "number": 9627,
    "title": "[FEA] [Follow on] Follow on issues for the checking non UTC test cases.",
    "user": {
        "login": "res-life",
        "id": 8166419,
        "node_id": "MDQ6VXNlcjgxNjY0MTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/res-life",
        "html_url": "https://github.com/res-life",
        "followers_url": "https://api.github.com/users/res-life/followers",
        "following_url": "https://api.github.com/users/res-life/following{/other_user}",
        "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
        "organizations_url": "https://api.github.com/users/res-life/orgs",
        "repos_url": "https://api.github.com/users/res-life/repos",
        "events_url": "https://api.github.com/users/res-life/events{/privacy}",
        "received_events_url": "https://api.github.com/users/res-life/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2094874947,
            "node_id": "MDU6TGFiZWwyMDk0ODc0OTQ3",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/test",
            "name": "test",
            "color": "60d6d4",
            "default": false,
            "description": "Only impacts tests"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2023-11-03T12:43:32Z",
    "updated_at": "2024-03-15T01:47:52Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "**Describe the bug**\r\n\r\nAfter https://github.com/NVIDIA/spark-rapids/pull/9482 is merged, should further finish the following items:\r\n\r\n- [ ] Test permerge with a time zone Env variable, by default it's UTC.\r\n\r\n```python\r\nimport os\r\ndef get_time_zone_for_testing():\r\n  tz = os.getenv('TEST_SPARK_SESSION_TIMEZONE')\r\n  if tz is None:\r\n    tz = \"UTC\"\r\n  else:\r\n    tz = tz.strip()\r\n  return tz\r\n\r\n# spark_session.py\r\ntz = get_time_zone_for_testing()\r\n_spark.conf.set(\"spark.sql.session.timeZone\", tz)\r\n\r\n# conftest.py\r\n    if (item.get_closest_marker('disable_timezone_test') and \r\n        get_time_zone_for_testing() != \"UTC\"):\r\n        // for cases disable non-utc test and current timezone for testing is non-utc, skip them.\r\n        pytest.skip('Skip because this case is not ready for non UTC time zone')\r\n```\r\n\r\n- [ ] Update CI to testing non UTC for some Spark versions,  e.g.: only for Spark 311 and Spark 350\r\n\r\n- [ ] For the cases with 'disable_timezone_test' mark, these cases was skipped when timezone is non UTC. We should confirm they fallbacks to CPU when timezone is non UTC either by manually way or write corresponding case for each case that has 'disable_timezone_test' mark\r\n\r\n**Additional context**\r\nFinally we should remove the fallback cases that testing non UTC.\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9627/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9627/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
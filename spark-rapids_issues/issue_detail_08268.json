{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8268",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8268/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8268/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8268/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8268",
    "id": 1703995224,
    "node_id": "I_kwDOD7z77c5lkOdY",
    "number": 8268,
    "title": "[BUG] NDS query 16 fails on EMR 6.10 with java.lang.ClassCastException",
    "user": {
        "login": "mattahrens",
        "id": 5303895,
        "node_id": "MDQ6VXNlcjUzMDM4OTU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5303895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mattahrens",
        "html_url": "https://github.com/mattahrens",
        "followers_url": "https://api.github.com/users/mattahrens/followers",
        "following_url": "https://api.github.com/users/mattahrens/following{/other_user}",
        "gists_url": "https://api.github.com/users/mattahrens/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/mattahrens/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mattahrens/subscriptions",
        "organizations_url": "https://api.github.com/users/mattahrens/orgs",
        "repos_url": "https://api.github.com/users/mattahrens/repos",
        "events_url": "https://api.github.com/users/mattahrens/events{/privacy}",
        "received_events_url": "https://api.github.com/users/mattahrens/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2061735874,
            "node_id": "MDU6TGFiZWwyMDYxNzM1ODc0",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": {
        "login": "NVnavkumar",
        "id": 97137715,
        "node_id": "U_kgDOBco0Mw",
        "avatar_url": "https://avatars.githubusercontent.com/u/97137715?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/NVnavkumar",
        "html_url": "https://github.com/NVnavkumar",
        "followers_url": "https://api.github.com/users/NVnavkumar/followers",
        "following_url": "https://api.github.com/users/NVnavkumar/following{/other_user}",
        "gists_url": "https://api.github.com/users/NVnavkumar/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/NVnavkumar/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/NVnavkumar/subscriptions",
        "organizations_url": "https://api.github.com/users/NVnavkumar/orgs",
        "repos_url": "https://api.github.com/users/NVnavkumar/repos",
        "events_url": "https://api.github.com/users/NVnavkumar/events{/privacy}",
        "received_events_url": "https://api.github.com/users/NVnavkumar/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "NVnavkumar",
            "id": 97137715,
            "node_id": "U_kgDOBco0Mw",
            "avatar_url": "https://avatars.githubusercontent.com/u/97137715?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/NVnavkumar",
            "html_url": "https://github.com/NVnavkumar",
            "followers_url": "https://api.github.com/users/NVnavkumar/followers",
            "following_url": "https://api.github.com/users/NVnavkumar/following{/other_user}",
            "gists_url": "https://api.github.com/users/NVnavkumar/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/NVnavkumar/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/NVnavkumar/subscriptions",
            "organizations_url": "https://api.github.com/users/NVnavkumar/orgs",
            "repos_url": "https://api.github.com/users/NVnavkumar/repos",
            "events_url": "https://api.github.com/users/NVnavkumar/events{/privacy}",
            "received_events_url": "https://api.github.com/users/NVnavkumar/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 4,
    "created_at": "2023-05-10T13:56:51Z",
    "updated_at": "2023-09-18T19:03:47Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "Running NDS SF3K on EMR 6.10 fails on query 16 with this exception:\r\n```\r\n====== Run query16 ======\r\nTaskFailureListener is registered.\r\nAn error occurred while calling o12516.collectToPython.\r\n: java.lang.ClassCastException: [Lscala.runtime.Nothing$; cannot be cast to org.apache.spark.sql.execution.joins.HashedRelation\r\n        at org.apache.spark.sql.execution.SubqueryBroadcastExec.doExecuteCollect(SubqueryBroadcastExec.scala:77)\r\n        at org.apache.spark.sql.execution.AsyncSubqueryExec$$anon$2.doCompute(basicPhysicalOperators.scala:931)\r\n        at org.apache.spark.sql.execution.AsyncSubqueryExec$$anon$2.doCompute(basicPhysicalOperators.scala:928)\r\n        at org.apache.spark.sql.execution.AsyncDriverOperation.$anonfun$compute$1(AsyncDriverOperation.scala:73)\r\n        at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:224)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:216)\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withExecutionId$1(SQLExecution.scala:199)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:245)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withExecutionId(SQLExecution.scala:196)\r\n        at org.apache.spark.sql.execution.AsyncDriverOperation.compute(AsyncDriverOperation.scala:67)\r\n        at org.apache.spark.sql.execution.AsyncDriverOperation.$anonfun$computeFuture$1(AsyncDriverOperation.scala:53)\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withThreadLocalCaptured$1(SQLExecution.scala:267)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:750)\r\n        at org.apache.spark.sql.execution.adaptive.AdaptiveExecutor.checkNoFailures(AdaptiveExecutor.scala:154)\r\n        at org.apache.spark.sql.execution.adaptive.AdaptiveExecutor.doRun(AdaptiveExecutor.scala:88)\r\n        at org.apache.spark.sql.execution.adaptive.AdaptiveExecutor.tryRunningAndGetFuture(AdaptiveExecutor.scala:66)\r\n        at org.apache.spark.sql.execution.adaptive.AdaptiveExecutor.execute(AdaptiveExecutor.scala:57)\r\n        at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$1(AdaptiveSparkPlanExec.scala:249)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n        at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.getFinalPhysicalPlan(AdaptiveSparkPlanExec.scala:248)\r\n        at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:521)\r\n        at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:483)\r\n        at org.apache.spark.sql.Dataset.$anonfun$collectToPython$1(Dataset.scala:3756)\r\n        at org.apache.spark.sql.Dataset.$anonfun$withAction$2(Dataset.scala:3922)\r\n        at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:554)\r\n        at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3920)\r\n        at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:224)\r\n        at org.apache.spark.sql.execution.SQLExecution$.executeQuery$1(SQLExecution.scala:114)\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$7(SQLExecution.scala:139)\r\n        at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:224)\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:139)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:245)\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:138)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:68)\r\n        at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3920)\r\n        at org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:3753)\r\n        at sun.reflect.GeneratedMethodAccessor456.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n        at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n        at py4j.Gateway.invoke(Gateway.java:282)\r\n        at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n        at py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n        at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\r\n        at py4j.ClientServerConnection.run(ClientServerConnection.java:106)\r\n        at java.lang.Thread.run(Thread.java:750)\r\n```\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8268/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8268/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
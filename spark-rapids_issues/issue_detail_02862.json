{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/2862",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/2862/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/2862/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/2862/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/2862",
    "id": 935772330,
    "node_id": "MDU6SXNzdWU5MzU3NzIzMzA=",
    "number": 2862,
    "title": "[BUG] Plugin does not support CSV Header Checking",
    "user": {
        "login": "revans2",
        "id": 3441321,
        "node_id": "MDQ6VXNlcjM0NDEzMjE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/revans2",
        "html_url": "https://github.com/revans2",
        "followers_url": "https://api.github.com/users/revans2/followers",
        "following_url": "https://api.github.com/users/revans2/following{/other_user}",
        "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
        "organizations_url": "https://api.github.com/users/revans2/orgs",
        "repos_url": "https://api.github.com/users/revans2/repos",
        "events_url": "https://api.github.com/users/revans2/events{/privacy}",
        "received_events_url": "https://api.github.com/users/revans2/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2061735874,
            "node_id": "MDU6TGFiZWwyMDYxNzM1ODc0",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-07-02T13:27:51Z",
    "updated_at": "2021-07-06T20:51:21Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "**Describe the bug**\r\nWhen the schema of a CSV file does not match the headers in the file a warning is output.\r\n```\r\nscala> val schema = StructType(Seq(StructField(\"INPUT\", StringType), StructField(\"INPUT1\", StringType), StructField(\"MORE\", StringType)))\r\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(INPUT,StringType,true), StructField(INPUT1,StringType,true), StructField(MORE,StringType,true))\r\nscala> val df = spark.read.option(\"header\", true).schema(schema).csv(\"duplicate.csv\")\r\ndf: org.apache.spark.sql.DataFrame = [INPUT: string, INPUT1: string ... 1 more field]\r\nscala> df.show\r\n21/07/02 13:02:08 WARN CSVHeaderChecker: CSV header does not conform to the schema.\r\n Header: INPUT, INPUT, MORE\r\n Schema: INPUT, INPUT1, MORE\r\nExpected: INPUT1 but found: INPUT\r\nCSV file: file:///home/roberte/src/rapids-plugin-4-spark/duplicate.csv\r\n+-----+------+----+\r\n|INPUT|INPUT1|MORE|\r\n+-----+------+----+\r\n|    1|     2|   3|\r\n|    1|     2|   3|\r\n|    1|     2|   3|\r\n+-----+------+----+\r\n\r\n```\r\n\r\nBut when the plugin is enabled there is no warning form CSVHeaderChecker.\r\n\r\n**Steps/Code to reproduce bug**\r\nHave a CSV file with a different header than the schema passed in. Read it, preferably in local mode because the warning is logged by the process that reads the file, so it will not get back to the end user very easily.\r\n\r\n**Expected behavior**\r\nThe plugin also outputs a warning.\r\n\r\n**Additional context**\r\nThis was found because the cudf team asked us about requirements for duplicate header names. Apparently Pandas and Spark will create different unique header names when there are duplicates. They were in the process of making cudf do the right thing for the Pandas case, and wanted to be sure it would not cause issues with Spark. We need to be sure that when we do implement this feature that we test it with duplicate column names so that we are sure that cudf is doing the right thing for the warnings.",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/2862/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/2862/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10772",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10772/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10772/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10772/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10772",
    "id": 2282403905,
    "node_id": "I_kwDOD7z77c6ICrhB",
    "number": 10772,
    "title": "[BUG] Issues found by Spark UT Framework on RapidsDataFrameAggregateSuite",
    "user": {
        "login": "binmahone",
        "id": 6416599,
        "node_id": "MDQ6VXNlcjY0MTY1OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6416599?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/binmahone",
        "html_url": "https://github.com/binmahone",
        "followers_url": "https://api.github.com/users/binmahone/followers",
        "following_url": "https://api.github.com/users/binmahone/following{/other_user}",
        "gists_url": "https://api.github.com/users/binmahone/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/binmahone/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/binmahone/subscriptions",
        "organizations_url": "https://api.github.com/users/binmahone/orgs",
        "repos_url": "https://api.github.com/users/binmahone/repos",
        "events_url": "https://api.github.com/users/binmahone/events{/privacy}",
        "received_events_url": "https://api.github.com/users/binmahone/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2061735874,
            "node_id": "MDU6TGFiZWwyMDYxNzM1ODc0",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": {
        "login": "abellina",
        "id": 1901059,
        "node_id": "MDQ6VXNlcjE5MDEwNTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1901059?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/abellina",
        "html_url": "https://github.com/abellina",
        "followers_url": "https://api.github.com/users/abellina/followers",
        "following_url": "https://api.github.com/users/abellina/following{/other_user}",
        "gists_url": "https://api.github.com/users/abellina/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/abellina/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/abellina/subscriptions",
        "organizations_url": "https://api.github.com/users/abellina/orgs",
        "repos_url": "https://api.github.com/users/abellina/repos",
        "events_url": "https://api.github.com/users/abellina/events{/privacy}",
        "received_events_url": "https://api.github.com/users/abellina/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "abellina",
            "id": 1901059,
            "node_id": "MDQ6VXNlcjE5MDEwNTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1901059?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/abellina",
            "html_url": "https://github.com/abellina",
            "followers_url": "https://api.github.com/users/abellina/followers",
            "following_url": "https://api.github.com/users/abellina/following{/other_user}",
            "gists_url": "https://api.github.com/users/abellina/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/abellina/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/abellina/subscriptions",
            "organizations_url": "https://api.github.com/users/abellina/orgs",
            "repos_url": "https://api.github.com/users/abellina/repos",
            "events_url": "https://api.github.com/users/abellina/events{/privacy}",
            "received_events_url": "https://api.github.com/users/abellina/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 5,
    "created_at": "2024-05-07T06:39:38Z",
    "updated_at": "2024-05-29T08:59:56Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "**Describe the bug**\r\n\r\nSpark UT Framework enabled RapidsDataFrameAggregateSuite (https://github.com/NVIDIA/spark-rapids/pull/10743), with the following test cases explicitly excluded:\r\n\r\n- [ ] collect_set gave two different outputs on Vanilla Spark and RAPIDS Spark.\r\n      collect functions      \r\n- [ ] failure related to the `collect_set` aggregate function when used with struct types.\r\n      collect functions structs\r\n- [ ] Expected result is a struct with an empty filed, but the result is not. \r\n      collect functions should be able to cast to array type with no null values\r\n- [ ] ordering of elements in the `collect_set` array is different from the expected order\r\n      collect functions should not collect null values\r\n- [X] ~~SPARK-19471: AggregationIterator does not initialize the generated result projection before using it~~\r\n      The case is to assert to find a WholeStageCodegenExec from the plan tree. Not suitable case.\r\n\r\n**These excluded test cases needs further investigating!!!**\r\nNotice: Other test cases in this suite may pass with falling back!\r\n\r\n**Steps/Code to reproduce bug**\r\n1. Compile everything with `mvn -Dbuildver=330 install -DskipTests`\r\n2. Pick a test case name in the above table\r\n3. Go to RapidsTestSettings and find the line starting with \".exclude\" and containing the test case name, comment it out\r\n4. Run the Suite then you'll see one failed test case. E.g. `mvn -nsu -Dbuildver=330 -pl tests -Dsuites=\"org.apache.spark.sql.rapids.suites.RapidsXXXSuite\" test` (replace RapidsXXXSuite with the right name in issue header). ALWAYS double check if your suite name coincide with in source code, as it may contain typos!\r\n\r\n**Expected behavior**\r\nThe suite can pass without excluding any test case.\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10772/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10772/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
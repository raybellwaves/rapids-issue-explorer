{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9155",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9155/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9155/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9155/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/9155",
    "id": 1875667028,
    "node_id": "I_kwDOD7z77c5vzGhU",
    "number": 9155,
    "title": "[FEA] Test map with map as key",
    "user": {
        "login": "revans2",
        "id": 3441321,
        "node_id": "MDQ6VXNlcjM0NDEzMjE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/revans2",
        "html_url": "https://github.com/revans2",
        "followers_url": "https://api.github.com/users/revans2/followers",
        "following_url": "https://api.github.com/users/revans2/following{/other_user}",
        "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
        "organizations_url": "https://api.github.com/users/revans2/orgs",
        "repos_url": "https://api.github.com/users/revans2/repos",
        "events_url": "https://api.github.com/users/revans2/events{/privacy}",
        "received_events_url": "https://api.github.com/users/revans2/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2094874947,
            "node_id": "MDU6TGFiZWwyMDk0ODc0OTQ3",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/test",
            "name": "test",
            "color": "60d6d4",
            "default": false,
            "description": "Only impacts tests"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2023-08-31T14:35:15Z",
    "updated_at": "2023-09-06T20:14:39Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "**Is your feature request related to a problem? Please describe.**\r\nSpark doesn't really support maps with maps as the key. You can force it to happen with something like.\r\n\r\n```\r\nval df  = Seq((Map(Map(1 -> 1) -> 1), Map(Map(2 -> 1) -> 2)), (Map(Map(2 -> 2) -> 0), Map(Map(2 -> 2) -> 0))).toDF(\"a\", \"b\")\r\n```\r\n\r\nBut once you have that spark is not really all that happy to let you do anything with it. That is because a map key has to be orderable to do much with it. But we say that we support it in a lot of our checks, so it would be good to go though as many operators as we can and add tests for the ones that we can support.\r\n\r\nOperators that we should test...\r\n  * map_entries\r\n  * isNull\r\n  * isNotNull\r\n  * coalesce\r\n  * if\r\n  * first\r\n  * last\r\n  * getStructField\r\n  * getArrayItem\r\n  * map_values\r\n  * map_keys\r\n  * map_filter\r\n  * explode\r\n  * explode_outer\r\n  * size\r\n  * repartition (both hash and round robin)\r\n  * transform_keys (so long as the key returned is not also a map)\r\n  * transform_values\r\n  * file writes (ORC, Parquet)\r\n  * file reads (ORC, Parquet)\r\n\r\nOperators that we say we support, but spark does not...\r\n  * literal (not 100% sure on that, Spark does not really support maps as a lit at all when trying to go through the front door)\r\n   * map\r\n   * map_from_arrays\r\n   * map_from_entries\r\n\r\nTo be clear this is not a high priority because Spark does not really support this all that well anyways, and I think we are doing the right thing is all the cases I manually tested.",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9155/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/9155/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
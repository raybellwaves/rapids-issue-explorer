{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/5324",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/5324/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/5324/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/5324/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/5324",
    "id": 1216487375,
    "node_id": "I_kwDOD7z77c5Igh_P",
    "number": 5324,
    "title": "[FEA] see if there is a way to protect against variable float aggregations.",
    "user": {
        "login": "revans2",
        "id": 3441321,
        "node_id": "MDQ6VXNlcjM0NDEzMjE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/revans2",
        "html_url": "https://github.com/revans2",
        "followers_url": "https://api.github.com/users/revans2/followers",
        "following_url": "https://api.github.com/users/revans2/following{/other_user}",
        "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
        "organizations_url": "https://api.github.com/users/revans2/orgs",
        "repos_url": "https://api.github.com/users/revans2/repos",
        "events_url": "https://api.github.com/users/revans2/events{/privacy}",
        "received_events_url": "https://api.github.com/users/revans2/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2061735884,
            "node_id": "MDU6TGFiZWwyMDYxNzM1ODg0",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/feature%20request",
            "name": "feature request",
            "color": "a2eeef",
            "default": false,
            "description": "New feature or request"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2022-04-26T21:17:48Z",
    "updated_at": "2022-05-03T20:36:56Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "**Is your feature request related to a problem? Please describe.**\r\nIn light of #5323 it really would be nice if there was a way for us to try and detect and automatically protect against as many cases as possible where we can get arguably very different/wrong answers when doing floating point operations differently. Specifically for variable float aggregations.\r\n\r\nThe problem is that this can show up everywhere. 1.9999999999999999 instead of 2.0 cast to an int truncates the result and we can get wildly different results. That difference could be the result of doing a POW on the GPU instead of the CPU, the result of parsing a string to a float, or the result of doing a floating point SUM where the answer can be slightly different from one run to the next. So any time we don't produce exactly the same result as Spark we might be in trouble.\r\n\r\nI think what we really want is something that will look at the plan and do a best effort to see if we are doing a float aggregation that can produce different results from run to run in two different parts of the plan where the results of those columns end up being compared for equality. So that could be doing an equi-join on those two columns, or it could be having them as a grouping key after a union/etc. The problem is that tracing that is really complicated and not likely to work out all that well.\r\n\r\nI doubt we are ever going to do this, but it really would be nice.",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/5324/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/5324/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
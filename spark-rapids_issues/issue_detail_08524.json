{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8524",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8524/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8524/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8524/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8524",
    "id": 1745143377,
    "node_id": "I_kwDOD7z77c5oBMZR",
    "number": 8524,
    "title": "[FEA] Caching Dataframes instead of list of data when generating data in integration tests",
    "user": {
        "login": "thirtiseven",
        "id": 7326403,
        "node_id": "MDQ6VXNlcjczMjY0MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7326403?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/thirtiseven",
        "html_url": "https://github.com/thirtiseven",
        "followers_url": "https://api.github.com/users/thirtiseven/followers",
        "following_url": "https://api.github.com/users/thirtiseven/following{/other_user}",
        "gists_url": "https://api.github.com/users/thirtiseven/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/thirtiseven/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/thirtiseven/subscriptions",
        "organizations_url": "https://api.github.com/users/thirtiseven/orgs",
        "repos_url": "https://api.github.com/users/thirtiseven/repos",
        "events_url": "https://api.github.com/users/thirtiseven/events{/privacy}",
        "received_events_url": "https://api.github.com/users/thirtiseven/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2094874947,
            "node_id": "MDU6TGFiZWwyMDk0ODc0OTQ3",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/test",
            "name": "test",
            "color": "60d6d4",
            "default": false,
            "description": "Only impacts tests"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2023-06-07T06:35:59Z",
    "updated_at": "2023-06-13T20:09:04Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "**Is your feature request related to a problem? Please describe.**\r\nWe currently cache a data list to generate a Spark dataframe in `gen_df` in `data_gen.py` to speed up integration testing. The reason for not to caching dataframes is that the SparkSession does not reflect the current runtime config, so some configs can not affect the result of `spark.createDataFrame`. So if we can cache dataframes directly, the performance of integration tests might be improved.\r\n\r\n**Describe the solution you'd like**\r\nFind a way to handle configs that affect the data generation so that we can cache dataframes directly. A possible solution is to add `spark._jconf.getAllConfs().toString()` as an input to the cache key. Or have some logic check / reject such confs at `gen_df` time. \r\n\r\nAnd test it to see if it provides significant time savings.\r\n\r\n**Describe alternatives you've considered**\r\nIf there is no significant time savings, we can safely use the current solution and close this issue.\r\n\r\n**Additional context**\r\n[Memoizing DataGens in integration tests PR](https://github.com/NVIDIA/spark-rapids/pull/8441)\r\n\r\n\r\n_Originally posted by @gerashegalov in https://github.com/NVIDIA/spark-rapids/pull/8441#discussion_r1213505165_",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8524/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8524/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
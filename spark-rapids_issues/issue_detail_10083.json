{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/10083",
    "id": 2051126469,
    "node_id": "I_kwDOD7z77c56QbTF",
    "number": 10083,
    "title": "[BUG] test_date_format_for_time and test_date_format_maybe_incompat failed in non-utc job",
    "user": {
        "login": "abellina",
        "id": 1901059,
        "node_id": "MDQ6VXNlcjE5MDEwNTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1901059?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/abellina",
        "html_url": "https://github.com/abellina",
        "followers_url": "https://api.github.com/users/abellina/followers",
        "following_url": "https://api.github.com/users/abellina/following{/other_user}",
        "gists_url": "https://api.github.com/users/abellina/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/abellina/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/abellina/subscriptions",
        "organizations_url": "https://api.github.com/users/abellina/orgs",
        "repos_url": "https://api.github.com/users/abellina/repos",
        "events_url": "https://api.github.com/users/abellina/events{/privacy}",
        "received_events_url": "https://api.github.com/users/abellina/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2061735874,
            "node_id": "MDU6TGFiZWwyMDYxNzM1ODc0",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        },
        {
            "id": 2710265788,
            "node_id": "MDU6TGFiZWwyNzEwMjY1Nzg4",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/cudf_dependency",
            "name": "cudf_dependency",
            "color": "7400FF",
            "default": false,
            "description": "An issue or PR with this label depends on a new feature in cudf"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": {
        "login": "res-life",
        "id": 8166419,
        "node_id": "MDQ6VXNlcjgxNjY0MTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/res-life",
        "html_url": "https://github.com/res-life",
        "followers_url": "https://api.github.com/users/res-life/followers",
        "following_url": "https://api.github.com/users/res-life/following{/other_user}",
        "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
        "organizations_url": "https://api.github.com/users/res-life/orgs",
        "repos_url": "https://api.github.com/users/res-life/repos",
        "events_url": "https://api.github.com/users/res-life/events{/privacy}",
        "received_events_url": "https://api.github.com/users/res-life/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "res-life",
            "id": 8166419,
            "node_id": "MDQ6VXNlcjgxNjY0MTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8166419?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/res-life",
            "html_url": "https://github.com/res-life",
            "followers_url": "https://api.github.com/users/res-life/followers",
            "following_url": "https://api.github.com/users/res-life/following{/other_user}",
            "gists_url": "https://api.github.com/users/res-life/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/res-life/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/res-life/subscriptions",
            "organizations_url": "https://api.github.com/users/res-life/orgs",
            "repos_url": "https://api.github.com/users/res-life/repos",
            "events_url": "https://api.github.com/users/res-life/events{/privacy}",
            "received_events_url": "https://api.github.com/users/res-life/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 10,
    "created_at": "2023-12-20T19:12:36Z",
    "updated_at": "2023-12-29T06:44:00Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "```\r\n11:47:30  \u001b[36m\u001b[1m=========================== short test summary info ============================\u001b[0m\r\n11:47:30  \u001b[31mFAILED\u001b[0m ../../src/main/python/date_time_test.py::\u001b[1mtest_date_format_for_time[Timestamp-yyyy-MM-dd][DATAGEN_SEED=1703089300, INJECT_OOM]\u001b[0m - AssertionError: GPU and CPU string values are different at [6, 'date_format(a, yyyy-MM-dd)']\r\n11:47:30  \u001b[31mFAILED\u001b[0m ../../src/main/python/date_time_test.py::\u001b[1mtest_date_format_for_time[Timestamp-yyyy-MM][DATAGEN_SEED=1703089300]\u001b[0m - AssertionError: GPU and CPU string values are different at [6, 'date_format(a, yyyy-MM)']\r\n11:47:30  \u001b[31mFAILED\u001b[0m ../../src/main/python/date_time_test.py::\u001b[1mtest_date_format_for_time[Timestamp-yyyy/MM/dd][DATAGEN_SEED=1703089300, INJECT_OOM]\u001b[0m - AssertionError: GPU and CPU string values are different at [6, 'date_format(a, yyyy/MM/dd)']\r\n11:47:30  \u001b[31mFAILED\u001b[0m ../../src/main/python/date_time_test.py::\u001b[1mtest_date_format_for_time[Timestamp-yyyy/MM][DATAGEN_SEED=1703089300]\u001b[0m - AssertionError: GPU and CPU string values are different at [6, 'date_format(a, yyyy/MM)']\r\n11:47:30  \u001b[31mFAILED\u001b[0m ../../src/main/python/date_time_test.py::\u001b[1mtest_date_format_for_time[Timestamp-dd/MM/yyyy][DATAGEN_SEED=1703089300]\u001b[0m - AssertionError: GPU and CPU string values are different at [6, 'date_format(a, dd/MM/yyyy)']\r\n11:47:30  \u001b[31mFAILED\u001b[0m ../../src/main/python/date_time_test.py::\u001b[1mtest_date_format_maybe_incompat[Timestamp-dd-MM-yyyy][DATAGEN_SEED=1703089300, INJECT_OOM, ALLOW_NON_GPU(ProjectExec,FilterExec,FileSourceScanExec,BatchScanExec,CollectLimitExec,DeserializeToObjectExec,DataWritingCommandExec,WriteFilesExec,ShuffleExchangeExec,ExecutedCommandExec)]\u001b[0m - AssertionError: GPU and CPU string values are different at [6, 'date_format(a, dd-MM-yyyy)']\r\n11:47:30  \u001b[31mFAILED\u001b[0m ../../src/main/python/date_time_test.py::\u001b[1mtest_date_format_maybe_incompat[Timestamp-yyyy-MM-dd HH:mm:ss.SSS][DATAGEN_SEED=1703089300, ALLOW_NON_GPU(ProjectExec,FilterExec,FileSourceScanExec,BatchScanExec,CollectLimitExec,DeserializeToObjectExec,DataWritingCommandExec,WriteFilesExec,ShuffleExchangeExec,ExecutedCommandExec)]\u001b[0m - AssertionError: GPU and CPU string values are different at [6, 'date_format(a, yyyy-MM-dd HH:mm:ss.SSS)']\r\n11:47:30  \u001b[31mFAILED\u001b[0m ../../src/main/python/date_time_test.py::\u001b[1mtest_date_format_maybe_incompat[Timestamp-yyyy-MM-dd HH:mm:ss.SSSSSS][DATAGEN_SEED=1703089300, ALLOW_NON_GPU(ProjectExec,FilterExec,FileSourceScanExec,BatchScanExec,CollectLimitExec,DeserializeToObjectExec,DataWritingCommandExec,WriteFilesExec,ShuffleExchangeExec,ExecutedCommandExec)]\u001b[0m - AssertionError: GPU and CPU string values are different at [6, 'date_format(a, yyyy-MM-dd HH:mm:ss.SSSSSS)']\r\n11:47:30  \u001b[31m= \u001b[31m\u001b[1m8 failed\u001b[0m, \u001b[32m19084 passed\u001b[0m, \u001b[33m2566 skipped\u001b[0m, \u001b[33m380 xfailed\u001b[0m, \u001b[33m412 xpassed\u001b[0m, \u001b[33m883 warnings\u001b[0m\u001b[31m in 5149.70s \r\n```\r\n\r\nIt looks like the formatted row is getting an extra `+` sign:\r\n```\r\n11:47:30  -Row(date_format(a, yyyy-MM-dd HH:mm:ss.SSSSSS)='+10000-01-01 03:29:59.999999')\r\n11:47:30  +Row(date_format(a, yyyy-MM-dd HH:mm:ss.SSSSSS)='0000-01-01 03:29:59.999999')\r\n```\r\n\r\nAfter fix https://github.com/NVIDIA/spark-rapids/issues/10032, please update the following:\r\nChange time range to the full range.  Now max time is 9999-12-30, not 9999-12-31\r\n- [ ] test_date_format\r\nChange time range to the full range.  Now max time is 9999-12-30, not 9999-12-31\r\n\r\n- [ ] update test_from_unixtime to use 9999-12-31, Change time range to the full range\r\n```\r\n@pytest.mark.parametrize('data_gen', [LongGen(min_val=int(datetime(1, 2, 1).timestamp()), max_val=int(datetime(9999, 12, 30).timestamp()))], ids=idfn)\r\ntest_from_unixtime\r\n```",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/10083/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
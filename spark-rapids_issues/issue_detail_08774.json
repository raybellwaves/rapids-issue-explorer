{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8774",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8774/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8774/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8774/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8774",
    "id": 1815878508,
    "node_id": "I_kwDOD7z77c5sPBts",
    "number": 8774,
    "title": "[BUG] Exception attempting to get bytes from IcebergArrowColumnVector",
    "user": {
        "login": "jlowe",
        "id": 1360766,
        "node_id": "MDQ6VXNlcjEzNjA3NjY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1360766?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jlowe",
        "html_url": "https://github.com/jlowe",
        "followers_url": "https://api.github.com/users/jlowe/followers",
        "following_url": "https://api.github.com/users/jlowe/following{/other_user}",
        "gists_url": "https://api.github.com/users/jlowe/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jlowe/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jlowe/subscriptions",
        "organizations_url": "https://api.github.com/users/jlowe/orgs",
        "repos_url": "https://api.github.com/users/jlowe/repos",
        "events_url": "https://api.github.com/users/jlowe/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jlowe/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2061735874,
            "node_id": "MDU6TGFiZWwyMDYxNzM1ODc0",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2023-07-21T14:09:48Z",
    "updated_at": "2023-07-25T20:27:24Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "A user running with Iceberg reported a query failure due to an unsupported operation trying to get a byte from an IcebergArrowColumnVector:\r\n```\r\njava.lang.UnsupportedOperationException: Unsupported type - byte\r\n    at org.apache.iceberg.spark.data.vectorized.IcebergArrowColumnVector.getByte(IcebergArrowColumnVector.java:84)\r\n    at com.nvidia.spark.rapids.ColumnarCopyHelper.byteCopy(ColumnarCopyHelper.java:65)\r\n    at com.nvidia.spark.rapids.HostColumnarToGpu$.columnarCopy(HostColumnarToGpu.scala:125)\r\n    at com.nvidia.spark.rapids.HostColumnarToGpu.columnarCopy(HostColumnarToGpu.scala)\r\n    at com.nvidia.spark.rapids.GpuColumnVector$GpuColumnarBatchBuilder.copyColumnar(GpuColumnVector.java:405)\r\n    at com.nvidia.spark.rapids.HostToGpuCoalesceIterator.$anonfun$addBatchToConcat$2(HostColumnarToGpu.scala:259)\r\n...\r\n```\r\n\r\nIceberg doesn't have a byte type but it does have a boolean type.  I suspect we're trying to get booleans as bytes (not sure the reasoning for this logic in HostColumnarToGpu) and if we were to access them as booleans it would have worked.  We need to either always get booleans as booleans rather than bytes or shim this so it does the right thing for Iceberg.",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8774/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8774/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}
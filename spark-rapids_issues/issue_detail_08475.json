{
    "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8475",
    "repository_url": "https://api.github.com/repos/NVIDIA/spark-rapids",
    "labels_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8475/labels{/name}",
    "comments_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8475/comments",
    "events_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8475/events",
    "html_url": "https://github.com/NVIDIA/spark-rapids/issues/8475",
    "id": 1736970590,
    "node_id": "I_kwDOD7z77c5niBFe",
    "number": 8475,
    "title": "[BUG] Crash when writing data with no columns.",
    "user": {
        "login": "revans2",
        "id": 3441321,
        "node_id": "MDQ6VXNlcjM0NDEzMjE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3441321?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/revans2",
        "html_url": "https://github.com/revans2",
        "followers_url": "https://api.github.com/users/revans2/followers",
        "following_url": "https://api.github.com/users/revans2/following{/other_user}",
        "gists_url": "https://api.github.com/users/revans2/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/revans2/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/revans2/subscriptions",
        "organizations_url": "https://api.github.com/users/revans2/orgs",
        "repos_url": "https://api.github.com/users/revans2/repos",
        "events_url": "https://api.github.com/users/revans2/events{/privacy}",
        "received_events_url": "https://api.github.com/users/revans2/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2061735874,
            "node_id": "MDU6TGFiZWwyMDYxNzM1ODc0",
            "url": "https://api.github.com/repos/NVIDIA/spark-rapids/labels/bug",
            "name": "bug",
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2023-06-01T19:43:51Z",
    "updated_at": "2023-06-06T20:18:29Z",
    "closed_at": null,
    "author_association": "COLLABORATOR",
    "active_lock_reason": null,
    "body": "**Describe the bug**\r\nSpark 3.4.0 added in a hidden config that allows users to write out files with only rows, no columns.\r\n\r\n`spark.sql.legacy.allowEmptySchemaWrite=true`\r\n\r\nhttps://issues.apache.org/jira/browse/SPARK-38651\r\n\r\nWhen we try to run with this for writes we get errors about a Table must have columns...  But on the CPU we get an error on parquet like \r\n\r\n```\r\nInvalidSchemaException: Cannot write a schema with an empty group: message spark_schema\r\n```\r\n\r\nBut on ORC and CSV it \"works\", but it drops info about how many rows there actually were.\r\n\r\nJSON actually works.  We don't currently support CSV or JSON writes, but we do support HiveTextFiles and I am not 100% sure how to test that right now.\r\n\r\nWe should fall back to the CPU in any case where we are not writing out any data, just rows.",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8475/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/NVIDIA/spark-rapids/issues/8475/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}